<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component 2: Setting Clear Priorities & Focused Execution | BearOps</title>
    <style>
        :root {
            /* BearOps Design System */
            --bg-primary: #020617;
            --bg-secondary: #0f172a;
            --card-bg: rgba(15, 23, 42, 0.96);
            --border-color: rgba(148, 163, 184, 0.2);
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;

            /* Component 2 Theme - EXECUTION (Emerald / Teal) */
            --exec-main: #10b981;
            --exec-soft: rgba(16, 185, 129, 0.16);
            --exec-glow: rgba(16, 185, 129, 0.5);

            /* AI Assistant Theme - Blue */
            --ai-blue: #3b82f6;
            --ai-blue-soft: rgba(59, 130, 246, 0.18);

            /* Status Colors */
            --success-green: #22c55e;
            --warning-yellow: #fbbf24;
            --error-red: #ef4444;
            --info-blue: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: radial-gradient(circle at top left, #1e293b 0%, #020617 55%, #000 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
        }

        /* Dot Pattern Overlay */
        body::after {
            content: '';
            position: fixed;
            inset: 0;
            background-image: radial-gradient(circle, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
            background-size: 24px 24px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .header {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -80px;
            right: -80px;
            width: 260px;
            height: 260px;
            background: radial-gradient(circle, var(--exec-glow) 0%, transparent 60%);
            opacity: 0.75;
            pointer-events: none;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -120px;
            left: -120px;
            width: 320px;
            height: 320px;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.45) 0%, transparent 60%);
            opacity: 0.4;
            pointer-events: none;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--text-muted);
            text-decoration: none;
            margin-bottom: 15px;
        }

        .back-link span {
            font-size: 1.1rem;
        }

        .header-title {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        .header-title span {
            color: var(--exec-main);
        }

        .header-subtitle {
            font-size: 0.98rem;
            max-width: 760px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .header-stats {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 16px;
        }

        .stat-card {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 14px;
            padding: 12px 14px;
            border: 1px solid rgba(148, 163, 184, 0.4);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .stat-value {
            font-size: 1.4rem;
            font-weight: 600;
            margin-top: 2px;
        }

        .stat-subtext {
            font-size: 0.78rem;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Tabs */
        .tab-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            margin-top: 10px;
        }

        .tab-button {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.4);
            background: rgba(15, 23, 42, 0.8);
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease, transform 0.1s ease;
        }

        .tab-button .tab-icon {
            font-size: 1rem;
        }

        .tab-button.active {
            background: radial-gradient(circle at top left, var(--exec-soft), rgba(15, 23, 42, 0.95));
            color: #ecfdf5;
            border-color: var(--exec-main);
            box-shadow: 0 0 0 1px rgba(16,185,129,0.4);
            transform: translateY(-1px);
        }

        .tab-button:hover {
            border-color: rgba(96, 165, 250, 0.9);
        }

        .tab-content {
            display: none;
            margin-bottom: 30px;
        }

        .tab-content.active {
            display: block;
        }

        /* Generic cards / layout */
        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 18px 40px rgba(15, 23, 42, 0.9);
            margin-bottom: 24px;
        }

        .card-title {
            font-size: 1.25rem;
            margin-bottom: 4px;
        }

        .card-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: minmax(0, 2fr) minmax(0, 1.4fr);
            gap: 16px;
        }

        .form-group {
            margin-bottom: 14px;
        }

        .form-label {
            display: block;
            font-size: 0.85rem;
            margin-bottom: 4px;
        }

        .required {
            color: var(--error-red);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            border-radius: 10px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-primary);
            padding: 8px 10px;
            font-size: 0.88rem;
            outline: none;
        }

        .form-input::placeholder,
        .form-textarea::placeholder {
            color: rgba(148, 163, 184, 0.75);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* AI Panel */
        .ai-panel {
            background: linear-gradient(135deg, var(--ai-blue-soft) 0%, rgba(15, 23, 42, 0.95) 40%, rgba(15, 23, 42, 1) 100%);
            border-radius: 14px;
            padding: 14px 16px;
            border: 1px solid rgba(59, 130, 246, 0.5);
            margin-bottom: 16px;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .ai-icon {
            width: 26px;
            height: 26px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        .ai-title {
            font-size: 0.9rem;
            font-weight: 600;
        }

        .ai-button {
            margin-top: 8px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 999px;
            border: none;
            background: #3b82f6;
            color: #eff6ff;
            font-size: 0.8rem;
            cursor: pointer;
            box-shadow: 0 10px 24px rgba(37, 99, 235, 0.6);
        }

        .ai-button span:first-child {
            font-size: 1rem;
        }

        /* Priority Wall / Lucid */
        .lucid-wrapper {
            display: grid;
            grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.3fr);
            gap: 18px;
        }

        .lucid-preview {
            border-radius: 14px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            overflow: hidden;
            background: rgba(15, 23, 42, 0.95);
        }

        .lucid-preview-img {
            width: 100%;
            display: block;
            aspect-ratio: 16 / 9;
            object-fit: cover;
        }

        .lucid-footer {
            padding: 8px 10px;
            border-top: 1px solid rgba(30, 64, 175, 0.7);
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lucid-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(96, 165, 250, 0.8);
            color: #bfdbfe;
            text-decoration: none;
        }

        .lucid-link span:first-child {
            font-size: 1rem;
        }

        /* Checklist */
        .checklist {
            list-style: none;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-radius: 10px;
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid var(--border-color);
            margin-bottom: 8px;
            font-size: 0.85rem;
        }

        .checklist-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checklist-item.completed {
            opacity: 0.6;
        }

        .checklist-item.completed label {
            text-decoration: line-through;
        }

        .hint {
            font-size: 0.76rem;
            color: var(--text-muted);
        }

        /* Constraint grid */
        .constraint-grid {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 12px;
        }

        .constraint-label {
            font-size: 0.78rem;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .constraint-range {
            width: 100%;
        }

        /* Priority list & voting */
        .priority-list {
            border-radius: 12px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: rgba(15, 23, 42, 0.95);
            max-height: 280px;
            overflow-y: auto;
        }

        .priority-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
            padding: 8px 10px;
            border-bottom: 1px solid rgba(15, 23, 42, 0.95);
        }

        .priority-text {
            flex: 1;
            font-size: 0.82rem;
        }

        .priority-meta {
            min-width: 84px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }

        .priority-votes {
            font-size: 0.75rem;
            color: #a5f3fc;
        }

        .priority-empty {
            padding: 8px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Dashboard cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .dash-card {
            border-radius: 12px;
            padding: 10px 12px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.5);
            font-size: 0.82rem;
        }

        .dash-label {
            font-size: 0.78rem;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .dash-value {
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* Summary / Rocks */
        .summary-textarea {
            width: 100%;
            min-height: 120px;
            border-radius: 10px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: rgba(15, 23, 42, 0.95);
            color: var(--text-primary);
            padding: 8px 10px;
            font-size: 0.86rem;
            resize: vertical;
        }

        .rocks-box {
            border-radius: 12px;
            border: 1px solid rgba(45, 212, 191, 0.5);
            background: radial-gradient(circle at top left, rgba(45,212,191,0.2), rgba(15,23,42,0.95));
            padding: 10px 12px;
            font-size: 0.86rem;
            white-space: pre-line;
            min-height: 100px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 7px 14px;
            border-radius: 999px;
            border: none;
            font-size: 0.8rem;
            cursor: pointer;
            transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.15s ease;
        }

        .btn span:first-child {
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--exec-main);
            color: #ecfdf5;
            box-shadow: 0 10px 24px var(--exec-glow);
        }

        .btn-primary:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #3b82f6;
            color: #eff6ff;
            box-shadow: 0 10px 24px rgba(37, 99, 235, 0.6);
        }

        .btn-secondary:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid rgba(148, 163, 184, 0.6);
        }

        .btn-ghost:hover {
            background: rgba(15, 23, 42, 0.9);
        }

        /* Responsive */
        @media (max-width: 900px) {
            .header-stats {
                grid-template-columns: 1fr;
            }
            .card-grid {
                grid-template-columns: 1fr;
            }
            .lucid-wrapper {
                grid-template-columns: 1fr;
            }
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header-title {
                font-size: 1.7rem;
            }
            .tab-nav {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <a href="../index.html" class="back-link"><span>‚Üê</span> Back to BearOps Vision & Alignment</a>
            <h1 class="header-title">
                Component 2: <span>Setting Clear Priorities & Driving Focused Execution</span>
            </h1>
            <p class="header-subtitle">
                Turn your strategy into a focused, executable plan. Use this component to move from ‚Äútoo many priorities‚Äù
                to 3‚Äì5 committed Rocks with clear ownership, cadence, and scorecards.
            </p>

            <div class="header-stats">
                <div class="stat-card">
                    <div class="stat-label">Execution Readiness</div>
                    <div class="stat-value" id="execReadiness">‚Äî</div>
                    <div class="stat-subtext">Based on Rocks & scorecard lines</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Priority Focus</div>
                    <div class="stat-value" id="priorityFocus">‚Äî</div>
                    <div class="stat-subtext">How many ‚Äútrue‚Äù company priorities</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Team Alignment</div>
                    <div class="stat-value" id="teamAlignment">‚Äî</div>
                    <div class="stat-subtext">Consensus based on voting</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tabs -->
    <div class="tab-nav" id="tabNav">
        <button class="tab-button active" data-tab="assessment">
            <span class="tab-icon">üìã</span> Pre-Assessment
        </button>
        <button class="tab-button" data-tab="prioritywall">
            <span class="tab-icon">üß±</span> Leadership Priority Wall
        </button>
        <button class="tab-button" data-tab="drivers">
            <span class="tab-icon">‚öôÔ∏è</span> Priority Drivers
        </button>
        <button class="tab-button" data-tab="constraints">
            <span class="tab-icon">üöß</span> Constraints & Bottlenecks
        </button>
        <button class="tab-button" data-tab="voting">
            <span class="tab-icon">üó≥Ô∏è</span> Priorities & Voting
        </button>
        <button class="tab-button" data-tab="rocks">
            <span class="tab-icon">ü™®</span> Quarterly Rocks
        </button>
        <button class="tab-button" data-tab="execution">
            <span class="tab-icon">üìà</span> Execution & Scorecards
        </button>
        <button class="tab-button" data-tab="dashboard">
            <span class="tab-icon">üìä</span> Alignment Dashboard
        </button>
        <button class="tab-button" data-tab="communication">
            <span class="tab-icon">üì¢</span> Communication
        </button>
        <button class="tab-button" data-tab="export">
            <span class="tab-icon">üíæ</span> Export & Next Steps
        </button>
    </div>

    <!-- Tab: Pre-Assessment -->
    <div class="tab-content active" id="tab-assessment">
        <div class="card">
            <h2 class="card-title">Pre-Workshop Execution Assessment</h2>
            <p class="card-subtitle">
                Complete this before your leadership execution workshop to understand where focus is diluted,
                where execution is breaking down, and what ‚Äútoo many priorities‚Äù looks like in your world.
            </p>

            <div class="card-grid">
                <div>
                    <div class="form-group">
                        <label class="form-label">Company Name <span class="required">*</span></label>
                        <input type="text" class="form-input" id="a_company" placeholder="e.g., Kota, Series A Fintech">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Stage & context</label>
                        <select class="form-select" id="a_stage">
                            <option value="">Select...</option>
                            <option value="Seed">Seed</option>
                            <option value="Series A">Series A</option>
                            <option value="Series B">Series B</option>
                            <option value="Series C+">Series C+</option>
                            <option value="Bootstrapped">Bootstrapped</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">How many ‚Äútop priorities‚Äù do you currently have?</label>
                        <select class="form-select" id="a_numPriorities">
                            <option value="">Select...</option>
                            <option value="0-3">0‚Äì3</option>
                            <option value="4-7">4‚Äì7</option>
                            <option value="8-12">8‚Äì12</option>
                            <option value="13+">13+</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">What feels hardest about execution right now?</label>
                        <textarea class="form-textarea" id="a_execPain"
                                  placeholder="e.g., Too many initiatives, not enough focus or owners. Weekly meetings become status updates instead of decision forums."></textarea>
                    </div>
                </div>

                <div>
                    <div class="ai-panel">
                        <div class="ai-header">
                            <span class="ai-icon">ü§ñ</span>
                            <span class="ai-title">AI Execution Advisor</span>
                        </div>
                        <p style="font-size:0.85rem; color:var(--text-secondary);">
                            Based on your answers, I'll score your execution readiness, flag risk areas,
                            and suggest how to use this component during your workshop.
                        </p>
                        <button class="ai-button" onclick="generateExecutionAI()">
                            <span>üß†</span><span>Generate Execution Insights</span>
                        </button>
                        <div id="a_aiOutput" style="margin-top:10px; font-size:0.82rem; color:var(--text-secondary);"></div>
                    </div>

                    <ul class="checklist">
                        <li class="checklist-item">
                            <input type="checkbox" onchange="toggleChecklist(this)">
                            <label>Leadership agrees on the 1‚Äì3 company outcomes that matter most this year.</label>
                        </li>
                        <li class="checklist-item">
                            <input type="checkbox" onchange="toggleChecklist(this)">
                            <label>We can all name the same 3‚Äì5 priorities without looking at a slide.</label>
                        </li>
                        <li class="checklist-item">
                            <input type="checkbox" onchange="toggleChecklist(this)">
                            <label>Each priority has a clear owner and a way to measure success.</label>
                        </li>
                    </ul>
                    <p class="hint">You‚Äôll tighten these through the rest of the component.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Leadership Priority Wall -->
    <div class="tab-content" id="tab-prioritywall">
        <div class="card">
            <h2 class="card-title">Leadership Priority Wall (Lucid Board)</h2>
            <p class="card-subtitle">
                Use the shared Lucid board to capture every leader‚Äôs view of ‚Äúwhat must happen next‚Äù.
                This replaces a form-based survey with a live, collaborative canvas.
            </p>

            <div class="lucid-wrapper">
                <div class="lucid-preview">
                    <!-- Replace image path with your actual BearOps preview asset -->
                    <img src="assets/images/bearops-priority-wall-preview.png"
                         alt="BearOps Priority Wall Preview"
                         class="lucid-preview-img">
                    <div class="lucid-footer">
                        <div style="font-size:0.8rem; color:var(--text-secondary);">
                            BearOps Priority Wall ‚Äì each leader adds sticky notes under: Growth, Product, Ops, People, Risk.
                        </div>
                        <a class="lucid-link"
                           href="https://lucid.app"
                           target="_blank" rel="noopener">
                            <span>üîó</span><span>Open Lucid Priority Wall</span>
                        </a>
                    </div>
                </div>

                <div>
                    <div class="form-group">
                        <label class="form-label">What themes emerged from the wall?</label>
                        <textarea class="form-textarea" id="pw_themes"
                                  placeholder="e.g., GTM focus, technical debt, hiring, operational scalability."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Where did leaders disagree the most?</label>
                        <textarea class="form-textarea" id="pw_conflicts"
                                  placeholder="e.g., Level of investment in outbound vs. PLG; EMEA vs. US; Product vs. Sales-led bets."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Any surprising or new priorities?</label>
                        <textarea class="form-textarea" id="pw_surprises"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Immediate questions this raises</label>
                        <textarea class="form-textarea" id="pw_questions"></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Priority Drivers -->
    <div class="tab-content" id="tab-drivers">
        <div class="card">
            <h2 class="card-title">Priority Drivers</h2>
            <p class="card-subtitle">
                Translate ‚Äúeverything on the wall‚Äù into a structured view of what actually drives your 1-Year Goals:
                revenue, product, operations, and people.
            </p>

            <div class="card-grid">
                <div>
                    <div class="form-group">
                        <label class="form-label">Revenue drivers</label>
                        <textarea class="form-textarea" id="d_revenue"
                                  placeholder="e.g., New logo ARR in mid-market, expansion in top 50 customers, churn reduction in SMB."></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Product & platform drivers</label>
                        <textarea class="form-textarea" id="d_product"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Operational & enablement drivers</label>
                        <textarea class="form-textarea" id="d_ops"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">People & leadership drivers</label>
                        <textarea class="form-textarea" id="d_people"></textarea>
                    </div>
                </div>
                <div>
                    <div class="ai-panel">
                        <div class="ai-header">
                            <span class="ai-icon">ü§ñ</span>
                            <span class="ai-title">AI Priority Synthesizer</span>
                        </div>
                        <p style="font-size:0.85rem; color:var(--text-secondary);">
                            I‚Äôll consolidate your drivers into 3‚Äì5 execution themes and suggest example Rocks for each.
                        </p>
                        <button class="ai-button" onclick="generateDriverAI()">
                            <span>üß†</span><span>Synthesize Drivers</span>
                        </button>
                        <div id="d_aiOutput" style="margin-top:10px; font-size:0.82rem; color:var(--text-secondary);"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Emerging execution themes</label>
                        <textarea class="form-textarea" id="d_themes"
                                  placeholder="e.g., 1) Outbound engine, 2) Onboarding/enablement, 3) Platform reliability."></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Constraints & Bottlenecks -->
    <div class="tab-content" id="tab-constraints">
        <div class="card">
            <h2 class="card-title">Constraints & Bottlenecks</h2>
            <p class="card-subtitle">
                Map the constraints that will stop you executing, then use them to shape which priorities deserve Rock status.
            </p>

            <div class="constraint-grid">
                <div>
                    <div class="constraint-label">Execution constraint</div>
                    <textarea class="form-textarea" id="c_desc"
                              placeholder="e.g., Our outbound is hero-based and depends heavily on the founders."></textarea>
                </div>
                <div>
                    <div class="constraint-label">Category</div>
                    <select class="form-select" id="c_cat">
                        <option value="People">People</option>
                        <option value="Process">Process</option>
                        <option value="Tools / Systems">Tools / Systems</option>
                        <option value="Focus / Strategy">Focus / Strategy</option>
                        <option value="Data / Insight">Data / Insight</option>
                        <option value="Other">Other</option>
                    </select>
                    <div class="constraint-label" style="margin-top:8px;">Impact (12‚Äì18 months)</div>
                    <select class="form-select" id="c_impact">
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
                <div>
                    <div class="constraint-label">Severity score</div>
                    <input type="range" id="c_severity" min="1" max="5" value="3" class="constraint-range">
                    <div style="display:flex; justify-content:space-between; font-size:0.7rem; color:var(--text-muted);">
                        <span>Annoying friction</span><span>Critical blocker</span>
                    </div>
                    <button class="btn btn-primary" style="margin-top:10px;" onclick="addConstraint()">
                        <span>‚ûï</span><span>Add constraint</span>
                    </button>
                    <p class="hint">Aim for 6‚Äì12 constraints before you move to voting.</p>
                </div>
            </div>

            <div style="margin-top:16px;">
                <div style="border-radius:12px; border:1px solid rgba(148,163,184,0.5); overflow:hidden;">
                    <table style="width:100%; border-collapse:collapse; font-size:0.8rem;">
                        <thead style="background:rgba(15,23,42,0.9);">
                        <tr>
                            <th style="padding:6px 8px; text-align:left;">Constraint</th>
                            <th style="padding:6px 8px; text-align:left;">Category</th>
                            <th style="padding:6px 8px; text-align:left;">Impact</th>
                            <th style="padding:6px 8px; text-align:left;">Severity</th>
                        </tr>
                        </thead>
                        <tbody id="c_tableBody">
                        <tr><td colspan="4" style="padding:8px; color:var(--text-muted);">
                            No constraints added yet.
                        </td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Priorities & Voting -->
    <div class="tab-content" id="tab-voting">
        <div class="card">
            <h2 class="card-title">Priorities & Leadership Voting</h2>
            <p class="card-subtitle">
                Turn everything you‚Äôve captured into discrete priority options, then dot vote with the leadership team
                to narrow it down to 3‚Äì5 that truly matter.
            </p>

            <div class="card-grid">
                <div>
                    <div class="form-group">
                        <label class="form-label">Add a potential priority</label>
                        <textarea class="form-textarea" id="p_text"
                                  placeholder="e.g., Stand up a repeatable outbound motion for Tier 1‚Äì2 accounts with 80% territory coverage and weekly review cadence."></textarea>
                    </div>
                    <button class="btn btn-secondary" onclick="addPriority()">
                        <span>‚ûï</span><span>Add priority</span>
                    </button>
                    <p class="hint">Capture 8‚Äì15 options from the wall + drivers + constraints.</p>

                    <div style="margin-top:16px;">
                        <p class="hint">
                            Each leader gets 5‚Äì7 votes. Vote for the options that most increase the chance you hit the 1-Year Goals,
                            not what‚Äôs easiest to do.
                        </p>
                    </div>
                </div>
                <div>
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                        <span style="font-size:0.86rem; font-weight:600;">Priority options & votes</span>
                        <button class="btn btn-ghost" onclick="resetVotes()" style="font-size:0.75rem; padding:4px 10px;">
                            Reset votes
                        </button>
                    </div>
                    <div id="p_list" class="priority-list">
                        <div class="priority-empty">No priorities added yet.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Quarterly Rocks -->
    <div class="tab-content" id="tab-rocks">
        <div class="card">
            <h2 class="card-title">Quarterly Rocks Builder</h2>
            <p class="card-subtitle">
                Use the highest-voted priorities and most material constraints to define 3‚Äì5 company Rocks for the next quarter.
            </p>

            <div class="card-grid">
                <div>
                    <div class="form-group">
                        <label class="form-label">Rock naming helper (optional)</label>
                        <textarea class="form-textarea" id="r_prompt"
                                  placeholder="Paste a top-voted priority and a constraint to generate a clearer Rock."></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="generateRocks()">
                        <span>ü™®</span><span>Draft Rocks from priorities</span>
                    </button>
                    <p class="hint">You can refine the output with the leadership team in real time.</p>
                </div>
                <div>
                    <div class="rocks-box" id="r_output">
                        Draft Rocks will appear here based on your top priorities & constraints.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Execution & Scorecards -->
    <div class="tab-content" id="tab-execution">
        <div class="card">
            <h2 class="card-title">Execution Framework & Scorecards</h2>
            <p class="card-subtitle">
                For each Rock, define how you‚Äôll measure progress weekly. This becomes your leadership execution dashboard.
            </p>

            <div class="card-grid">
                <div>
                    <div class="form-group">
                        <label class="form-label">Rock / Priority</label>
                        <input type="text" class="form-input" id="e_rock"
                               placeholder="e.g., Build outbound engine for Tier 1‚Äì2 ICP.">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Lead indicator (weekly)</label>
                        <input type="text" class="form-input" id="e_lead"
                               placeholder="e.g., # of quality outbound conversations with Tier 1 prospects.">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Lag indicator (quarter)</label>
                        <input type="text" class="form-input" id="e_lag"
                               placeholder="e.g., New logo ARR closed from outbound.">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Owner & cadence</label>
                        <input type="text" class="form-input" id="e_owner"
                               placeholder="e.g., VP Sales, reviewed weekly in L10.">
                    </div>
                    <button class="btn btn-secondary" onclick="addScorecardMetric()">
                        <span>‚ûï</span><span>Add to execution dashboard</span>
                    </button>
                </div>
                <div>
                    <div style="border-radius:12px; border:1px solid rgba(148,163,184,0.6); padding:10px 12px; font-size:0.82rem;">
                        <div style="font-weight:600; margin-bottom:6px;">Execution dashboard (draft)</div>
                        <div id="e_dashboard">
                            No metrics yet. Add 3‚Äì7 key scorecard lines from your Rocks.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Alignment Dashboard -->
    <div class="tab-content" id="tab-dashboard">
        <div class="card">
            <h2 class="card-title">Alignment Dashboard</h2>
            <p class="card-subtitle">
                Visualize where your leadership team is aligned and where gaps exist across priorities, constraints, and execution.
            </p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: var(--exec-soft); border: 1px solid var(--exec-main); border-radius: 12px; padding: 20px;">
                    <h3 style="font-size: 1.2rem; margin-bottom: 15px; color: var(--exec-main);">Priority Alignment</h3>
                    <div id="dash_priorities" style="color: var(--text-secondary); font-size: 0.9rem;">
                        Complete voting to see alignment scores.
                    </div>
                </div>

                <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid var(--ai-blue); border-radius: 12px; padding: 20px;">
                    <h3 style="font-size: 1.2rem; margin-bottom: 15px; color: var(--ai-blue);">Constraint Impact</h3>
                    <div id="dash_constraints" style="color: var(--text-secondary); font-size: 0.9rem;">
                        Add constraints to see impact analysis.
                    </div>
                </div>

                <div style="background: rgba(251, 191, 36, 0.1); border: 1px solid var(--warning-yellow); border-radius: 12px; padding: 20px;">
                    <h3 style="font-size: 1.2rem; margin-bottom: 15px; color: var(--warning-yellow);">Execution Readiness</h3>
                    <div id="dash_execution" style="color: var(--text-secondary); font-size: 0.9rem;">
                        Define scorecards to see readiness score.
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="refreshDashboard()">
                <span>üîÑ</span> Refresh Dashboard
            </button>
        </div>
    </div>

    <!-- Tab: Communication -->
    <div class="tab-content" id="tab-communication">
        <div class="card">
            <h2 class="card-title">Communication Plan</h2>
            <p class="card-subtitle">
                Create clear, consistent messaging about priorities and execution for your entire organization.
            </p>

            <div class="ai-panel" style="margin-bottom: 30px;">
                <div class="ai-header">
                    <span class="ai-icon">ü§ñ</span>
                    <span class="ai-title">AI Communication Generator</span>
                </div>
                <p style="margin-bottom: 15px;">
                    I'll create communication templates based on your Rocks and execution framework: all-hands slides, email announcements, manager talking points, and team one-pagers.
                </p>
                <button class="ai-button" onclick="generateCommunications()">
                    <span>‚ú®</span> Generate Communication Pack
                </button>
            </div>

            <div class="card-grid">
                <div>
                    <div class="form-group">
                        <label class="form-label">Key Message (30-second version)</label>
                        <textarea class="form-textarea" id="comm_message" rows="4" placeholder="What's the one thing everyone needs to know about our priorities?

Example:
This quarter, we're focused on 3 things: building repeatable outbound motion, shipping v2.0 with enterprise features, and achieving 95% gross retention. Everything else is secondary."></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Why it matters (connect to company goals)</label>
                        <textarea class="form-textarea" id="comm_why" rows="3" placeholder="Why these priorities? How do they connect to our 1-year goals and company vision?"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">What's changing (from last quarter)</label>
                        <textarea class="form-textarea" id="comm_changes" rows="3" placeholder="What are we stopping or deprioritizing to focus on these Rocks?"></textarea>
                    </div>

                    <button class="btn btn-primary" onclick="saveCommunicationPlan()">
                        <span>‚úì</span> Save Communication Plan
                    </button>
                </div>

                <div>
                    <h4 style="font-size: 1.1rem; margin-bottom: 15px; color: var(--text-primary);">Communication Channels</h4>
                    
                    <ul class="checklist">
                        <li class="checklist-item">
                            <input type="checkbox" id="comm_allhands">
                            <label for="comm_allhands"><strong>All-Hands Presentation</strong> - 10-minute deck with Q&A</label>
                        </li>
                        <li class="checklist-item">
                            <input type="checkbox" id="comm_email">
                            <label for="comm_email"><strong>Company Email</strong> - Written announcement with Rocks & owners</label>
                        </li>
                        <li class="checklist-item">
                            <input type="checkbox" id="comm_managers">
                            <label for="comm_managers"><strong>Manager Briefing</strong> - Talking points for team meetings</label>
                        </li>
                        <li class="checklist-item">
                            <input type="checkbox" id="comm_slack">
                            <label for="comm_slack"><strong>Slack Announcement</strong> - Quick summary with links</label>
                        </li>
                        <li class="checklist-item">
                            <input type="checkbox" id="comm_dashboard">
                            <label for="comm_dashboard"><strong>Visible Dashboard</strong> - Public scorecard updated weekly</label>
                        </li>
                    </ul>

                    <div style="margin-top: 20px; padding: 15px; background: rgba(59, 130, 246, 0.1); border-left: 4px solid var(--ai-blue); border-radius: 8px;">
                        <strong style="color: var(--ai-blue);">Pro Tip:</strong>
                        <span style="color: var(--text-secondary); display: block; margin-top: 5px;">
                            Repeat the message 7+ times through different channels. People need to hear priorities consistently to internalize them.
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: Export & Next Steps -->
    <div class="tab-content" id="tab-export">
        <div class="card">
            <h2 class="card-title">Export & Next Steps</h2>
            <p class="card-subtitle">
                Package everything into actionable formats and set up your ongoing execution rhythm.
            </p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 30px;">
                <button class="btn btn-secondary" onclick="exportJSON()" style="height: auto; padding: 20px; flex-direction: column;">
                    <div style="font-size: 2rem; margin-bottom: 8px;">üìÑ</div>
                    <div style="font-weight: 600;">Export JSON</div>
                    <div style="font-size: 0.75rem; opacity: 0.7;">Raw data for systems</div>
                </button>

                <button class="btn btn-secondary" onclick="exportPDF()" style="height: auto; padding: 20px; flex-direction: column;">
                    <div style="font-size: 2rem; margin-bottom: 8px;">üìã</div>
                    <div style="font-weight: 600;">Export PDF</div>
                    <div style="font-size: 0.75rem; opacity: 0.7;">Printable execution plan</div>
                </button>

                <button class="btn btn-secondary" onclick="exportSlides()" style="height: auto; padding: 20px; flex-direction: column;">
                    <div style="font-size: 2rem; margin-bottom: 8px;">üìä</div>
                    <div style="font-weight: 600;">Export Slides</div>
                    <div style="font-size: 0.75rem; opacity: 0.7;">All-hands presentation</div>
                </button>

                <button class="btn btn-secondary" onclick="exportCSV()" style="height: auto; padding: 20px; flex-direction: column;">
                    <div style="font-size: 2rem; margin-bottom: 8px;">üìà</div>
                    <div style="font-weight: 600;">Export CSV</div>
                    <div style="font-size: 0.75rem; opacity: 0.7;">Scorecard template</div>
                </button>
            </div>

            <div style="background: rgba(16, 185, 129, 0.1); border: 2px solid var(--exec-main); border-radius: 12px; padding: 25px; margin-bottom: 30px;">
                <h3 style="color: var(--exec-main); margin-bottom: 15px; font-size: 1.3rem;">üéØ Your Execution Rhythm</h3>
                
                <div style="color: var(--text-secondary); line-height: 1.8;">
                    <strong>Daily:</strong> Each Rock owner checks leading indicators<br>
                    <strong>Weekly:</strong> Level 10 Meeting - review scorecard, solve issues<br>
                    <strong>Monthly:</strong> Rock progress review with leadership<br>
                    <strong>Quarterly:</strong> Rock completion, celebrate wins, reset priorities<br>
                </div>
            </div>

            <div class="card-grid">
                <div>
                    <h4 style="font-size: 1.1rem; margin-bottom: 15px;">Next 30 Days</h4>
                    <ul style="color: var(--text-secondary); line-height: 2; margin-left: 20px;">
                        <li>Week 1: Communicate Rocks to entire company</li>
                        <li>Week 1: Set up scorecard dashboard (visible to all)</li>
                        <li>Week 2: Rock owners define detailed milestones</li>
                        <li>Week 2: First Level 10 meeting with new scorecard</li>
                        <li>Week 3: Department alignment on Rock support</li>
                        <li>Week 4: 30-day check-in on progress & blockers</li>
                    </ul>
                </div>

                <div>
                    <h4 style="font-size: 1.1rem; margin-bottom: 15px;">Success Metrics</h4>
                    <div style="background: rgba(15, 23, 42, 0.6); border-radius: 8px; padding: 15px;">
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 4px;">Leadership Alignment</div>
                            <div style="font-size: 1.8rem; font-weight: 700; color: var(--exec-main);" id="metric_alignment">--%</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 4px;">Rock Completion Rate</div>
                            <div style="font-size: 1.8rem; font-weight: 700; color: var(--exec-main);" id="metric_completion">--%</div>
                        </div>
                        <div>
                            <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 4px;">Scorecard Adherence</div>
                            <div style="font-size: 1.8rem; font-weight: 700; color: var(--exec-main);" id="metric_adherence">--%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    // Data Storage
    let executionData = {
        assessment: {},
        wall: [],
        drivers: [],
        constraints: [],
        priorities: [],
        rocks: [],
        scorecards: [],
        communication: {}
    };

    // Tab Switching
    document.querySelectorAll('.tab-button').forEach(button => {
        button.addEventListener('click', () => {
            const targetTab = button.getAttribute('data-tab');
            
            // Remove active class from all buttons and content
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            // Add active class to clicked button and corresponding content
            button.classList.add('active');
            document.getElementById(`tab-${targetTab}`).classList.add('active');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    });

    // Assessment Functions
    function generateExecutionAI() {
        const company = document.getElementById('a_company').value;
        const stage = document.getElementById('a_stage').value;
        const numPriorities = document.getElementById('a_numPriorities').value;
        const execPain = document.getElementById('a_execPain').value;

        if (!company || !stage) {
            alert('Please fill in company name and stage first.');
            return;
        }

        let score = 100;
        let insights = [];
        
        // Score based on number of priorities
        if (numPriorities === '13+') {
            score -= 40;
            insights.push('üö® <strong>Too many priorities:</strong> With 13+ priorities, you effectively have zero. Recommend ruthlessly cutting to 3-5.');
        } else if (numPriorities === '8-12') {
            score -= 25;
            insights.push('‚ö†Ô∏è <strong>Priority overload:</strong> 8-12 is still too many. Most will get starved of resources. Target 3-5.');
        } else if (numPriorities === '4-7') {
            score -= 10;
            insights.push('‚úì <strong>Manageable range:</strong> 4-7 priorities can work, but ensure clear owners and resources.');
        } else if (numPriorities === '0-3') {
            insights.push('‚úÖ <strong>Good focus:</strong> 0-3 priorities shows discipline. Make sure they\'re the RIGHT ones.');
        }

        // Additional insights
        if (stage === 'Seed' || stage === 'Series A') {
            insights.push('üí° <strong>Stage insight:</strong> At your stage, focus beats perfection. Pick 2-3 things that unlock next round.');
        } else if (stage === 'Series B' || stage === 'Series C+') {
            insights.push('üí° <strong>Stage insight:</strong> At scale, execution discipline becomes your competitive advantage.');
        }

        if (execPain.toLowerCase().includes('meeting')) {
            insights.push('üéØ <strong>Meeting issue detected:</strong> Consider implementing Level 10 meeting structure (covered in Execution tab).');
        }

        const output = `
            <div style="background: rgba(15, 23, 42, 0.8); padding: 15px; border-radius: 8px; margin-top: 15px;">
                <div style="font-size: 1.5rem; font-weight: 700; color: ${score >= 75 ? 'var(--success-green)' : score >= 50 ? 'var(--warning-yellow)' : 'var(--error-red)'}; margin-bottom: 10px;">
                    Execution Readiness: ${score}/100
                </div>
                ${insights.map(i => `<div style="margin-bottom: 8px;">${i}</div>`).join('')}
                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(148, 163, 184, 0.3);">
                    <strong>Workshop focus:</strong> Use Priority Wall ‚Üí Voting ‚Üí Rocks to get to 3-5 clear priorities with owners.
                </div>
            </div>
        `;

        document.getElementById('a_aiOutput').innerHTML = output;
        
        executionData.assessment = {
            company,
            stage,
            numPriorities,
            execPain,
            score,
            timestamp: new Date().toISOString()
        };
        
        saveData();
    }

    function generateDriverAI() {
        const revenue = document.getElementById('d_revenue').value;
        const product = document.getElementById('d_product').value;
        const ops = document.getElementById('d_ops').value;
        const people = document.getElementById('d_people').value;

        if (!revenue && !product && !ops && !people) {
            alert('Please fill in at least one driver category first.');
            return;
        }

        // Save the drivers
        executionData.drivers = {
            revenue: revenue,
            product: product,
            ops: ops,
            people: people,
            timestamp: new Date().toISOString()
        };
        
        saveData();

        // Generate AI output
        let themes = [];
        if (revenue) themes.push('GTM & Revenue Growth');
        if (product) themes.push('Product & Platform Development');
        if (ops) themes.push('Operational Excellence');
        if (people) themes.push('Team & Leadership');

        const output = `
            <div style="background: rgba(15, 23, 42, 0.8); padding: 15px; border-radius: 8px; margin-top: 15px;">
                <div style="font-weight: 600; color: var(--ai-blue); margin-bottom: 10px;">üéØ Suggested Execution Themes:</div>
                ${themes.map((t, i) => `<div style="margin-bottom: 6px;">${i + 1}. ${t}</div>`).join('')}
                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(148, 163, 184, 0.3); font-size: 0.85rem;">
                    <strong>Next step:</strong> Use these themes to shape your priority list in the Voting tab.
                </div>
            </div>
        `;

        document.getElementById('d_aiOutput').innerHTML = output;
    }

    // Constraint Functions
    function addConstraint() {
        const text = document.getElementById('c_desc').value;
        const category = document.getElementById('c_cat').value;
        const impact = document.getElementById('c_impact').value;
        const severity = document.getElementById('c_severity').value;

        if (!text.trim()) {
            alert('Please enter a constraint description.');
            return;
        }

        const constraint = {
            id: Date.now(),
            text: text.trim(),
            category,
            impact,
            severity
        };

        executionData.constraints.push(constraint);
        document.getElementById('c_desc').value = '';
        document.getElementById('c_severity').value = 3; // Reset slider
        renderConstraints();
        saveData();
    }

    function renderConstraints() {
        const tbody = document.getElementById('c_tableBody');
        if (executionData.constraints.length === 0) {
            tbody.innerHTML = '<tr><td colspan="4" style="padding:8px; color:var(--text-muted);">No constraints added yet.</td></tr>';
            return;
        }

        let html = '';
        executionData.constraints.forEach(c => {
            // Severity is 1-5 from slider
            const severityNum = parseInt(c.severity);
            let severityLabel = '';
            let severityColor = '';
            
            if (severityNum >= 4) {
                severityLabel = 'Critical';
                severityColor = 'var(--error-red)';
            } else if (severityNum === 3) {
                severityLabel = 'High';
                severityColor = 'var(--warning-yellow)';
            } else if (severityNum === 2) {
                severityLabel = 'Medium';
                severityColor = 'var(--info-blue)';
            } else {
                severityLabel = 'Low';
                severityColor = 'var(--text-muted)';
            }
            
            html += `<tr>
                <td style="padding:6px 8px;">${c.text}</td>
                <td style="padding:6px 8px; font-size: 0.75rem; text-transform: uppercase;">${c.category}</td>
                <td style="padding:6px 8px; font-size: 0.85rem;">${c.impact}</td>
                <td style="padding:6px 8px;">
                    <span style="color: ${severityColor}; font-weight: 600; text-transform: uppercase; font-size: 0.75rem;">
                        ${severityLabel} (${severityNum}/5)
                    </span>
                </td>
            </tr>`;
        });

        tbody.innerHTML = html;
    }

    // Priority Voting Functions
    function addPriority() {
        const text = document.getElementById('p_text').value;

        if (!text.trim()) {
            alert('Please enter a priority.');
            return;
        }

        const priority = {
            id: Date.now(),
            text: text.trim(),
            votes: 0
        };

        executionData.priorities.push(priority);
        document.getElementById('p_text').value = '';
        renderPriorities();
        saveData();
    }

    function votePriority(id) {
        const priority = executionData.priorities.find(p => p.id === id);
        if (priority) {
            priority.votes++;
            renderPriorities();
            saveData();
        }
    }

    function resetVotes() {
        if (confirm('Reset all votes? This cannot be undone.')) {
            executionData.priorities.forEach(p => p.votes = 0);
            renderPriorities();
            saveData();
        }
    }

    function renderPriorities() {
        const container = document.getElementById('p_list');
        if (executionData.priorities.length === 0) {
            container.innerHTML = '<div class="priority-empty">No priorities added yet.</div>';
            return;
        }

        // Sort by votes descending
        const sorted = [...executionData.priorities].sort((a, b) => b.votes - a.votes);

        let html = '';
        sorted.forEach((p, index) => {
            const rank = index + 1;
            const rankColor = rank <= 5 ? 'var(--success-green)' : rank <= 10 ? 'var(--warning-yellow)' : 'var(--text-muted)';
            
            html += `<div class="priority-item" style="border-left: 3px solid ${rankColor};">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="font-size: 1.2rem; font-weight: 700; color: ${rankColor}; min-width: 30px;">
                        #${rank}
                    </div>
                    <div class="priority-text" style="flex: 1;">${p.text}</div>
                </div>
                <div class="priority-actions">
                    <button class="btn btn-ghost" onclick="votePriority(${p.id})" style="font-size: 0.85rem; padding: 6px 12px;">
                        üëç ${p.votes} votes
                    </button>
                </div>
            </div>`;
        });

        container.innerHTML = html;
    }

    // Rocks Functions
    function generateRocks() {
        const prompt = document.getElementById('r_prompt').value;
        
        if (executionData.priorities.length === 0) {
            alert('Add and vote on priorities first.');
            return;
        }

        // Get top 5 voted priorities
        const topPriorities = [...executionData.priorities]
            .sort((a, b) => b.votes - a.votes)
            .slice(0, 5);

        let html = '<div style="color: var(--text-secondary); line-height: 1.8;">';
        html += '<h3 style="color: var(--exec-main); margin-bottom: 15px;">Draft Quarterly Rocks</h3>';
        html += '<p style="margin-bottom: 20px; font-style: italic;">Based on your top-voted priorities:</p>';
        
        topPriorities.forEach((p, i) => {
            html += `
                <div style="background: rgba(15, 23, 42, 0.6); padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 3px solid var(--exec-main);">
                    <div style="font-weight: 600; color: var(--exec-main); margin-bottom: 8px;">Rock ${i + 1}</div>
                    <div style="font-size: 0.95rem;">${p.text}</div>
                    <div style="margin-top: 10px; font-size: 0.85rem; color: var(--text-muted);">
                        Votes: ${p.votes} | Owner: <em>TBD</em> | Due: <em>End of Q${Math.ceil((new Date().getMonth() + 1) / 3) + 1}</em>
                    </div>
                </div>
            `;
        });
        
        html += '</div>';
        document.getElementById('r_output').innerHTML = html;
        
        executionData.rocks = topPriorities.map((p, i) => ({
            id: Date.now() + i,
            text: p.text,
            votes: p.votes,
            owner: 'TBD',
            quarter: Math.ceil((new Date().getMonth() + 1) / 3) + 1
        }));
        
        saveData();
    }

    // Scorecard Functions
    function addScorecardMetric() {
        const rock = document.getElementById('e_rock').value;
        const lead = document.getElementById('e_lead').value;
        const lag = document.getElementById('e_lag').value;
        const owner = document.getElementById('e_owner').value;

        if (!rock.trim() || !lead.trim() || !lag.trim() || !owner.trim()) {
            alert('Please fill in all scorecard fields.');
            return;
        }

        const metric = {
            id: Date.now(),
            rock: rock.trim(),
            lead: lead.trim(),
            lag: lag.trim(),
            owner: owner.trim()
        };

        executionData.scorecards.push(metric);
        
        // Clear inputs
        document.getElementById('e_rock').value = '';
        document.getElementById('e_lead').value = '';
        document.getElementById('e_lag').value = '';
        document.getElementById('e_owner').value = '';
        
        renderScorecards();
        saveData();
    }

    function renderScorecards() {
        const container = document.getElementById('e_dashboard');
        if (executionData.scorecards.length === 0) {
            container.innerHTML = 'No metrics yet. Add 3‚Äì7 key scorecard lines from your Rocks.';
            return;
        }

        let html = '<div style="font-size: 0.85rem;">';
        executionData.scorecards.forEach((m, i) => {
            html += `
                <div style="padding: 12px; margin-bottom: 8px; background: rgba(15, 23, 42, 0.4); border-radius: 6px; border-left: 3px solid var(--exec-main);">
                    <div style="font-weight: 600; margin-bottom: 6px;">${m.rock}</div>
                    <div style="color: var(--text-muted); font-size: 0.8rem; line-height: 1.6;">
                        üìà Lead: ${m.lead}<br>
                        üéØ Lag: ${m.lag}<br>
                        üë§ Owner: ${m.owner}
                    </div>
                </div>
            `;
        });
        html += '</div>';
        
        container.innerHTML = html;
    }

    // Dashboard Functions
    function refreshDashboard() {
        // Priority Alignment
        if (executionData.priorities.length > 0) {
            const totalVotes = executionData.priorities.reduce((sum, p) => sum + p.votes, 0);
            const topVotes = executionData.priorities.length > 0 
                ? Math.max(...executionData.priorities.map(p => p.votes)) 
                : 0;
            const alignment = totalVotes > 0 ? Math.round((topVotes / totalVotes) * 100) : 0;
            
            document.getElementById('dash_priorities').innerHTML = `
                <div style="font-size: 2rem; font-weight: 700; color: var(--exec-main); margin-bottom: 10px;">${alignment}%</div>
                <div style="font-size: 0.85rem; line-height: 1.6;">
                    ${executionData.priorities.length} priorities identified<br>
                    Top priority has ${topVotes} votes<br>
                    ${alignment >= 70 ? '‚úÖ Strong alignment' : alignment >= 40 ? '‚ö†Ô∏è Moderate alignment' : 'üö® Low alignment - needs discussion'}
                </div>
            `;
        }

        // Constraint Impact
        if (executionData.constraints.length > 0) {
            const critical = executionData.constraints.filter(c => c.severity === 'critical').length;
            const high = executionData.constraints.filter(c => c.severity === 'high').length;
            
            document.getElementById('dash_constraints').innerHTML = `
                <div style="font-size: 2rem; font-weight: 700; color: var(--ai-blue); margin-bottom: 10px;">${executionData.constraints.length}</div>
                <div style="font-size: 0.85rem; line-height: 1.6;">
                    ${critical} critical constraints<br>
                    ${high} high-impact constraints<br>
                    ${critical > 0 ? 'üö® Address critical constraints first' : '‚úÖ No critical blockers'}
                </div>
            `;
        }

        // Execution Readiness
        if (executionData.scorecards.length > 0) {
            const completeness = Math.min(Math.round((executionData.scorecards.length / 5) * 100), 100);
            
            document.getElementById('dash_execution').innerHTML = `
                <div style="font-size: 2rem; font-weight: 700; color: var(--warning-yellow); margin-bottom: 10px;">${completeness}%</div>
                <div style="font-size: 0.85rem; line-height: 1.6;">
                    ${executionData.scorecards.length} metrics defined<br>
                    Target: 5-7 metrics<br>
                    ${completeness >= 80 ? '‚úÖ Ready to execute' : '‚ö†Ô∏è Need more metrics'}
                </div>
            `;
        }

        alert('‚úì Dashboard refreshed with latest data!');
    }

    // Communication Functions
    function generateCommunications() {
        if (executionData.rocks.length === 0) {
            alert('Generate Rocks first to create communication materials.');
            return;
        }

        alert('AI Communication Generator would create:\n\n' +
              'üìä All-Hands Deck (10 slides)\n' +
              '‚Ä¢ Slide 1: Quarter in Review\n' +
              '‚Ä¢ Slide 2: Our 3-5 Rocks\n' +
              '‚Ä¢ Slide 3: Rock Owners & Timelines\n' +
              '‚Ä¢ Slides 4-8: Rock Details (one per Rock)\n' +
              '‚Ä¢ Slide 9: How We Measure Success\n' +
              '‚Ä¢ Slide 10: What We\'re NOT Doing\n\n' +
              'üìß Email Announcement Template\n' +
              'üìã Manager Talking Points\n' +
              'üì± Slack Summary Post\n' +
              'üìà Public Dashboard Design\n\n' +
              'All customized with your actual Rocks and company context.');
    }

    function saveCommunicationPlan() {
        executionData.communication = {
            message: document.getElementById('comm_message').value,
            why: document.getElementById('comm_why').value,
            changes: document.getElementById('comm_changes').value,
            channels: {
                allhands: document.getElementById('comm_allhands').checked,
                email: document.getElementById('comm_email').checked,
                managers: document.getElementById('comm_managers').checked,
                slack: document.getElementById('comm_slack').checked,
                dashboard: document.getElementById('comm_dashboard').checked
            }
        };
        
        saveData();
        alert('‚úì Communication plan saved!');
    }

    // Export Functions
    function exportJSON() {
        const dataStr = JSON.stringify(executionData, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `execution-plan-${executionData.assessment.company || 'export'}-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
    }

    function exportPDF() {
        alert('PDF export would generate a comprehensive execution plan including:\n\n' +
              '‚Ä¢ Execution Assessment Summary\n' +
              '‚Ä¢ Priority Wall Items\n' +
              '‚Ä¢ Key Drivers & Constraints\n' +
              '‚Ä¢ Voting Results\n' +
              '‚Ä¢ Quarterly Rocks (3-5)\n' +
              '‚Ä¢ Execution Scorecards\n' +
              '‚Ä¢ Communication Plan\n' +
              '‚Ä¢ 30-Day Action Plan\n\n' +
              'Ready for printing and distribution.');
    }

    function exportSlides() {
        alert('PowerPoint export would create:\n\n' +
              '‚Ä¢ 10-slide all-hands presentation\n' +
              '‚Ä¢ Branded with your company info\n' +
              '‚Ä¢ Includes all Rocks with owners\n' +
              '‚Ä¢ Scorecard dashboard visual\n' +
              '‚Ä¢ Q&A slide\n\n' +
              'Ready to present to your team.');
    }

    function exportCSV() {
        let csv = 'Rock,Lead Indicator,Lag Indicator,Owner,Status\n';
        executionData.scorecards.forEach(m => {
            csv += `"${m.rock}","${m.lead}","${m.lag}","${m.owner}","In Progress"\n`;
        });
        
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `execution-scorecard-${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
    }

    // Helper Functions
    function toggleChecklist(checkbox) {
        // Just for visual feedback
        if (checkbox.checked) {
            checkbox.parentElement.style.opacity = '0.6';
        } else {
            checkbox.parentElement.style.opacity = '1';
        }
    }

    function saveData() {
        localStorage.setItem('bearops_execution', JSON.stringify(executionData));
    }

    function loadData() {
        const saved = localStorage.getItem('bearops_execution');
        if (saved) {
            try {
                executionData = JSON.parse(saved);
                // Render sections that have render functions
                renderConstraints();
                renderPriorities();
                renderScorecards();
            } catch (e) {
                console.warn('Could not load saved data:', e);
            }
        }
    }

    // Auto-save every 30 seconds
    setInterval(saveData, 30000);

    // Load saved data on page load
    window.addEventListener('load', () => {
        loadData();
        console.log('Execution data loaded');
    });
</script>

</body>
</html>