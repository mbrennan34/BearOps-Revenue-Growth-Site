<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component 3: Ownership, Accountability & High-Performance Teams | BearOps</title>
    <style>
        :root {
            /* BearOps Outbound Engine Design System */
            --bg-primary: #020617;
            --bg-secondary: #0f172a;
            --card-bg: rgba(15, 23, 42, 0.96);
            --border-color: rgba(148, 163, 184, 0.2);
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;

            --accent-green: #22c55e;
            --accent-green-soft: rgba(34, 197, 94, 0.14);
            --accent-amber: #fbbf24;
            --accent-amber-soft: rgba(251, 191, 36, 0.14);
            --accent-red: #f97373;
            --accent-red-soft: rgba(239, 68, 68, 0.16);
            --accent-blue: #38bdf8;
            --accent-blue-soft: rgba(56, 189, 248, 0.12);

            --tag-bg: rgba(30, 64, 175, 0.6);
            --tag-text: #e0f2fe;

            --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.75);
            --shadow-subtle: 0 10px 30px rgba(15, 23, 42, 0.6);

            --status-done: #22c55e;
            --status-in-progress: #fbbf24;
            --status-not-started: #64748b;

            --chip-bg: rgba(15, 23, 42, 0.9);
            --chip-border: rgba(148, 163, 184, 0.4);

            --pill-bg: rgba(15, 23, 42, 0.9);
            --pill-border: rgba(148, 163, 184, 0.4);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
            background: radial-gradient(circle at top left, #0b1220 0, #020617 42%, #020617 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
        }

        /* Dot Pattern Overlay */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.16;
            background-image:
                radial-gradient(rgba(148, 163, 184, 0.16) 1px, transparent 0),
                radial-gradient(rgba(30, 64, 175, 0.18) 1px, transparent 0);
            background-position: 0 0, 16px 16px;
            background-size: 32px 32px;
            z-index: -1;
        }

        .page-shell {
            max-width: 1280px;
            margin: 0 auto;
            padding: 24px 18px 40px;
            position: relative;
        }

        /* Top-Right Meta Panel */
        .top-right-meta {
            position: fixed;
            top: 14px;
            right: 18px;
            z-index: 10;
            display: flex;
            gap: 8px;
            flex-direction: column;
            align-items: flex-end;
        }

        .meta-pill {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 11px;
            border-radius: 999px;
            font-size: 0.74rem;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(148, 163, 184, 0.35);
            color: var(--text-secondary);
            backdrop-filter: blur(16px);
            box-shadow: 0 12px 30px rgba(15, 23, 42, 0.65);
        }

        .meta-pill span:first-child {
            font-size: 0.8rem;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 24px;
            margin-bottom: 28px;
        }

        .header-main {
            flex: 1.4;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 16px;
        }

        .back-link::before {
            content: 'â†';
            font-size: 1rem;
        }

        .header-title {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .header-eyebrow {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 10px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.86);
            border: 1px solid rgba(148, 163, 184, 0.5);
            color: var(--text-secondary);
            font-size: 0.75rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .header-eyebrow span:first-child {
            font-size: 0.85rem;
        }

        .header-subtitle {
            font-size: 0.99rem;
            color: var(--text-secondary);
            max-width: 620px;
        }

        .quick-points {
            margin-top: 14px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .quick-point {
            font-size: 0.8rem;
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.35);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-secondary);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .quick-point span:first-child {
            font-size: 0.9rem;
        }

        .header-metrics {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }

        .progress-card {
            background: radial-gradient(circle at top left, rgba(34, 197, 94, 0.2), rgba(15, 23, 42, 0.96));
            border-radius: 18px;
            padding: 12px 14px;
            border: 1px solid rgba(34, 197, 94, 0.4);
            min-width: 260px;
            box-shadow: var(--shadow-subtle);
        }

        .progress-label-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .progress-label-row strong {
            font-size: 0.82rem;
            letter-spacing: 0.14em;
            text-transform: uppercase;
        }

        .progress-subtext {
            font-size: 0.8rem;
            color: #bbf7d0;
        }

        .progress-bar-shell {
            height: 8px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(22, 163, 74, 0.7);
            margin-top: 6px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            width: 0;
            border-radius: inherit;
            background: linear-gradient(
                90deg,
                #22c55e,
                #4ade80,
                #a3e635
            );
            transition: width 0.3s ease;
        }

        .progress-footer-row {
            margin-top: 4px;
            display: flex;
            justify-content: space-between;
            font-size: 0.76rem;
            color: rgba(209, 250, 229, 0.9);
        }

        .phase-badge {
            padding: 3px 7px;
            border-radius: 999px;
            border: 1px solid rgba(209, 250, 229, 0.6);
            background: rgba(22, 163, 74, 0.4);
            font-size: 0.72rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 8px;
        }

        .stat-pill {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 12px;
            padding: 8px 9px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            font-size: 0.78rem;
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 120px;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.76rem;
        }

        .stat-value {
            font-size: 0.88rem;
            font-weight: 600;
        }

        .stat-meta {
            font-size: 0.72rem;
            color: rgba(148, 163, 184, 0.9);
        }

        @media (max-width: 900px) {
            .header {
                flex-direction: column;
            }
            .header-metrics {
                align-items: flex-start;
            }
            .progress-card {
                width: 100%;
            }
            .top-right-meta {
                position: static;
                margin-bottom: 12px;
                align-items: flex-start;
            }
        }

        /* Layout */
        .layout-grid {
            display: grid;
            grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.4fr);
            gap: 18px;
            align-items: flex-start;
        }

        @media (max-width: 1024px) {
            .layout-grid {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        /* Cards & Elements */
        .card {
            background: var(--card-bg);
            border-radius: 18px;
            border: 1px solid var(--border-color);
            padding: 24px 24px 26px;
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.5);
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .card-title {
            font-size: 0.9rem;
            letter-spacing: 0.14em;
            text-transform: uppercase;
        }

        .card-subtitle {
            font-size: 0.86rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .badge-soft {
            font-size: 0.72rem;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: rgba(15, 23, 42, 0.95);
            color: var(--text-secondary);
        }

        .pill-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 6px;
        }

        .pill {
            font-size: 0.76rem;
            padding: 3px 7px;
            border-radius: 999px;
            border: 1px solid var(--pill-border);
            background: var(--pill-bg);
            color: var(--text-muted);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .pill span:first-child {
            font-size: 0.85rem;
        }

        .label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .pill strong {
            color: #e2e8f0;
        }

        /* Mini EOS Radar */
        .small-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px;
            margin-top: 8px;
        }

        .small-pod {
            border-radius: 14px;
            border: 1px solid rgba(148, 163, 184, 0.45);
            padding: 8px 10px;
            background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.16), rgba(15, 23, 42, 0.98));
            font-size: 0.8rem;
        }

        .small-pod span {
            display: block;
        }

        .small-pod-label {
            color: var(--text-muted);
            font-size: 0.74rem;
        }

        .small-pod-value {
            font-weight: 600;
        }

        .small-pod-sub {
            font-size: 0.72rem;
            color: rgba(148, 163, 184, 0.95);
        }

        /* Status Pills row */
        .status-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .status-pill {
            padding: 3px 8px;
            border-radius: 999px;
            font-size: 0.72rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: 1px solid rgba(148, 163, 184, 0.45);
            background: rgba(15, 23, 42, 0.98);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
        }

        .status-done .status-dot {
            background: var(--status-done);
        }

        .status-in-progress .status-dot {
            background: var(--status-in-progress);
        }

        .status-not-started .status-dot {
            background: var(--status-not-started);
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 25px 0 18px;
        }

        .tab-button {
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.4);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-secondary);
            font-size: 0.78rem;
            padding: 6px 11px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease, transform 0.1s ease;
        }

        .tab-button:hover {
            border-color: var(--people-teal);
            transform: translateY(-1px);
        }

        .tab-button.active {
            border-color: var(--people-teal);
            background: var(--people-teal-soft);
            color: #e0fdf8;
        }

        .tab-icon {
            font-size: 0.9rem;
        }

        .tab-label-sub {
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.18s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(3px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8rem;
            margin-top: 10px;
        }

        .table th,
        .table td {
            padding: 7px 8px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.3);
            text-align: left;
        }

        .table th {
            font-size: 0.76rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--text-muted);
            background: rgba(15, 23, 42, 0.88);
        }

        .table tbody tr:nth-child(even) {
            background-color: rgba(15, 23, 42, 0.85);
        }

        .table input,
        .table select,
        .table textarea {
            width: 100%;
            background: rgba(15, 23, 42, 0.9);
            border-radius: 8px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            padding: 4px 7px;
            color: var(--text-primary);
            font-size: 0.78rem;
        }

        .table textarea {
            resize: vertical;
            min-height: 48px;
        }

        .table select {
            padding-right: 20px;
        }

        .table input::placeholder,
        .table textarea::placeholder {
            color: rgba(148, 163, 184, 0.85);
        }

        .table td.compact {
            padding: 4px 6px;
        }

        /* Buttons */
        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        button {
            font-family: inherit;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.55);
            background: rgba(15, 23, 42, 0.96);
            color: var(--text-primary);
            font-size: 0.8rem;
            padding: 6px 11px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: background 0.15s ease, border-color 0.15s ease, transform 0.08s ease;
        }

        button:hover {
            background: rgba(30, 64, 175, 0.9);
            border-color: rgba(96, 165, 250, 0.9);
            transform: translateY(-1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #22c55e, #4ade80);
            border-color: rgba(34, 197, 94, 0.9);
            color: #022c22;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #4ade80, #a3e635);
        }

        .btn-secondary {
            border-color: rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-secondary);
        }

        .btn-danger {
            border-color: rgba(248, 113, 113, 0.85);
            background: rgba(127, 29, 29, 0.85);
            color: #fee2e2;
        }

        .btn-ghost {
            border-color: transparent;
            background: transparent;
            color: var(--text-muted);
            padding-inline: 2px;
        }

        .btn-ghost:hover {
            background: rgba(15, 23, 42, 0.8);
            border-color: rgba(148, 163, 184, 0.5);
        }

        button span:first-child {
            font-size: 0.9rem;
        }

        .section-footer {
            margin-top: 16px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .section-footer-note {
            font-size: 0.76rem;
            color: var(--text-muted);
        }

        /* Chips & Tags */
        .tag-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 6px;
        }

        .tag {
            font-size: 0.72rem;
            padding: 3px 7px;
            border-radius: 999px;
            background: var(--tag-bg);
            color: var(--tag-text);
            border: 1px solid rgba(96, 165, 250, 0.7);
        }

        .tiny-label {
            font-size: 0.74rem;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .chip-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .chip {
            font-size: 0.74rem;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid var(--chip-border);
            background: var(--chip-bg);
            color: var(--text-secondary);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .chip span:first-child {
            font-size: 0.9rem;
        }

        .danger-chip {
            border-color: rgba(248, 113, 113, 0.8);
            background: rgba(127, 29, 29, 0.85);
            color: #fee2e2;
        }

        .success-chip {
            border-color: rgba(34, 197, 94, 0.85);
            background: rgba(5, 46, 22, 0.9);
            color: #bbf7d0;
        }

        .warning-chip {
            border-color: rgba(251, 191, 36, 0.85);
            background: rgba(120, 53, 15, 0.9);
            color: #fef3c7;
        }

        /* AI Suggestion Panel */
        .ai-panel {
            background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), rgba(15, 23, 42, 0.96));
            border-radius: 16px;
            border: 1px solid rgba(56, 189, 248, 0.65);
            padding: 10px 12px;
            margin-bottom: 12px;
            font-size: 0.82rem;
            color: var(--text-secondary);
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .ai-icon {
            font-size: 1rem;
        }

        .ai-title {
            font-size: 0.78rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: #e0f2fe;
        }

        .pill-list {
            margin-top: 6px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .pill-list-item {
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px dashed rgba(148, 163, 184, 0.5);
            font-size: 0.74rem;
            color: var(--text-muted);
        }

        /* Issues & IDS */
        .issues-layout {
            display: grid;
            grid-template-columns: minmax(0, 2.5fr) minmax(0, 1.5fr);
            gap: 16px;
        }

        @media (max-width: 1024px) {
            .issues-layout {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .issues-list {
            list-style: none;
            margin-top: 10px;
        }

        .issue-item {
            border-radius: 12px;
            padding: 8px 9px;
            border: 1px solid rgba(148, 163, 184, 0.55);
            background: rgba(15, 23, 42, 0.96);
            margin-bottom: 6px;
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .issue-main {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .issue-title {
            font-weight: 500;
        }

        .issue-meta {
            font-size: 0.74rem;
            color: var(--text-muted);
        }

        .issue-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            font-size: 0.72rem;
        }

        .issue-badge {
            padding: 2px 5px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.5);
        }

        .issue-actions {
            display: flex;
            flex-direction: column;
            gap: 4px;
            align-items: flex-end;
        }

        .issue-actions button {
            font-size: 0.72rem;
            padding: 3px 7px;
        }

        .severity-critical {
            border-color: rgba(248, 113, 113, 0.9);
            background: rgba(127, 29, 29, 0.9);
        }

        .severity-high {
            border-color: rgba(251, 191, 36, 0.95);
            background: rgba(120, 53, 15, 0.9);
        }

        .severity-medium {
            border-color: rgba(56, 189, 248, 0.9);
            background: rgba(12, 74, 110, 0.9);
        }

        .severity-low {
            border-color: rgba(34, 197, 94, 0.8);
            background: rgba(5, 46, 22, 0.9);
        }

        /* IDS Log Table */
        .ids-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.78rem;
            margin-top: 8px;
        }

        .ids-table th,
        .ids-table td {
            border-bottom: 1px solid rgba(148, 163, 184, 0.4);
            padding: 6px 7px;
            text-align: left;
        }

        .ids-table th {
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-size: 0.74rem;
            color: var(--text-muted);
        }

        .ids-table input,
        .ids-table textarea,
        .ids-table select {
            width: 100%;
            font-size: 0.78rem;
            padding: 3px 6px;
            border-radius: 8px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(15, 23, 42, 0.95);
            color: var(--text-primary);
        }

        textarea {
    min-height: 46px;
    resize: vertical;
    width: 100%;          /* ðŸ‘ˆ add this line */
    box-sizing: border-box;
}

        .ids-table .small-input {
            width: 60px;
        }

        /* L10 */
        .l10-grid {
            display: grid;
            grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.4fr);
            gap: 14px;
        }

        @media (max-width: 1024px) {
            .l10-grid {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .checklist {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-top: 6px;
            font-size: 0.8rem;
        }

        .checklist-item {
            display: flex;
            gap: 6px;
            align-items: flex-start;
        }

        .checklist-item input[type="checkbox"] {
            margin-top: 2px;
        }

        .checklist-label {
            color: var(--text-secondary);
        }

        .inline-input {
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            padding: 3px 7px;
            font-size: 0.78rem;
            background: rgba(15, 23, 42, 0.98);
            color: var(--text-primary);
            min-width: 60px;
        }

        /* Culture & Accountability */
        .score-pill-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .score-pill {
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: rgba(15, 23, 42, 0.96);
            font-size: 0.78rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .score-pill-label {
            font-size: 0.74rem;
            color: var(--text-muted);
        }

        .score-pill-value {
            font-weight: 600;
        }

        .heatmap-grid {
            margin-top: 12px;
            display: grid;
            grid-template-columns: 180px repeat(4, minmax(0, 1fr));
            font-size: 0.78rem;
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(148, 163, 184, 0.4);
        }

        .heatmap-grid > div {
            border-bottom: 1px solid rgba(148, 163, 184, 0.35);
            border-right: 1px solid rgba(148, 163, 184, 0.25);
            padding: 6px 8px;
        }

        .heatmap-grid > div:last-child {
            border-right: none;
        }

        .heatmap-header {
            background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.25), rgba(15, 23, 42, 0.96));
            font-size: 0.76rem;
            font-weight: 600;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: rgba(226, 232, 240, 0.9);
        }

        .heatmap-label {
            background: rgba(15, 23, 42, 0.98);
            font-size: 0.78rem;
            font-weight: 500;
        }

        .heatmap-cell {
            cursor: pointer;
            text-align: center;
            transition: background 0.15s ease, color 0.15s ease, transform 0.06s ease;
        }

        .heatmap-cell:hover {
            transform: translateY(-1px);
        }

        .heatmap-level-0 {
            background: rgba(15, 23, 42, 0.95);
            color: var(--text-muted);
        }

        .heatmap-level-1 {
            background: rgba(51, 65, 85, 0.9);
            color: #e5e7eb;
        }

        .heatmap-level-2 {
            background: rgba(34, 197, 94, 0.18);
            color: #bbf7d0;
        }

        .heatmap-level-3 {
            background: rgba(34, 197, 94, 0.38);
            color: #ecfdf5;
        }

        .heatmap-legend {
            font-size: 0.76rem;
            color: var(--text-muted);
            margin-top: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .heatmap-legend span {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .heatmap-dot {
            width: 12px;
            height: 12px;
            border-radius: 999px;
            display: inline-block;
        }

        .hm-dot-0 {
            background: rgba(15, 23, 42, 0.96);
        }

        .hm-dot-1 {
            background: rgba(51, 65, 85, 0.9);
        }

        .hm-dot-2 {
            background: rgba(34, 197, 94, 0.18);
        }

        .hm-dot-3 {
            background: rgba(34, 197, 94, 0.38);
        }

        /* Export Panels */
        .export-grid {
            display: grid;
            grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.8fr);
            gap: 14px;
        }

        @media (max-width: 1024px) {
            .export-grid {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .export-card {
            border-radius: 18px;
            padding: 14px 14px 16px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: rgba(15, 23, 42, 0.96);
            box-shadow: var(--shadow-subtle);
        }

        .export-title {
            font-size: 0.9rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
        }

        .export-sub {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .export-list {
            list-style: none;
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            font-size: 0.8rem;
        }

        .export-list li {
            display: flex;
            align-items: flex-start;
            gap: 6px;
        }

        .export-bullet {
            margin-top: 4px;
            font-size: 0.75rem;
        }

        .export-meta {
            font-size: 0.76rem;
            color: var(--text-muted);
            margin-top: 8px;
        }

        .priority-label {
            font-size: 0.74rem;
            letter-spacing: 0.14em;
            text-transform: uppercase;
            color: #a5b4fc;
        }

        .pill-priority {
            padding: 3px 7px;
            border-radius: 999px;
            border: 1px solid rgba(129, 140, 248, 0.7);
            background: rgba(30, 64, 175, 0.95);
            font-size: 0.74rem;
            color: #e0e7ff;
        }

        .export-meta strong {
            color: #e5e7eb;
        }

        /* Forms & Inputs */
        .input-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
.field textarea {
    width: 100%;
}


        .input-group {
            flex: 1;
            min-width: 120px;
        }

        .input-group label {
            display: block;
            font-size: 0.76rem;
            color: var(--text-muted);
            margin-bottom: 3px;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(15, 23, 42, 0.98);
            padding: 5px 9px;
            color: var(--text-primary);
            font-size: 0.78rem;
        }

        /* Progress Badges */
        .progress-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.76rem;
            padding: 3px 7px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(15, 23, 42, 0.96);
        }

        .progress-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
        }

        .progress-status-done {
            background: var(--status-done);
        }

        .progress-status-partial {
            background: var(--status-in-progress);
        }

        .progress-status-not {
            background: var(--status-not-started);
        }

        .progress-meta {
            font-size: 0.74rem;
            color: var(--text-muted);
        }

        /* People Row Chips in RPRS */
        .rprs-grid {
            display: grid;
            grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.6fr);
            gap: 14px;
        }

        @media (max-width: 1024px) {
            .rprs-grid {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .rprs-list {
            list-style: none;
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            font-size: 0.8rem;
        }

        .rprs-row {
            border-radius: 12px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(15, 23, 42, 0.96);
            padding: 7px 9px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .rprs-main {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .rprs-seat {
            font-weight: 500;
        }

        .rprs-person {
            font-size: 0.78rem;
            color: var(--text-secondary);
        }

        .rprs-meta-row {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            font-size: 0.74rem;
            color: var(--text-muted);
        }

        .rprs-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            font-size: 0.74rem;
        }

        .rprs-tag {
            padding: 2px 5px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
        }

        .rprs-status {
            padding: 3px 7px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            font-size: 0.74rem;
        }

        .rprs-status-good {
            border-color: rgba(34, 197, 94, 0.8);
            background: rgba(5, 46, 22, 0.9);
            color: #bbf7d0;
        }

        .rprs-status-risk {
            border-color: rgba(251, 191, 36, 0.9);
            background: rgba(120, 53, 15, 0.9);
            color: #fef3c7;
        }

        .rprs-status-bad {
            border-color: rgba(248, 113, 113, 0.9);
            background: rgba(127, 29, 29, 0.9);
            color: #fee2e2;
        }

        /* Tag colors */
        .tag-critical {
            border-color: rgba(248, 113, 113, 0.9);
            background: rgba(127, 29, 29, 0.9);
            color: #fee2e2;
        }

        .tag-owner {
            border-color: rgba(56, 189, 248, 0.9);
            background: rgba(12, 74, 110, 0.9);
            color: #e0f2fe;
        }

        .tag-people {
            border-color: rgba(94, 234, 212, 0.9);
            background: rgba(6, 78, 59, 0.9);
            color: #ccfbf1;
        }

        /* Badge Colour inline strengths */
        .strength-pod {
            padding: 7px 9px;
            border-radius: 14px;
            border: 1px solid rgba(34, 197, 94, 0.7);
            background: radial-gradient(circle at top left, rgba(34, 197, 94, 0.3), rgba(15, 23, 42, 0.98));
            font-size: 0.8rem;
            margin-top: 8px;
        }

        .strength-pod strong {
            color: #bbf7d0;
        }

        .strength-pod p {
            margin-top: 3px;
            color: rgba(226, 232, 240, 0.9);
        }

        .risk-pod {
            padding: 7px 9px;
            border-radius: 14px;
            border: 1px solid rgba(248, 113, 113, 0.8);
            background: radial-gradient(circle at top left, rgba(248, 113, 113, 0.3), rgba(15, 23, 42, 0.98));
            font-size: 0.8rem;
            margin-top: 8px;
        }

        .risk-pod strong {
            color: #fecaca;
        }

        .risk-pod p {
            margin-top: 3px;
            color: rgba(254, 242, 242, 0.92);
        }

        .inline-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 0.74rem;
            padding: 2px 6px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(15, 23, 42, 0.96);
        }

        /* Link styles -->
        a.tool-link {
            color: #38bdf8;
            text-decoration: none;
            font-size: 0.8rem;
        }

        a.tool-link:hover {
            text-decoration: underline;
        }

        /* ========================================
           ACCOUNTABILITY CHART TAB STYLES
           Scoped to #tab-org
           ======================================== */
            #tab-org {
            --bg: #020617;
            --bg-alt: #020617;
            --card-bg: rgba(15, 23, 42, 0.92);
            --surface: rgba(15, 23, 42, 0.92);
            --surface-soft: rgba(15, 23, 42, 0.82);
            --border-subtle: rgba(148, 163, 184, 0.45);
            --border-strong: rgba(148, 163, 184, 0.9);
            --accent: #38bdf8;
            --accent-soft: rgba(56, 189, 248, 0.14);
            --accent-strong: #0ea5e9;
            --accent-secondary: #a855f7;
            --accent-secondary-soft: rgba(168, 85, 247, 0.16);
            --text: #e5e7eb;
            --muted: #94a3b8;
            --muted-soft: rgba(148, 163, 184, 0.7);
            --danger: #fb7185;
            --danger-soft: rgba(248, 113, 113, 0.22);
            --warning: #facc15;
            --warning-soft: rgba(250, 204, 21, 0.16);
            --success: #4ade80;
            --success-soft: rgba(74, 222, 128, 0.16);
            --shadow-soft: 0 22px 60px rgba(15, 23, 42, 0.95);
            --shadow-card: 0 18px 40px rgba(15, 23, 42, 0.9);
            --shadow-subtle: 0 1px 0 rgba(15, 23, 42, 0.85);
    }

    #tab-org.light {
            --bg: #eef2ff;
            --bg-alt: #e5e7eb;
            --card-bg: #ffffff;
            --surface: #ffffff;
            --surface-soft: #f9fafb;
            --border-subtle: rgba(148, 163, 184, 0.4);
            --border-strong: rgba(30, 64, 175, 0.7);
            --accent: #0ea5e9;
            --accent-soft: rgba(14, 165, 233, 0.12);
            --accent-strong: #0284c7;
            --accent-secondary: #7c3aed;
            --accent-secondary-soft: rgba(124, 58, 237, 0.12);
            --text: #020617;
            --muted: #4b5563;
            --muted-soft: rgba(75, 85, 99, 0.75);
            --danger: #b91c1c;
            --danger-soft: rgba(248, 113, 113, 0.18);
            --warning: #ca8a04;
            --warning-soft: rgba(234, 179, 8, 0.16);
            --success: #15803d;
            --success-soft: rgba(34, 197, 94, 0.14);
            --shadow-soft: 0 26px 70px rgba(15, 23, 42, 0.35);
            --shadow-card: 0 18px 40px rgba(15, 23, 42, 0.18);
            --shadow-subtle: 0 1px 0 rgba(148, 163, 184, 0.5);
    }

        * {
            box-sizing: border-box;
    }

        html, body {
            margin: 0;
            padding: 0;
    }

    #tab-org {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background:
                radial-gradient(circle at 0% 0%, rgba(56, 189, 248, 0.18), transparent 55%),
                radial-gradient(circle at 100% 0%, rgba(129, 140, 248, 0.25), transparent 50%),
                radial-gradient(circle at 0% 100%, rgba(96, 165, 250, 0.2), transparent 55%),
                radial-gradient(circle at 100% 100%, rgba(56, 189, 248, 0.16), transparent 55%),
                var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding: 24px;
    }

    #tab-org .page {
            max-width: 1320px;
            margin: 0 auto;
    }

    #tab-org .header {
            background:
                radial-gradient(circle at 0% 0%, rgba(56, 189, 248, 0.35), transparent 50%),
                radial-gradient(circle at 100% 0%, rgba(168, 85, 247, 0.38), transparent 55%),
                radial-gradient(circle at 0% 100%, rgba(56, 189, 248, 0.25), transparent 55%),
                linear-gradient(135deg, #020617 0%, #0b1220 20%, #111827 60%, #1f2937 100%);
            border-radius: 26px;
            padding: 20px 24px;
            box-shadow: var(--shadow-soft);
            margin-bottom: 18px;
            position: relative;
            overflow: hidden;
    }

    #tab-org .header::before {
            content: "";
            position: absolute;
            inset: 0;
            background:
                radial-gradient(circle at 15% 0%, rgba(56, 189, 248, 0.35), transparent 55%),
                radial-gradient(circle at 100% 20%, rgba(168, 85, 247, 0.25), transparent 60%);
            opacity: 0.7;
            pointer-events: none;
    }

    #tab-org .header-inner {
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: minmax(0, 2.2fr) minmax(0, 2fr);
            gap: 24px;
            align-items: center;
    }

        @media (max-width: 900px) {
    #tab-org .header-inner {
                grid-template-columns: minmax(0, 1fr);
    }
    }

    #tab-org .title-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
    }

    #tab-org .eyebrow {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: rgba(226, 232, 240, 0.9);
    }

    #tab-org .eyebrow-pill {
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.75);
            background: rgba(15, 23, 42, 0.8);
            font-size: 0.72rem;
    }

    #tab-org .title-row {
            display: flex;
            flex-wrap: wrap;
            align-items: baseline;
            gap: 8px;
    }

        h1 {
            margin: 0;
            font-size: 1.9rem;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            color: #e5e7eb;
    }

    #tab-org .company-label {
            font-size: 0.95rem;
            color: rgba(226, 232, 240, 0.9);
    }

    #tab-org .subtitle {
            margin-top: 4px;
            font-size: 0.9rem;
            color: rgba(226, 232, 240, 0.85);
            max-width: 560px;
    }

    #tab-org .controls-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
    }

    #tab-org .company-input {
            min-width: 180px;
            flex: 1;
    }

    #tab-org .company-input input {
            width: 100%;
            padding: 7px 10px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.7);
            color: #e5e7eb;
            font-size: 0.85rem;
    }

    #tab-org.light .company-input input {
            background: rgba(249, 250, 251, 0.9);
            color: #020617;
    }

    #tab-org .company-input input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.65);
            background: rgba(15, 23, 42, 0.9);
    }

    #tab-org.light .company-input input:focus {
            background: #ffffff;
    }

    #tab-org .chips-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
    }

    #tab-org .chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.75rem;
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(15, 23, 42, 0.85);
            color: rgba(226, 232, 240, 0.9);
    }

    #tab-org.light .chip {
            background: rgba(249, 250, 251, 0.9);
    }

    #tab-org .chip strong {
            font-weight: 600;
    }

    #tab-org .header-right {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
    }

        @media (max-width: 900px) {
    #tab-org .header-right {
                align-items: flex-start;
    }
    }

    #tab-org .mode-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: flex-end;
    }

        @media (max-width: 900px) {
    #tab-org .mode-row {
                justify-content: flex-start;
    }
    }

    #tab-org .toggle-pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 5px 10px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.85);
            color: rgba(226, 232, 240, 0.9);
            font-size: 0.76rem;
            cursor: pointer;
            user-select: none;
    }

    #tab-org.light .toggle-pill {
            background: rgba(249, 250, 251, 0.95);
    }

    #tab-org .toggle-pill input {
            display: none;
    }

    #tab-org .toggle-thumb {
            width: 32px;
            height: 16px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.85);
            position: relative;
    }

    #tab-org .toggle-circle {
            position: absolute;
            top: 1px;
            left: 1px;
            width: 12px;
            height: 12px;
            border-radius: 999px;
            background: #e5e7eb;
            transition: transform 0.18s ease;
    }

    #tab-org.light .toggle-circle {
            transform: translateX(14px);
    }

    #tab-org .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: flex-end;
    }

        @media (max-width: 900px) {
    #tab-org .toolbar {
                justify-content: flex-start;
    }
    }

        button {
            font-family: inherit;
    }

    #tab-org .button {
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.9);
            color: #e5e7eb;
            padding: 6px 11px;
            font-size: 0.8rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            box-shadow: var(--shadow-subtle);
            transition: transform 0.06s ease, box-shadow 0.06s ease, border-color 0.12s ease, background 0.12s ease;
    }

    #tab-org .button:active {
            transform: translateY(0);
            box-shadow: none;
    }

    #tab-org .button.primary {
            border-color: rgba(59, 130, 246, 0.9);
            background: radial-gradient(circle at 0% 0%, rgba(56, 189, 248, 0.35), transparent 55%), linear-gradient(135deg, #2563eb, #4f46e5);
            color: #eff6ff;
    }

    #tab-org .button.outline {
            background: transparent;
    }

    #tab-org .button.danger {
            border-color: rgba(248, 113, 113, 0.9);
            background: rgba(127, 29, 29, 0.96);
    }

    #tab-org.light .button {
            background: #ffffff;
            color: #020617;
    }

    #tab-org.light .button.primary {
            background: linear-gradient(135deg, #2563eb, #4f46e5);
            color: #eff6ff;
    }

    #tab-org.light .button.danger {
            background: #fee2e2;
            color: #7f1d1d;
    }

    #tab-org .button .icon {
            font-size: 1rem;
    }

    #tab-org .main {
            display: grid;
            grid-template-columns: minmax(0, 2.1fr) minmax(0, 3fr);
            gap: 16px;
            align-items: flex-start;
    }

        @media (max-width: 1024px) {
    #tab-org .main {
                grid-template-columns: minmax(0, 1fr);
    }
    }

    #tab-org .panel {
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid var(--border-subtle);
            padding: 14px 16px;
            box-shadow: var(--shadow-card);
    }

    #tab-org .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            gap: 8px;
    }

    #tab-org .panel-title {
            font-size: 0.9rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--muted);
    }

    #tab-org .panel-subtitle {
            font-size: 0.78rem;
            color: var(--muted-soft);
    }

    #tab-org .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.9);
            color: var(--muted-soft);
    }

    #tab-org.light .pill {
            background: rgba(249, 250, 251, 0.95);
    }

    #tab-org .form-grid {
            display: grid;
            grid-template-columns: minmax(0, 1fr);
            gap: 10px;
    }

    #tab-org .field {
            display: flex;
            flex-direction: column;
            gap: 4px;
    }

    #tab-org .field-label {
            font-size: 0.78rem;
            color: var(--muted);
    }

    #tab-org .field-label .hint {
            font-size: 0.74rem;
            color: var(--muted-soft);
    }

        input[type="text"], textarea, select {
            font-family: inherit;
            font-size: 0.84rem;
            border-radius: 10px;
            border: 1px solid rgba(148, 163, 184, 0.8);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text);
            padding: 6px 8px;
    }

        textarea {
            min-height: 46px;
            resize: vertical;
    }

        select {
            padding-right: 24px;
    }

    #tab-org.light input[type="text"],
    #tab-org.light textarea,
    #tab-org.light select {
            background: rgba(249, 250, 251, 0.96);
            color: #020617;
    }

        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.6);
    }

    #tab-org .row-inline {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
    }

    #tab-org .row-inline .field {
            flex: 1;
            min-width: 140px;
    }

    #tab-org .divider {
            height: 1px;
            background: linear-gradient(to right, transparent, rgba(148, 163, 184, 0.55), transparent);
            margin: 10px 0;
    }

    #tab-org .checkbox-row {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: var(--muted-soft);
    }

    #tab-org .checkbox-row input[type="checkbox"] {
            width: 14px;
            height: 14px;
            border-radius: 4px;
            border: 1px solid rgba(148, 163, 184, 0.8);
            background: rgba(15, 23, 42, 0.9);
    }

    #tab-org.light .checkbox-row input[type="checkbox"] {
            background: #ffffff;
    }

    #tab-org .small-text {
            font-size: 0.75rem;
            color: var(--muted-soft);
    }

    #tab-org .section-title-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 8px;
            margin-bottom: 4px;
    }

    #tab-org .section-title {
            font-size: 0.78rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--muted);
    }

    #tab-org .section-subtitle {
            font-size: 0.76rem;
            color: var(--muted-soft);
    }

    #tab-org .mini-button {
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.92);
            color: var(--muted-soft);
            padding: 3px 8px;
            font-size: 0.74rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 4px;
    }

    #tab-org .mini-button .icon {
            font-size: 0.9rem;
    }

    #tab-org.light .mini-button {
            background: #f9fafb;
    }

    #tab-org .mini-button.primary {
            border-color: rgba(56, 189, 248, 0.9);
            color: var(--accent-strong);
            background: var(--accent-soft);
    }

    #tab-org .mini-button.danger {
            border-color: rgba(248, 113, 113, 0.9);
            color: var(--danger);
            background: var(--danger-soft);
    }

    #tab-org .functions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 12px;
    }

    #tab-org .function-card {
            background: var(--surface);
            border-radius: 16px;
            border: 1px solid var(--border-subtle);
            padding: 10px 10px 10px;
            box-shadow: 0 12px 30px rgba(15, 23, 42, 0.85);
            display: flex;
            flex-direction: column;
            gap: 8px;
    }

    #tab-org.light .function-card {
            box-shadow: 0 10px 25px rgba(15, 23, 42, 0.1);
    }

    #tab-org .function-card.collapsed {
            background: var(--surface-soft);
    }

    #tab-org .function-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
    }

    #tab-org .function-header-left {
            display: flex;
            flex-direction: column;
            gap: 2px;
    }

    #tab-org .function-name {
            font-size: 0.92rem;
            font-weight: 600;
            color: var(--text);
    }

    #tab-org .seat-count {
            font-size: 0.76rem;
            color: var(--muted-soft);
    }

    #tab-org .function-header-right {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: flex-end;
    }

    #tab-org .function-focus-icon {
            border-radius: 999px;
            border: 1px solid rgba(96, 165, 250, 0.9);
            background: rgba(15, 23, 42, 0.96);
            color: rgba(239, 246, 255, 0.95);
            padding: 3px 7px;
            font-size: 0.76rem;
            display: inline-flex;
            align-items: center;
            gap: 4px;
    }

    #tab-org.light .function-focus-icon {
            background: #eff6ff;
            color: #1d4ed8;
    }

    #tab-org .function-focus-icon .icon {
            font-size: 0.9rem;
    }

    #tab-org .seats-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-top: 4px;
    }

    #tab-org .seat-card {
            border-radius: 12px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(30, 64, 175, 0.9);
            padding: 8px 9px;
    }

    #tab-org.light .seat-card {
            background: #f9fafb;
            border-color: rgba(59, 130, 246, 0.25);
    }

    #tab-org .seat-card.collapsed-details {
            border-style: dashed;
    }

    #tab-org .seat-top {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 6px;
            cursor: pointer;
    }

    #tab-org .seat-role {
            font-size: 0.88rem;
            font-weight: 600;
    }

    #tab-org .seat-owner {
            font-size: 0.8rem;
            color: var(--muted-soft);
    }

    #tab-org .seat-owner.empty {
            font-style: italic;
            opacity: 0.8;
    }

    #tab-org .seat-meta {
            margin-top: 3px;
            font-size: 0.76rem;
            color: var(--muted-soft);
    }

    #tab-org .seat-detail-block {
            margin-top: 5px;
            font-size: 0.78rem;
    }

    #tab-org .seat-detail-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--muted);
            margin-bottom: 2px;
    }

    #tab-org .seat-detail-body {
            font-size: 0.78rem;
            color: var(--muted-soft);
    }

    #tab-org .empty-state {
            font-size: 0.8rem;
            color: var(--muted-soft);
            border-radius: 12px;
            border: 1px dashed rgba(148, 163, 184, 0.6);
            padding: 8px;
            background: rgba(15, 23, 42, 0.6);
    }

    #tab-org.light .empty-state {
            background: rgba(249, 250, 251, 0.9);
    }

    #tab-org .summary-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
            align-items: center;
    }

    #tab-org .summary-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.78rem;
            padding: 4px 9px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.9);
            color: var(--muted-soft);
    }

    #tab-org .summary-chip strong {
            font-weight: 600;
            color: var(--text);
    }

    #tab-org.light .summary-chip {
            background: #f9fafb;
    }

    #tab-org .focus-bar {
            display: none;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            padding: 8px 10px;
            border-radius: 999px;
            background: radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.25), transparent 55%), rgba(15, 23, 42, 0.92);
            border: 1px solid rgba(56, 189, 248, 0.7);
            margin-bottom: 8px;
    }

    #tab-org.light .focus-bar {
            background: radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.18), transparent 55%), #eff6ff;
    }

    #tab-org .focus-label {
            display: inline-flex;
            align-items: baseline;
            gap: 6px;
            font-size: 0.8rem;
    }

    #tab-org .focus-label .label {
            text-transform: uppercase;
            letter-spacing: 0.12em;
            font-size: 0.7rem;
            color: var(--muted);
    }

    #tab-org .focus-label .value {
            font-weight: 600;
    }

    #tab-org .pill-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 8px;
    }

    #tab-org .pill-summary {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.9);
            color: var(--muted-soft);
    }

    #tab-org.light .pill-summary {
            background: #f9fafb;
    }

    #tab-org .next-steps {
            margin-top: 18px;
            background: rgba(15, 23, 42, 0.9);
            border-radius: 18px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            padding: 12px 14px;
            box-shadow: 0 14px 35px rgba(15, 23, 42, 0.9);
    }

    #tab-org.light .next-steps {
            background: #f9fafb;
            box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
    }

    #tab-org .next-steps-title {
            font-size: 0.82rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--muted);
            margin-bottom: 6px;
    }

    #tab-org .next-steps-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 6px;
    }

    #tab-org .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 6px;
            font-size: 0.8rem;
            color: var(--muted-soft);
    }

    #tab-org .checklist-item input[type="checkbox"] {
            margin-top: 2px;
    }

    #tab-org .checklist-item strong {
            font-weight: 600;
            color: var(--text);
    }

        @media (max-width: 640px) {
    #tab-org {
                padding: 16px;
    }

    }
    #tab-org .lead-link-gradient {
    display: inline-block;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 14px 28px;
    border-radius: 50px;
    text-decoration: none;
    font-weight: 700;
    font-size: 16px;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    #tab-org .lead-link-gradient:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);

    }


        /* ========================================
           PEOPLE ANALYZER TAB STYLES  
           Scoped to #tab-people
           ======================================== */
    * { box-sizing: border-box; margin: 0; padding: 0; }

        #tab-people {
      --bg: #050b16;
      --bg-alt: #020617;
      --card-bg: rgba(15, 23, 42, 0.96);
      --text: #f9fafb;
      --muted: #94a3b8;
      --border-subtle: rgba(148, 163, 184, 0.4);
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.14);
      --danger: #f97373;
      --danger-soft: rgba(248, 113, 113, 0.18);
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.9);
    }

    #tab-people[data-theme="light"] {
      --bg: #f3f4f6;
      --bg-alt: #e5e7eb;
      --card-bg: #ffffff;
      --text: #020617;
      --muted: #6b7280;
      --border-subtle: rgba(148, 163, 184, 0.7);
      --accent: #16a34a;
      --accent-soft: rgba(22, 163, 74, 0.12);
      --danger: #b91c1c;
      --danger-soft: rgba(248, 113, 113, 0.14);
      --shadow-soft: 0 16px 35px rgba(15, 23, 42, 0.25);
    }

    #tab-people {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at 0% 0%, rgba(56, 189, 248, 0.16), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(129, 140, 248, 0.18), transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(56, 189, 248, 0.14), transparent 55%),
        var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
    }

    #tab-people .container {
      max-width: 1300px;
      margin: 0 auto;
    }

    header.header {
      background:
        radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.28), transparent 55%),
        radial-gradient(circle at 100% 0, rgba(168, 85, 247, 0.26), transparent 55%),
        linear-gradient(135deg, #020617, #0f172a, #1e293b);
      border-radius: 22px;
      padding: 18px 20px;
      box-shadow: var(--shadow-soft);
      color: #e5e7eb;
      margin-bottom: 18px;
      display: flex;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }

    #tab-people .header-main {
      max-width: 650px;
    }

    #tab-people .title-row {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    #tab-people .title-row h1 {
      font-size: 1.6rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    #tab-people .badge {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      background: rgba(15, 23, 42, 0.7);
    }

    #tab-people .subtitle {
      margin-top: 4px;
      font-size: 0.9rem;
      color: rgba(226, 232, 240, 0.9);
    }

    #tab-people .header-meta {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: flex-end;
    }

    @media (max-width: 800px) {
    #tab-people .header {
        flex-direction: column;
    }
    #tab-people .header-meta { align-items: flex-start; }
    }

    #tab-people .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    #tab-people .pill {
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.7);
      font-size: 0.74rem;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    #tab-people[data-theme="light"] .pill {
      background: rgba(249, 250, 251, 0.95);
    }

    #tab-people .theme-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.75);
      padding: 4px 10px;
      font-size: 0.8rem;
      cursor: pointer;
      user-select: none;
    }

    #tab-people[data-theme="light"] .theme-toggle {
      background: rgba(249, 250, 251, 0.95);
    }

    #tab-people .toggle-track {
      width: 34px;
      height: 16px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.9);
      position: relative;
    }

    #tab-people .toggle-knob {
      position: absolute;
      top: 1px;
      left: 1px;
      width: 12px;
      height: 12px;
      border-radius: 999px;
      background: #e5e7eb;
      transition: transform 0.18s ease;
    }

    #tab-people[data-theme="light"] .toggle-knob {
      transform: translateX(16px);
    }

    #tab-people .layout {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    #tab-people .top-row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: stretch;
    }

    #tab-people .card {
      background: var(--card-bg);
      border-radius: 18px;
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
      padding: 14px 16px;
    }

    #tab-people .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 8px;
      gap: 8px;
    }

    #tab-people .card-title {
      font-size: 0.9rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--muted);
    }

    #tab-people .card-subtitle {
      font-size: 0.8rem;
      color: var(--muted);
    }

    #tab-people .insights-card { flex: 1.2; min-width: 260px; }
    #tab-people .controls-card { flex: 1; min-width: 260px; }

    #tab-people .insight-banner {
      padding: 10px 12px;
      border-radius: 13px;
      border: 1px solid rgba(56, 189, 248, 0.6);
      background: linear-gradient(
        120deg,
        rgba(56, 189, 248, 0.12),
        rgba(22, 163, 74, 0.12)
      );
      font-size: 0.83rem;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    #tab-people .insight-main { font-weight: 600; }

    #tab-people .insight-metrics {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    #tab-people .insight-chip {
      font-size: 0.74rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    #tab-people[data-theme="light"] .insight-chip {
      background: #f9fafb;
    }

    #tab-people .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    button {
      font-family: inherit;
      border: none;
      cursor: pointer;
      transition: transform 0.06s ease, box-shadow 0.06s ease, background 0.1s ease, border-color 0.1s ease;
    }

    #tab-people .btn {
      font-size: 0.8rem;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    #tab-people[data-theme="light"] .btn {
      background: #ffffff;
    }

    #tab-people .btn-primary {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      border-color: rgba(22, 163, 74, 0.9);
      color: #ecfdf5;
      box-shadow: 0 10px 22px rgba(22, 163, 74, 0.35);
    }

    #tab-people .btn-danger {
      background: rgba(127, 29, 29, 0.95);
      border-color: rgba(248, 113, 113, 0.9);
      color: #fee2e2;
    }

    #tab-people .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(15, 23, 42, 0.6);
    }

    #tab-people .btn:active {
      transform: translateY(0);
      box-shadow: none;
    }

    /* Core Value Explorer */

    #tab-people .values-card { margin-top: 2px; }

    #tab-people .values-help {
      font-size: 0.8rem;
      color: var(--muted);
    }

    #tab-people .function-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
      margin-bottom: 8px;
    }

    #tab-people .fn-tab {
      font-size: 0.76rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    #tab-people .fn-tab.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      color: var(--accent);
      font-weight: 600;
    }

    #tab-people[data-theme="light"] .fn-tab {
      background: #f3f4f6;
    }

    #tab-people .fn-tab-delete {
      font-size: 0.9em;
      opacity: 0.7;
      cursor: pointer;
    }

    #tab-people .fn-add {
      font-size: 0.76rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px dashed rgba(148, 163, 184, 0.8);
      background: transparent;
      color: var(--muted);
    }

    #tab-people .values-details {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    #tab-people .value-row {
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      padding: 8px 9px;
    }

    #tab-people[data-theme="light"] .value-row {
      background: #f9fafb;
    }

    #tab-people .value-row.highlight {
      box-shadow: 0 0 0 1px var(--accent);
      background: var(--accent-soft);
    }

    #tab-people .value-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 4px;
    }

    #tab-people .value-name {
      font-size: 0.84rem;
      font-weight: 600;
    }

    #tab-people .value-badge {
      font-size: 0.72rem;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      color: var(--muted);
      background: rgba(15, 23, 42, 0.85);
    }

    #tab-people[data-theme="light"] .value-badge {
      background: #ffffff;
    }

    #tab-people .value-textarea {
      width: 100%;
      min-height: 46px;
      border-radius: 8px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
      font-size: 0.78rem;
      padding: 5px 7px;
      resize: vertical;
    }

    #tab-people[data-theme="light"] .value-textarea {
      background: #ffffff;
    }

    #tab-people .values-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
      font-size: 0.75rem;
      color: var(--muted);
    }

    #tab-people .legend-chip {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.85);
    }

    #tab-people[data-theme="light"] .legend-chip {
      background: #f3f4f6;
    }

    /* People Analyzer Grid */

    #tab-people .people-card { margin-top: 2px; }

    #tab-people .table-wrapper {
      margin-top: 6px;
      border-radius: 14px;
      overflow: auto;
      border: 1px solid var(--border-subtle);
      background: rgba(15, 23, 42, 0.96);
    }

    #tab-people[data-theme="light"] .table-wrapper {
      background: #f9fafb;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      min-width: 1400px;
      font-size: 0.8rem;
    }

    thead {
      position: sticky;
      top: 0;
      z-index: 5;
      background: rgba(15, 23, 42, 0.98);
    }

    #tab-people[data-theme="light"] thead {
      background: #f3f4f6;
    }

    th, td {
      padding: 8px 10px;
      border-bottom: 1px solid rgba(51, 65, 85, 0.7);
      text-align: left;
    }

    th {
      font-size: 0.7rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--muted);
      white-space: nowrap;
    }

    tbody tr:nth-child(even) {
      background: rgba(15, 23, 42, 0.85);
    }

    #tab-people[data-theme="light"] tbody tr:nth-child(even) {
      background: #eef2ff;
    }

    tbody tr:hover {
      background: rgba(30, 64, 175, 0.35);
    }

    #tab-people[data-theme="light"] tbody tr:hover {
      background: #dbeafe;
    }

    #tab-people .name-input, .seat-input {
      width: 100%;
      font-size: 0.78rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: transparent;
      color: var(--text);
      padding: 4px 7px;
    }

    #tab-people .name-input:focus, .seat-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.7);
      background: rgba(15, 23, 42, 0.95);
    }

    #tab-people[data-theme="light"] .name-input:focus,
    #tab-people[data-theme="light"] .seat-input:focus {
      background: #ffffff;
    }

    #tab-people .fn-select {
      width: 100%;
      font-size: 0.78rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
      padding: 4px 7px;
    }

    #tab-people[data-theme="light"] .fn-select {
      background: #ffffff;
    }

    #tab-people .core-header {
      border-radius: 999px;
      padding: 6px 8px;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      min-width: 140px;
      white-space: normal;
      text-align: left;
      line-height: 1.2;
      cursor: pointer;
    }

    #tab-people .core-header:hover {
      border-style: solid;
      border-color: var(--accent);
      background: rgba(15, 23, 42, 0.9);
    }

    #tab-people[data-theme="light"] .core-header:hover {
      background: #e5e7eb;
    }

    #tab-people .score-buttons {
      display: inline-flex;
      gap: 3px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      padding: 2px 3px;
    }

    #tab-people[data-theme="light"] .score-buttons {
      background: #ffffff;
    }

    #tab-people .score-btn {
      width: 24px;
      height: 18px;
      border-radius: 999px;
      font-size: 0.7rem;
      background: transparent;
      color: var(--muted);
    }

    #tab-people .score-btn.active-plus {
      background: var(--accent-soft);
      color: var(--accent);
      font-weight: 600;
    }

    #tab-people .score-btn.active-mid {
      background: rgba(129, 140, 248, 0.16);
      color: #818cf8;
      font-weight: 600;
    }

    #tab-people .score-btn.active-minus {
      background: var(--danger-soft);
      color: var(--danger);
      font-weight: 600;
    }

    #tab-people .gwc-toggle {
      display: inline-flex;
      gap: 4px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      padding: 2px 3px;
    }

    #tab-people[data-theme="light"] .gwc-toggle {
      background: #ffffff;
    }

    #tab-people .gwc-btn {
      font-size: 0.68rem;
      border-radius: 999px;
      padding: 1px 6px;
      background: transparent;
      color: var(--muted);
    }

    #tab-people .gwc-btn.yes.active {
      background: var(--accent-soft);
      color: var(--accent);
      font-weight: 600;
    }

    #tab-people .gwc-btn.no.active {
      background: var(--danger-soft);
      color: var(--danger);
      font-weight: 600;
    }

    #tab-people .tag-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.7rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.9);
      padding: 3px 7px;
      color: var(--muted);
    }

    #tab-people .tag-pill.good {
      border-color: rgba(34, 197, 94, 0.9);
      background: var(--accent-soft);
      color: var(--accent);
    }

    #tab-people .tag-pill.bad {
      border-color: rgba(248, 113, 113, 0.9);
      background: var(--danger-soft);
      color: var(--danger);
    }

    #tab-people .action-pill {
      font-size: 0.7rem;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.9);
    }

    #tab-people .action-keep {
      border-color: rgba(34, 197, 94, 0.9);
      color: var(--accent);
    }
    #tab-people .action-move {
      border-color: rgba(129, 140, 248, 0.9);
      color: #818cf8;
    }
    #tab-people .action-coach {
      border-color: rgba(234, 179, 8, 0.9);
      color: #eab308;
    }
    #tab-people .action-exit {
      border-color: rgba(248, 113, 113, 0.9);
      color: var(--danger);
    }

    #tab-people .remove-btn {
      font-size: 0.8rem;
      background: transparent;
      color: var(--muted);
    }

    #tab-people .remove-btn:hover {
      color: var(--danger);
    }

    #tab-people .scorecard-btn {
      font-size: 0.8rem;
      background: transparent;
      color: var(--muted);
    }

    #tab-people .scorecard-btn:hover {
      color: #38bdf8;
    }

    @media (max-width: 720px) {
    #tab-people { padding: 14px; }
    }

    /* Scorecard (PDF) styles â€“ tuned for A5 look */

    #tab-people .scorecard-card {
      width: 460px;
      margin: 0 auto;
      padding: 18px 20px;
      border-radius: 18px;
      background: radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.18), transparent 55%),
                  radial-gradient(circle at 100% 0, rgba(129, 140, 248, 0.16), transparent 55%),
                  radial-gradient(circle at 0 100%, rgba(34, 197, 94, 0.16), transparent 55%),
                  #020617;
      color: #e5e7eb;
      box-shadow: 0 20px 45px rgba(15, 23, 42, 0.95);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    #tab-people[data-theme="light"] .scorecard-card {
      background: #ffffff;
      color: #020617;
    }

    #tab-people .scorecard-header {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.4);
      padding-bottom: 8px;
      margin-bottom: 8px;
    }

    #tab-people .scorecard-label {
      font-size: 0.7rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    #tab-people .scorecard-card h1 {
      font-size: 1.3rem;
      margin-bottom: 2px;
    }

    #tab-people .sc-seat {
      font-size: 0.85rem;
      color: #9ca3af;
    }

    #tab-people .sc-function {
      font-size: 0.8rem;
      color: #a5b4fc;
    }

    #tab-people[data-theme="light"] .sc-function {
      color: #4f46e5;
    }

    #tab-people .scorecard-tag {
      display: flex;
      flex-direction: column;
      gap: 3px;
      align-items: flex-end;
      font-size: 0.74rem;
    }

    #tab-people .scorecard-tag span {
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.8);
    }

    #tab-people[data-theme="light"] .scorecard-tag span {
      background: #f9fafb;
    }

    #tab-people .scorecard-section {
      margin-bottom: 10px;
    }

    #tab-people .scorecard-section h2 {
      font-size: 0.8rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    #tab-people .scorecard-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.75rem;
    }

    #tab-people .scorecard-table th,
    #tab-people .scorecard-table td {
      border-bottom: 1px solid rgba(148, 163, 184, 0.4);
      padding: 4px 3px;
    }

    #tab-people .scorecard-table th {
      text-align: left;
      font-size: 0.7rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    #tab-people .scorecard-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(148, 163, 184, 0.4);
    }

    #tab-people .scorecard-pill {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.85);
    }

    #tab-people[data-theme="light"] .scorecard-pill {
      background: #f3f4f6;
    }

    #tab-people .scorecard-meta {
      font-size: 0.66rem;
      color: #9ca3af;
      text-align: right;
    }

    /* PDF score cell */

         /* PDF score cell */
    #tab-people .sc-score-cell {
      text-align: right;
      font-weight: 600;
      font-size: 0.8rem;
    }

    #tab-people .sc-score-inline {
      font-weight: 700;
    }

    #tab-people .sc-score-plus {
      color: #4ade80;  /* green */
    }

    #tab-people .sc-score-mid {
      color: #facc15;  /* amber */
    }

    #tab-people .sc-score-minus {
      color: #f97373;  /* red */
    }

    /* Home button */
    #tab-people .lead-link-gradient {
      display: inline-block;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      padding: 10px 22px;
      border-radius: 999px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.2s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    #tab-people .lead-link-gradient:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

/* ========================================
   ENHANCED IDS & L10 STYLES
   ======================================== */

/* AI Assistant Panel */
.ai-panel-prominent {
    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
    border: 2px solid rgba(99, 102, 241, 0.3);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 24px;
}

.ai-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.ai-icon {
    font-size: 28px;
}

.ai-title {
    font-size: 20px;
    font-weight: 600;
    color: var(--text-primary);
}

.ai-badge {
    background: rgba(99, 102, 241, 0.2);
    color: #a5b4fc;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
}

.ai-intro {
    color: var(--text-secondary);
    margin-bottom: 16px;
    line-height: 1.6;
}

.ai-input-group {
    display: flex;
    gap: 12px;
    align-items: flex-start;
}

.ai-input-group textarea {
    flex: 1;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 12px;
    color: var(--text-primary);
    font-family: inherit;
    resize: vertical;
}

.btn-ai {
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.btn-ai:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);
}

.ai-response {
    margin-top: 16px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 16px;
}

.ai-response-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border-color);
}

.ai-response-content {
    color: var(--text-secondary);
    line-height: 1.8;
}

.btn-close {
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 20px;
    cursor: pointer;
    padding: 0 8px;
}

.btn-close:hover {
    color: var(--text-primary);
}

/* IDS Stages Grid */
.ids-stages-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.ids-stage-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    overflow: hidden;
}

.ids-stage-header {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    border-bottom: 1px solid var(--border-color);
}

.ids-stage-icon {
    font-size: 32px;
}

.ids-stage-header h3 {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
}

.ids-stage-content {
    padding: 20px;
}

.ids-stage-content p {
    margin-bottom: 12px;
    color: var(--text-secondary);
}

.ids-stage-content ul {
    margin-left: 20px;
    margin-bottom: 16px;
}

.ids-stage-content li {
    margin-bottom: 8px;
    color: var(--text-secondary);
}

.red-flag-list li {
    color: var(--accent-red);
}

.good-sign-list li {
    color: var(--accent-green);
}

.solution-types li {
    color: var(--accent-blue);
}

.ai-suggestion-box {
    background: rgba(99, 102, 241, 0.1);
    border-left: 3px solid #6366f1;
    padding: 12px;
    border-radius: 4px;
    margin-top: 16px;
}

/* Quick Add Section */
.quick-add-section {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 20px;
}

.quick-add-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.quick-add-header h3 {
    margin: 0;
    color: var(--text-primary);
}

.quick-add-form {
    margin-top: 16px;
}

.form-row {
    display: flex;
    gap: 16px;
    margin-bottom: 16px;
}

.form-group {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.form-group label {
    color: var(--text-secondary);
    font-size: 14px;
    margin-bottom: 6px;
    font-weight: 500;
}

.form-group input,
.form-group select,
.form-group textarea {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 10px;
    color: var(--text-primary);
    font-family: inherit;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--accent-blue);
}

/* Filters */
.ids-filters {
    display: flex;
    gap: 20px;
    align-items: center;
    margin-bottom: 20px;
    padding: 16px;
    background: var(--bg-secondary);
    border-radius: 8px;
}

.filter-group {
    display: flex;
    align-items: center;
    gap: 8px;
}

.filter-group label {
    color: var(--text-secondary);
    font-size: 14px;
    white-space: nowrap;
}

.filter-pills {
    display: flex;
    gap: 8px;
}

.filter-pill {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    color: var(--text-secondary);
    padding: 6px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s;
}

.filter-pill:hover {
    border-color: var(--accent-blue);
    color: var(--accent-blue);
}

.filter-pill.active {
    background: var(--accent-blue);
    border-color: var(--accent-blue);
    color: white;
}

#idsSearch {
    flex: 1;
    min-width: 200px;
}

/* Status and Category Badges */
.status-badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
    white-space: nowrap;
}

.status-identified {
    background: rgba(251, 191, 36, 0.2);
    color: #fbbf24;
}

.status-discussed {
    background: rgba(59, 130, 246, 0.2);
    color: #3b82f6;
}

.status-solved {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
}

.priority-badge {
    display: inline-block;
    font-size: 16px;
}

.category-badge {
    display: inline-block;
    background: var(--chip-bg);
    border: 1px solid var(--chip-border);
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 13px;
    color: var(--text-secondary);
}

/* Enhanced IDS Table */
.table-container {
    overflow-x: auto;
    margin-bottom: 20px;
}

.ids-table-enhanced {
    width: 100%;
    border-collapse: collapse;
    background: var(--bg-secondary);
    border-radius: 8px;
    overflow: hidden;
}

.ids-table-enhanced thead {
    background: var(--bg-primary);
    border-bottom: 2px solid var(--border-color);
}

.ids-table-enhanced th {
    padding: 12px;
    text-align: left;
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.ids-table-enhanced td {
    padding: 12px;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-secondary);
}

.ids-table-enhanced tbody tr:hover {
    background: rgba(255, 255, 255, 0.02);
}

.issue-cell {
    max-width: 300px;
}

.issue-title {
    color: var(--text-primary);
    font-weight: 600;
    display: block;
    margin-bottom: 4px;
}

.issue-context {
    color: var(--text-muted);
    font-size: 13px;
    margin: 0;
}

.btn-icon {
    background: none;
    border: none;
    font-size: 18px;
    cursor: pointer;
    padding: 4px;
    opacity: 0.6;
    transition: opacity 0.2s;
}

.btn-icon:hover {
    opacity: 1;
}

/* Bulk Actions */
.bulk-actions {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 12px;
    display: flex;
    gap: 12px;
    align-items: center;
    margin-bottom: 20px;
}

.bulk-actions span {
    color: var(--text-primary);
    font-weight: 600;
}

/* Metrics Grid */
.metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
}

.metric-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 20px;
    text-align: center;
}

.metric-value {
    font-size: 32px;
    font-weight: 700;
    color: var(--accent-green);
    margin-bottom: 8px;
}

.metric-label {
    color: var(--text-secondary);
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Best Practices Card */
.best-practices-card {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, rgba(16, 185, 129, 0.05) 100%);
}

.practice-columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    margin-top: 20px;
}

.practice-header {
    font-size: 18px;
    margin-bottom: 16px;
    color: var(--text-primary);
}

.practice-list {
    list-style: none;
    padding: 0;
}

.practice-list li {
    padding: 10px 0;
    padding-left: 24px;
    position: relative;
    color: var(--text-secondary);
    line-height: 1.6;
}

.practice-list li:before {
    position: absolute;
    left: 0;
    font-weight: bold;
}

/* L10 Agenda Visual - Timeline/Gantt Style */
.l10-agenda-visual {
    margin: 32px 0;
}

/* Timeline Scale */
.timeline-scale {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    padding: 0 4px;
}

.scale-marker {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-muted);
    font-variant-numeric: tabular-nums;
}

/* Timeline Container */
.agenda-timeline {
    background: rgba(15, 23, 42, 0.5);
    border: 2px solid var(--border-color);
    border-radius: 12px;
    padding: 8px;
    margin-bottom: 32px;
}

.timeline-track {
    display: flex;
    gap: 4px;
    height: 80px;
    position: relative;
}

.agenda-segment {
    background: var(--bg-secondary);
    border: 2px solid rgba(100, 116, 139, 0.4);
    border-radius: 6px;
    padding: 12px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.agenda-segment:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    z-index: 2;
    border-color: rgba(148, 163, 184, 0.6);
}

/* Proportional widths based on time */
.agenda-segment.seg-1 { flex: 5; }
.agenda-segment.seg-2 { flex: 5; }
.agenda-segment.seg-3 { flex: 5; }
.agenda-segment.seg-4 { flex: 5; }
.agenda-segment.seg-5 { 
    flex: 60; 
    background: linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(217, 119, 6, 0.2) 100%);
    border-color: rgba(251, 191, 36, 0.6);
}
.agenda-segment.seg-6 { flex: 10; }

.agenda-segment.seg-5:hover {
    background: linear-gradient(135deg, rgba(251, 191, 36, 0.25) 0%, rgba(217, 119, 6, 0.25) 100%);
}

.segment-time {
    font-size: 0.8125rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 6px;
    white-space: nowrap;
    font-variant-numeric: tabular-nums;
}

.agenda-segment.seg-5 .segment-time {
    font-size: 0.9375rem;
    color: #fbbf24;
}

.agenda-segment h4 {
    font-size: 0.9375rem;
    font-weight: 600;
    color: var(--text-secondary);
    white-space: nowrap;
    margin: 0;
}

.agenda-segment.seg-5 h4 {
    font-size: 1.125rem;
    color: var(--text-primary);
}

/* Hide other elements in the compact timeline view */
.timeline-track .agenda-segment p,
.timeline-track .segment-purpose,
.timeline-track .segment-note,
.timeline-track .segment-header,
.timeline-track .segment-icon {
    display: none;
}

/* Legend */
.timeline-legend {
    display: flex;
    align-items: center;
    gap: 32px;
    margin-top: 16px;
    padding: 16px;
    background: rgba(15, 23, 42, 0.3);
    border-radius: 8px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.875rem;
    color: var(--text-secondary);
}

.legend-box {
    width: 24px;
    height: 24px;
    border-radius: 4px;
    border: 2px solid rgba(100, 116, 139, 0.4);
    background: var(--bg-secondary);
}

.legend-box.highlight {
    background: linear-gradient(135deg, rgba(251, 191, 36, 0.2) 0%, rgba(217, 119, 6, 0.2) 100%);
    border-color: rgba(251, 191, 36, 0.6);
}

@media (max-width: 768px) {
    .timeline-track {
        flex-direction: column;
        height: auto;
    }

    .agenda-segment {
        height: 60px;
    }
}/* Setup Sections */
.setup-sections {
    margin-top: 20px;
}

.setup-section {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    margin-bottom: 20px;
    overflow: hidden;
}

.setup-section-header {
    background: var(--bg-primary);
    padding: 16px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border-color);
    cursor: pointer;
}

.setup-section-header h3 {
    margin: 0;
    color: var(--text-primary);
    font-size: 18px;
}

.completion-badge {
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
    background: rgba(251, 191, 36, 0.2);
    color: #fbbf24;
}

.setup-content {
    padding: 20px;
}

.section-intro {
    color: var(--text-secondary);
    margin-bottom: 20px;
    line-height: 1.6;
}

/* Checklist */
.checklist {
    list-style: none;
    padding: 0;
}

.checklist-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: background 0.2s;
}

.checklist-item:hover {
    background: rgba(255, 255, 255, 0.02);
}

.checklist-item input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.checklist-item span {
    color: var(--text-secondary);
    flex: 1;
}

/* Rocks */
.rock-creator {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 24px;
}

.rocks-list {
    margin-top: 24px;
}

.rock-item {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 12px;
}

.rock-header {
    display: flex;
    gap: 8px;
    align-items: center;
    margin-bottom: 12px;
}

.rock-status {
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
    flex: 1;
}

.status-on-track {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
}

.status-off-track {
    background: rgba(239, 68, 68, 0.2);
    color: #f87171;
}

.rock-statement {
    font-size: 16px;
    color: var(--text-primary);
    font-weight: 600;
    margin-bottom: 12px;
}

.rock-meta {
    display: flex;
    gap: 16px;
    font-size: 13px;
    color: var(--text-muted);
    margin-bottom: 12px;
}

.rock-progress {
    display: flex;
    align-items: center;
    gap: 12px;
}

.progress-bar {
    flex: 1;
    height: 8px;
    background: var(--bg-primary);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
    border-radius: 4px;
    transition: width 0.3s;
}

.progress-text {
    font-size: 13px;
    color: var(--text-secondary);
    font-weight: 600;
    min-width: 80px;
    text-align: right;
}

/* Responsive */
@media (max-width: 768px) {
    .ids-stages-grid,
    .practice-columns {
        grid-template-columns: 1fr;
    }
    
    .agenda-timeline {
        flex-direction: column;
        gap: 16px;
    }
    
    .agenda-segment {
        width: 100% !important;
        min-height: auto;
    }
    
    .form-row {
        flex-direction: column;
    }
}

.field textarea {
    width: 100%;
}

/* Tablet view - stack segments in 2 columns */
@media (min-width: 769px) and (max-width: 1200px) {
    .agenda-timeline {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
    }
    
    .agenda-segment {
        width: auto !important;
    }
}
    </style>

    <!-- People Analyzer styles -->
    <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #050b16;
      --bg-alt: #020617;
      --card-bg: rgba(15, 23, 42, 0.96);
      --text: #f9fafb;
      --muted: #94a3b8;
      --border-subtle: rgba(148, 163, 184, 0.4);
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.16);
      --danger: #f97373;
      --danger-soft: rgba(248, 113, 113, 0.18);
      --teal-soft: rgba(45, 212, 191, 0.16);
      --badge: rgba(56, 189, 248, 0.18);
      --shadow-soft: 0 16px 40px rgba(15, 23, 42, 0.9);
      --shadow-soft-light: 0 16px 35px rgba(15, 23, 42, 0.9);
    }

    body[data-theme="light"] {
      --bg: #f3f4f6;
      --bg-alt: #e5e7eb;
      --card-bg: #ffffff;
      --text: #020617;
      --muted: #64748b;
      --border-subtle: rgba(148, 163, 184, 0.6);
      --accent: #16a34a;
      --accent-soft: rgba(34, 197, 94, 0.12);
      --danger-soft: rgba(248, 113, 113, 0.12);
      --teal-soft: rgba(45, 212, 191, 0.12);
      --badge: rgba(59, 130, 246, 0.12);
      --shadow-soft: 0 10px 26px rgba(148, 163, 184, 0.25);
      --shadow-soft-light: 0 16px 35px rgba(15, 23, 42, 0.25);
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #020617 0, #020617 40%, #020617 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1300px;
      margin: 0 auto;
    }

    header.header {
      background:
        radial-gradient(circle at 0 0, rgba(74, 222, 128, 0.18), transparent 50%),
        radial-gradient(circle at 100% 0, rgba(56, 189, 248, 0.16), transparent 52%),
        radial-gradient(circle at 0 100%, rgba(45, 212, 191, 0.14), transparent 55%),
        rgba(15, 23, 42, 0.96);
      border-radius: 20px;
      border: 1px solid rgba(148, 163, 184, 0.65);
      padding: 14px 16px;
      box-shadow: var(--shadow-soft-light);
      display: flex;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }

    .header-main {
      max-width: 650px;
    }

    .title-row {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .title-row h1 {
      font-size: 1.6rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .badge {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(129, 140, 248, 0.8);
      background: rgba(15, 23, 42, 0.96);
      font-size: 0.75rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: rgba(226, 232, 240, 0.98);
    }

    .subtitle {
      margin-top: 4px;
      font-size: 0.9rem;
      color: rgba(226, 232, 240, 0.9);
    }

    .header-meta {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: flex-end;
    }

    @media (max-width: 800px) {
      .header {
        flex-direction: column;
      }
      .header-meta {
        align-items: flex-start;
      }
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: flex-end;
    }

    .pill {
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      font-size: 0.75rem;
      color: rgba(226, 232, 240, 0.9);
      background: rgba(15, 23, 42, 0.94);
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .pill strong {
      font-weight: 600;
      color: #e5e7eb;
    }

    .pill span:last-child {
      font-size: 0.74rem;
      color: rgba(148, 163, 184, 0.98);
    }

    .theme-toggle {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      padding: 3px 8px;
      font-size: 0.76rem;
      color: rgba(226, 232, 240, 0.98);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(15, 23, 42, 0.98);
      cursor: pointer;
      user-select: none;
    }

    .toggle-track {
      width: 34px;
      height: 18px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.9);
      display: flex;
      align-items: center;
      padding: 1px;
    }

    .toggle-knob {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      background: rgba(226, 232, 240, 0.98);
      transform: translateX(0);
      transition: transform 0.18s ease;
    }

    body[data-theme="light"] .toggle-knob {
      transform: translateX(14px);
    }

    .layout {
      margin-top: 18px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .top-row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: stretch;
    }

    .card {
      background: var(--card-bg);
      border-radius: 18px;
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
      padding: 14px 16px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: flex-start;
      margin-bottom: 6px;
    }

    .card-title {
      font-size: 0.92rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgba(226, 232, 240, 0.98);
    }

    .card-subtitle {
      font-size: 0.82rem;
      color: var(--muted);
    }

    .insights-card { flex: 1.2; min-width: 260px; }
    .controls-card { flex: 1; min-width: 260px; }

    .insight-banner {
      padding: 10px 12px;
      border-radius: 13px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.96);
      font-size: 0.84rem;
      color: rgba(226, 232, 240, 0.94);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .insight-main { font-weight: 600; }

    .insight-metrics {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .insight-chip {
      font-size: 0.74rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(148, 163, 184, 0.7);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    body[data-theme="light"] .insight-chip {
      background: #f9fafb;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    button {
      font-family: inherit;
      border: none;
      cursor: pointer;
      border-radius: 999px;
      font-size: 0.8rem;
      padding: 6px 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(15, 23, 42, 0.98);
      color: rgba(226, 232, 240, 0.98);
      border: 1px solid rgba(148, 163, 184, 0.7);
      transition: transform 0.08s ease, background 0.1s ease, border-color 0.1s ease;
    }

    button:hover {
      transform: translateY(-1px);
      background: rgba(37, 99, 235, 0.95);
      border-color: rgba(129, 140, 248, 0.95);
    }

    .btn {
      font-size: 0.8rem;
      padding: 6px 11px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.98);
      color: rgba(226, 232, 240, 0.98);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    body[data-theme="light"] .btn {
      background: #ffffff;
      border-color: rgba(148, 163, 184, 0.7);
      color: #0f172a;
    }

    .btn-primary {
      background: linear-gradient(135deg, #22c55e, #4ade80);
      border-color: rgba(34, 197, 94, 0.9);
      color: #022c22;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #4ade80, #a3e635);
    }

    .btn-danger {
      background: rgba(127, 29, 29, 0.92);
      border-color: rgba(248, 113, 113, 0.9);
      color: #fee2e2;
    }

    .btn-danger:hover {
      background: rgba(185, 28, 28, 0.95);
    }

    .btn-secondary {
      border-color: rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.98);
      color: var(--muted);
    }

    body[data-theme="light"] .btn-secondary {
      background: #eef2ff;
      border-color: rgba(129, 140, 248, 0.8);
      color: #1e293b;
    }

    main.layout > .card {
      margin-bottom: 8px;
    }

    .values-card {
      margin-top: 4px;
      width: 100%;
      max-width: none;
    }

    .function-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 10px;
      margin-bottom: 8px;
    }

    .fn-tab {
      border-radius: 999px;
      padding: 4px 9px;
      font-size: 0.76rem;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: rgba(226, 232, 240, 0.96);
      cursor: pointer;
    }

    .fn-tab.active {
      border-color: rgba(34, 197, 94, 0.9);
      background: rgba(22, 163, 74, 0.22);
      color: #bbf7d0;
    }

    .values-details {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    .value-row {
      display: grid;
      grid-template-columns: 140px 1fr;
      gap: 20px;
      align-items: flex-start;
    }

    @media (max-width: 720px) {
      .value-row {
        grid-template-columns: 1fr;
      }
    }

    .value-label {
      font-size: 0.8rem;
      color: rgba(148, 163, 184, 0.98);
      font-weight: 500;
    }

    .value-text {
      width: 100%;
      min-height: 60px;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.96);
      color: rgba(226, 232, 240, 0.98);
      font-size: 0.85rem;
      padding: 10px 12px;
      resize: vertical;
      line-height: 1.5;
    }

    .value-text::placeholder {
      color: rgba(148, 163, 184, 0.9);
    }

    body[data-theme="light"] .value-text {
      background: #ffffff;
    }

    .values-legend {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.74rem;
      color: var(--muted);
    }

    .legend-chip {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.98);
    }

    body[data-theme="light"] .legend-chip {
      background: #f9fafb;
    }

    .people-card {
      margin-top: 2px;
      width: 100%;
      max-width: none;
    }

    .table-wrapper {
      margin-top: 8px;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      overflow: hidden;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.78rem;
    }

    th,
    td {
      border-bottom: 1px solid rgba(148, 163, 184, 0.45);
      padding: 6px 7px;
      text-align: left;
    }

    thead th {
      background: rgba(15, 23, 42, 0.98);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: rgba(148, 163, 184, 0.98);
      white-space: nowrap;
    }

    tbody tr:nth-child(even) {
      background: rgba(15, 23, 42, 0.98);
    }

    tbody tr:nth-child(odd) {
      background: rgba(15, 23, 42, 0.92);
    }

    body[data-theme="light"] thead th {
      background: #e5e7eb;
      color: #4b5563;
    }

    body[data-theme="light"] tbody tr:nth-child(even),
    body[data-theme="light"] tbody tr:nth-child(odd) {
      background: #ffffff;
    }

    .name-input,
    .seat-input {
      width: 100%;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.75);
      background: rgba(15, 23, 42, 0.98);
      color: rgba(226, 232, 240, 0.98);
      font-size: 0.85rem;
      padding: 8px 12px;
    }

    body[data-theme="light"] .name-input,
    body[data-theme="light"] .seat-input {
      background: #ffffff;
      color: #0f172a;
    }

    .name-input::placeholder,
    .seat-input::placeholder {
      color: rgba(148, 163, 184, 0.9);
    }

    .fn-select {
      width: 100%;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.75);
      background: rgba(15, 23, 42, 0.98);
      color: rgba(226, 232, 240, 0.98);
      font-size: 0.8rem;
      padding: 4px 23px 4px 7px;
    }

    body[data-theme="light"] .fn-select {
      background: #ffffff;
      color: #0f172a;
    }

    .core-header {
      cursor: pointer;
    }

    .score-buttons {
      width: 32px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.98);
      color: rgba(148, 163, 184, 0.9);
      font-size: 0.76rem;
      padding: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .score-buttons:hover {
      border-color: rgba(129, 140, 248, 0.95);
      background: rgba(30, 64, 175, 0.95);
      color: #e5e7eb;
    }

    .score-plus {
      background: rgba(22, 163, 74, 0.26);
      border-color: rgba(34, 197, 94, 0.9);
      color: #bbf7d0;
    }

    .score-mid {
      background: rgba(30, 64, 175, 0.45);
      border-color: rgba(129, 140, 248, 0.9);
      color: #e5e7eb;
    }

    .score-minus {
      background: rgba(127, 29, 29, 0.9);
      border-color: rgba(248, 113, 113, 0.95);
      color: #fee2e2;
    }

    .gwc-toggle {
      display: inline-flex;
      gap: 3px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.75);
      padding: 1px 2px;
    }

    .gwc-btn {
      border-radius: 999px;
      border: none;
      font-size: 0.72rem;
      padding: 0 6px;
      background: transparent;
      color: rgba(148, 163, 184, 0.9);
      min-width: 28px;
      text-align: center;
    }

    .gwc-btn:hover {
      background: rgba(30, 64, 175, 0.9);
      color: #e5e7eb;
    }

    .gwc-yes {
      background: rgba(22, 163, 74, 0.3);
      color: #bbf7d0;
    }

    .gwc-no {
      background: rgba(127, 29, 29, 0.9);
      color: #fee2e2;
    }

    .right-person-cell,
    .right-seat-cell,
    .action-cell {
      font-size: 0.76rem;
    }

    .right-person-cell {
      font-weight: 600;
    }

    .scorecard-btn {
      font-size: 0.7rem;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.75);
      background: rgba(15, 23, 42, 0.98);
      color: rgba(226, 232, 240, 0.98);
    }

    .scorecard-btn:hover {
      background: rgba(30, 64, 175, 0.95);
      border-color: rgba(129, 140, 248, 0.95);
    }

    .remove-btn {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(148, 163, 184, 0.75);
      color: rgba(148, 163, 184, 0.9);
      font-size: 0.8rem;
      padding: 0;
    }

    .remove-btn:hover {
      background: rgba(127, 29, 29, 0.92);
      border-color: rgba(248, 113, 113, 0.9);
      color: #fee2e2;
    }

    /* Scorecard PDF template */
    .scorecard-card {
      width: 410px;
      padding: 16px 18px;
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.85);
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.2), rgba(15, 23, 42, 0.98));
      color: rgba(226, 232, 240, 0.98);
      box-shadow: 0 20px 45px rgba(15, 23, 42, 1);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
    }

    .scorecard-header {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .scorecard-label {
      font-size: 0.7rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgba(148, 163, 184, 0.95);
      margin-bottom: 3px;
    }

    .scorecard-card h1 {
      font-size: 1.15rem;
      margin: 0;
      letter-spacing: 0.04em;
    }

    .sc-seat,
    .sc-function {
      font-size: 0.76rem;
      color: rgba(148, 163, 184, 0.98);
      margin: 1px 0;
    }

    .scorecard-tag {
      align-self: flex-start;
      border-radius: 999px;
      border: 1px solid rgba(34, 197, 94, 0.9);
      background: rgba(22, 163, 74, 0.16);
      color: #bbf7d0;
      padding: 4px 8px;
      font-size: 0.72rem;
      display: inline-flex;
      flex-direction: column;
      gap: 2px;
    }

    .scorecard-section {
      margin-top: 8px;
    }

    .scorecard-section h2 {
      font-size: 0.82rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: rgba(209, 213, 219, 0.98);
      margin-bottom: 4px;
    }

    .scorecard-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.76rem;
    }

    .scorecard-table td {
      border-bottom: 1px solid rgba(55, 65, 81, 0.7);
      padding: 3px 0;
    }

    .scorecard-table tr:last-child td {
      border-bottom: none;
    }

    .sc-score-inline {
      font-weight: 500;
    }

    .sc-score-plus {
      color: #bbf7d0;
    }

    .sc-score-mid {
      color: #e5e7eb;
    }

    .sc-score-minus {
      color: #fecaca;
    }

    .scorecard-footer {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }

    .scorecard-pill {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.98);
      font-size: 0.74rem;
      max-width: 260px;
    }

    .scorecard-meta {
      font-size: 0.7rem;
      color: rgba(148, 163, 184, 0.98);
    }

    </style>
</head>
<body>
    <div class="page-shell">
        <!-- Fixed top-right meta -->
        <div class="top-right-meta">
            <div class="meta-pill">
                <span>ðŸ§©</span><span>Component 3 Â· Ownership & Accountability</span>
            </div>
            <div class="meta-pill">
                <span>ðŸ“Š</span><span id="metaProgressLabel">0% of EOS People Operating System defined</span>
            </div>
        </div>

        <!-- Header -->
        <header class="header">
            <div class="header-main">
                <div class="header-eyebrow">
                    <span>Component 3</span>
                    <span>Ownership, Accountability & High-Performance Teams</span>
                </div>
                <h1 class="header-title">Ownership, Accountability & High-Performance Teams</h1>
                <p class="header-subtitle">
                    Turn your EOS Accountability Chart, L10 cadence and Issues list into a real operating system for ownership.
                    Weâ€™ll define seats, roles, GWC & Right Person / Right Seat, while tying everything into your EOS L10 and IDS.
                </p>
                <div class="quick-points">
                    <div class="quick-point">
                        <span>ðŸ§©</span><span>Functions â†’ Seats â†’ People</span>
                    </div>
                    <div class="quick-point">
                        <span>ðŸ‘¤</span><span>Right People, Right Seats (GWC + Values)</span>
                    </div>
                    <div class="quick-point">
                        <span>ðŸ§ </span><span>Issues, IDS & L10 discipline</span>
                    </div>
                </div>
            </div>

            <div class="header-metrics">
                <div class="progress-card">
                    <div class="progress-label-row">
                        <strong>Component 3 Progress</strong>
                        <span class="progress-subtext">
                            Linked to Accountability Chart, GWC & L10 readiness
                        </span>
                    </div>
                    <div class="progress-bar-shell">
                        <div class="progress-bar-fill" id="overallProgressBar"></div>
                    </div>
                    <div class="progress-footer-row">
                        <span id="overallProgressText">0% Complete</span>
                        <span class="phase-badge" id="phaseBadge">Phase: Not Started</span>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-pill">
                        <span class="stat-label">Accountability Chart Defined</span>
                        <span class="stat-value" id="orgStatusLabel">Not Started</span>
                        <span class="stat-meta">Functions & seats designed</span>
                    </div>
                    <div class="stat-pill">
                        <span class="stat-label">GWC & RPRS Decisions</span>
                        <span class="stat-value" id="peopleStatusLabel">Not Started</span>
                        <span class="stat-meta">By function & level</span>
                    </div>
                    <div class="stat-pill">
                        <span class="stat-label">Issues & IDS Discipline</span>
                        <span class="stat-value" id="issuesStatusLabel">Not Started</span>
                        <span class="stat-meta">Issues list + IDS log</span>
                    </div>
                    <div class="stat-pill">
                        <span class="stat-label">L10 Meetings Embedded</span>
                        <span class="stat-value" id="l10StatusLabel">Not Started</span>
                        <span class="stat-meta">Weekly rhythm & scorecard</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Tab Navigation -->
        <div class="tab-nav" id="tabNav">
        <button class="tab-button active" data-tab="pre">
            <span class="tab-icon">ðŸ“‹</span> Pre-Assessment
        </button>
        <button class="tab-button" data-tab="org">
            <span class="tab-icon">ðŸ›ï¸</span> Org Structure
        </button>
        <button class="tab-button" data-tab="people">
            <span class="tab-icon">ðŸ§‘â€ðŸ¤â€ðŸ§‘</span> People Analyzer
        </button>
        <button class="tab-button" data-tab="rprs">
            <span class="tab-icon">ðŸ§¬</span> Right Person / Right Seat
        </button>
        <button class="tab-button" data-tab="issues">
            <span class="tab-icon">ðŸ“œ</span> Issues 
            <span class="tab-label-sub">(Component 4 crossover)</span>
        </button>
        <button class="tab-button" data-tab="ids">
            <span class="tab-icon">ðŸ§ </span> IDS Log
        </button>
        <button class="tab-button" data-tab="l10">
            <span class="tab-icon">ðŸ“†</span> L10 Meetings
        </button>
        <button class="tab-button" data-tab="culture">
            <span class="tab-icon">ðŸ”¥</span> Culture & Accountability
        </button>
   <button class="tab-button" data-tab="summary">
        <span class="tab-icon">ðŸ§¾</span> CEO Summary
    </button>
        <button class="tab-button" data-tab="export">
            <span class="tab-icon">ðŸ’¾</span> Export & Next Steps
        </button>
    </div>

<!-- TAB 1: PRE-ASSESSMENT -->
<div class="tab-content active" id="tab-pre">
    <div class="card">
        <h2 class="card-title">Ownership & Accountability Pre-Assessment</h2>
        <p class="card-subtitle">
            Capture your current state so we can measure improvement as the Accountability Chart, GWC, and L10
            disciplines are in place â€“ and so we can give you a CEO-ready summary of risks, readiness and focus.
        </p>

        <div class="ai-panel">
            <div class="ai-header">
                <span class="ai-icon">ðŸ¤–</span>
                <span class="ai-title">AI Coach â€“ Ownership Baseline</span>
            </div>
            <p style="font-size: 0.86rem; margin-bottom: 6px;">
                Use this as a pre / post lens. If youâ€™re scoring 3â€“4 on most items, weâ€™ll focus more on
                scaling discipline vs. fixing foundations.
            </p>
            <div class="pill-list">
                <span class="pill-list-item">Where ownership breaks down today</span>
                <span class="pill-list-item">How clear seats & expectations really are</span>
                <span class="pill-list-item">How often issues sit unresolved or resurface</span>
            </div>
        </div>

        <!-- Qualitative baseline -->
        <div class="layout-grid" style="margin-top: 18px;">
            <div>
                <div class="tiny-label">Current Ownership & Accountability Reality (Leadership View)</div>
                <textarea id="preCurrentReality" rows="5" placeholder="Where does ownership break down today? Where does it work well?"></textarea>

                <div class="tiny-label" style="margin-top: 10px;">Symptoms Youâ€™re Seeing</div>
                <textarea id="preSymptoms" rows="4" placeholder="E.g. decisions looping, meetings rehashing same issues, â€˜shadowâ€™ owners vs. seat owners, etc."></textarea>
            </div>
            <div>
                <div class="tiny-label">Top 3 Ownership Outcomes You Want from Component 3</div>
                <textarea id="preDesiredOutcomes" rows="5" placeholder="E.g. clear seat ownership, confident people decisions, effective L10 that actually closes issuesâ€¦"></textarea>

                <div class="tiny-label" style="margin-top: 10px;">Time Horizon & Constraints</div>
                <textarea id="preConstraints" rows="4" placeholder="Any constraints, hiring freezes, or non-negotiables that impact how we design the Accountability Chart and people decisions."></textarea>
            </div>
        </div>

        <!-- Quantitative 1â€“5 scoring + Readiness Stage -->
        <div class="pre-scoring-grid">
            <div class="pre-score-card">
                <div class="tiny-label">Pre-Assessment Scoring (1â€“5)</div>
                <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 8px;">
                    Score from 1 (low / fragile) to 5 (strong / consistent). This drives your Org System Health and Readiness Stage.
                </p>

                <div class="pre-score-row">
                    <span>Ownership & Seat Clarity</span>
                    <select id="preScoreOwnership" class="pre-score-select">
                        <option value="">â€“</option>
                        <option value="1">1 â€“ Ad-hoc / unclear</option>
                        <option value="2">2 â€“ Patchy / personality-based</option>
                        <option value="3">3 â€“ Mostly clear, some gaps</option>
                        <option value="4">4 â€“ Clear, consistent for most seats</option>
                        <option value="5">5 â€“ Clear, embedded & owned</option>
                    </select>
                </div>

                <div class="pre-score-row">
                    <span>Leadership Alignment & Follow-Through</span>
                    <select id="preScoreLeadership" class="pre-score-select">
                        <option value="">â€“</option>
                        <option value="1">1 â€“ Frequently misaligned / re-deciding</option>
                        <option value="2">2 â€“ Some alignment, lots of noise</option>
                        <option value="3">3 â€“ Generally aligned, patchy execution</option>
                        <option value="4">4 â€“ Strong alignment, good follow-through</option>
                        <option value="5">5 â€“ High trust, high follow-through</option>
                    </select>
                </div>

                <div class="pre-score-row">
                    <span>Culture: Psychological Safety & Challenge</span>
                    <select id="preScoreCulture" class="pre-score-select">
                        <option value="">â€“</option>
                        <option value="1">1 â€“ People hold back / donâ€™t speak up</option>
                        <option value="2">2 â€“ Some candour, lots of politics</option>
                        <option value="3">3 â€“ Mixed; some teams are candid</option>
                        <option value="4">4 â€“ Generally candid & constructive</option>
                        <option value="5">5 â€“ High candour, high standards</option>
                    </select>
                </div>

                <div class="pre-score-row">
                    <span>Revenue Execution & Operating Rhythm</span>
                    <select id="preScoreRevenue" class="pre-score-select">
                        <option value="">â€“</option>
                        <option value="1">1 â€“ Unpredictable, weak cadence</option>
                        <option value="2">2 â€“ Some cadence, lots of surprises</option>
                        <option value="3">3 â€“ Reasonable rhythm, gaps in accountability</option>
                        <option value="4">4 â€“ Strong weekly / monthly rhythm</option>
                        <option value="5">5 â€“ Highly disciplined, data-led rhythm</option>
                    </select>
                </div>
            </div>

            <div class="readiness-stage-card">
                <div class="tiny-label">Readiness Stage (Auto-Derived)</div>
                <div class="readiness-stage-label" id="readinessStageLabel">Not Scored</div>
                <p class="readiness-stage-desc" id="readinessStageDescription">
                    Add 1â€“5 scores to see whether youâ€™re in Stage 1 (founder-centric) through Stage 4 (high-performing ownership system).
                </p>

                <div class="readiness-stage-tag">
                    <span>ðŸ“Š</span>
                    <span>Org System Health (Pre): <strong id="orgHealthLabelInline">â€“</strong></span>
                </div>

                <div class="org-health-pill-inline">
                    This is a simple average of the four pre-scores â€“ also shown in the header as <strong>Org System Health (Pre)</strong>.
                </div>
            </div>
        </div>

        <!-- Revenue & execution + Talent / risk snapshot -->
        <div style="margin-top: 22px;">
            <div class="tiny-label">Revenue Execution & Operating Rhythm (Pre-Check)</div>
            <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 8px;">
                These prompts feed the CEO Summary and 90-day plan â€“ especially around revenue accountability and cross-functional friction.
            </p>

            <div class="layout-grid">
                <div>
                    <div class="tiny-label">Forecasting, Pipeline & Ownership</div>
                    <textarea id="preRevenueOwnership" rows="4" placeholder="Who really owns forecast accuracy and pipeline quality? How confident are you in whatâ€™s being reported?"></textarea>

                    <div class="tiny-label" style="margin-top: 10px;">Handoffs Across the Customer Journey</div>
                    <textarea id="preRevenueHandoffs" rows="4" placeholder="Where do deals or customers â€˜fall between seatsâ€™ â€“ Marketing â†’ Sales, Sales â†’ CS, CS â†’ Product, etc.?"></textarea>
                </div>
                <div>
                    <div class="tiny-label">Operating Rhythm & Meeting Cadence</div>
                    <textarea id="preOperatingRhythm" rows="4" placeholder="What is your current rhythm for leadership, forecast, pipeline and customer health? How consistent is it?"></textarea>

                    <div class="tiny-label" style="margin-top: 10px;">Data, Metrics & Reporting Confidence</div>
                    <textarea id="preRevenueData" rows="4" placeholder="Which metrics do you actually trust today? Where are there gaps, disputes or â€˜multiple versions of truthâ€™?"></textarea>
                </div>
            </div>
        </div>

        <div style="margin-top: 22px;">
            <div class="tiny-label">People / Org Risk & Talent Capacity Snapshot</div>
            <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 8px;">
                Use this to flag roles, people and capacity risks before we lock in the Accountability Chart and RPRS decisions.
            </p>

            <div class="summary-columns-2">
                <div>
                    <div class="tiny-label">Roles / Seats at Risk in the Next 12 Months</div>
                    <textarea id="preRolesAtRisk" class="summary-textarea" placeholder="E.g. single-threaded IC roles, leaders who are over-leveraged, seats with no clear successor."></textarea>
                </div>
                <div>
                    <div class="tiny-label">People / Behaviour Risks</div>
                    <textarea id="prePeopleRisks" class="summary-textarea" placeholder="E.g. chronic underperformance, values misalignment, leaders who avoid decisions or create drag."></textarea>
                </div>
            </div>

            <div class="summary-columns-2" style="margin-top: 12px;">
                <div>
                    <div class="tiny-label">Critical Dependencies & Single Points of Failure</div>
                    <textarea id="preDependencies" class="summary-textarea" placeholder="Where would the business materially suffer if one person left, or if one function broke?"></textarea>
                </div>
                <div>
                    <div class="tiny-label">Talent & Headcount Capacity vs. Next-Year Plan</div>
                    <textarea id="preTalentCapacity" class="summary-textarea" placeholder="Do you have the leadership & IC horsepower to hit next yearâ€™s targets? Where will capacity break first?"></textarea>
                </div>
            </div>
        </div>

        <div class="section-footer">
            <button class="btn btn-primary" onclick="markSectionComplete('pre')">
                <span>âœ“</span>Mark Pre-Assessment Complete
            </button>
            <button class="btn btn-secondary" onclick="switchTab('org')">
                Go to Accountability Chart Builder â†’
            </button>
            <span class="section-footer-note">
                This doesnâ€™t need to be perfect; itâ€™s simply our baseline lens on ownership, accountability, revenue execution and capacity.
            </span>
        </div>
    </div>
</div>



    <!-- TAB: ORG STRUCTURE (Accountability Chart) -->
    <div class="tab-content" id="tab-org">

    <header class="header">
        <div class="header-inner">
            <div class="title-group">
                <div class="eyebrow">
                    <span class="eyebrow-pill">Accountability Chart</span>
                    <span>Right People â€¢ Right Seats â€¢ Clear Lines</span>
                </div>
                <div class="title-row">
                    <h1>Accountability Chart</h1>
                    <span class="company-label" id="companyLabel"></span>
                </div>
                <div class="subtitle">
                    Map every function, seat, and accountability in one place. Use this as the â€œsource of truthâ€ for org design discussions and leadership meetings.
                </div>
                <div class="controls-row">
                    <div class="company-input">
                        <input type="text" id="companyName" placeholder="Add company nameâ€¦ (e.g. BearOps, Series A GTM)">
                    </div>
                    <div class="chips-row">
                        <div class="chip">
                            <span class="icon">ðŸ§ </span><strong>Vision</strong><span>Who owns what as you scale</span>
                        </div>
                        <div class="chip">
                            <span class="icon">ðŸ“Š</span><strong>Seat Scorecards</strong><span>Metrics, decisions, and interfaces</span>
                        </div>
                        <div class="chip">
                            <span class="icon">ðŸ§©</span><strong>People Analyzer</strong><span>Sync seats into values &amp; GWC grid</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <div class="mode-row">
                    <label class="toggle-pill">
                        <div class="toggle-thumb">
                            <div class="toggle-circle"></div>
                        </div>
                        <span id="themeLabel">ðŸŒ™ Dark</span>
                    </label>
                    <label class="toggle-pill">
                        <input type="checkbox" id="togglePeople">
                        <span>Show people focus</span>
                    </label>
                </div>
                <div class="toolbar">
                    <button class="button outline" id="btnCollapseAll" type="button">
                        <span class="icon">â¬†ï¸</span><span>Collapse all</span>
                    </button>
                    <button class="button outline" id="btnExpandAll" type="button">
                        <span class="icon">â¬‡ï¸</span><span>Expand all</span>
                    </button>
                    <button class="button danger" id="btnReset" type="button">
                        <span class="icon">ðŸ§¹</span><span>Reset chart</span>
                    </button>
                </div>
                <div class="small-text">
                    Tip: Start with ~5â€“7 core functions (Leadership, Product, Sales, CS) before adding sub-functions.
                </div>
            </div>
        </div>
    </header>

    <main class="main">
        <section class="panel">
            <div class="panel-header">
                <div>
                    <div class="panel-title">Function &amp; Seat Builder</div>
                    <div class="panel-subtitle">Define major functions, then add seats with clear accountability.</div>
                </div>
                <div class="pill">
                    <span class="icon"></span><span>Inputs into People Analyzer</span>
                </div>
            </div>

            <div class="form-grid">
                <div class="field">
                    <div class="field-label">New function <span class="hint">e.g. Leadership, Sales, Product, CS</span></div>
                    <div class="row-inline">
                        <input type="text" id="functionName" placeholder="Function nameâ€¦">
                        <button class="button primary" id="btnAddFunction" type="button">
                            <span class="icon">âž•</span><span>Add function</span>
                        </button>
                    </div>
                    <div class="small-text">
                        Keep this high-level at first. You can add regional or squad-based functions later (e.g. â€œEMEA Salesâ€, â€œOnboarding CSâ€).
                    </div>
                </div>

                <div class="divider"></div>

                <div class="section-title-row">
                    <div class="section-title">Add seat to function</div>
                    <div class="section-subtitle">Use role + owner + clear scope so the seat is unambiguous.</div>
                </div>

                <div class="field">
                    <div class="field-label">Seat function</div>
                    <select id="seatFunctionSelect">
                        <option value="">Choose functionâ€¦</option>
                    </select>
                </div>

                <div class="row-inline">
                    <div class="field">
                        <div class="field-label">Seat / Role title</div>
                        <input type="text" id="seatRole" placeholder="e.g. Head of Sales, CS Lead, RevOps Manager">
                    </div>
                    <div class="field">
                        <div class="field-label">Seat owner (optional)</div>
                        <input type="text" id="seatOwner" placeholder="e.g. Alice Murphy">
                    </div>
                </div>

                <div class="field">
                    <div class="field-label">Purpose of this seat <span class="hint">1â€“2 sentences</span></div>
                    <textarea id="seatPurpose" placeholder="Why does this seat exist? What result are they accountable for?"></textarea>
                </div>

                <div class="field">
                    <div class="field-label">Scope &amp; responsibilities <span class="hint">bullet style lines</span></div>
                    <textarea id="seatResponsibilities" placeholder="Owns pipeline creation for MM segment
Leads weekly forecast calls and commits
Partners with Marketing on campaign focus"></textarea>
                </div>

                <div class="field">
                    <div class="field-label">Communication norms <span class="hint">how this seat interacts</span></div>
                    <textarea id="seatComms" placeholder="Weekly 1:1 with VP Sales
Bi-weekly sync with Marketing
Joins QBRs for top 10 customers"></textarea>
                </div>

                <div class="field">
                    <div class="field-label">Metrics of success <span class="hint">3â€“5 max</span></div>
                    <textarea id="seatMetrics" placeholder="Net new ARR closed
Pipeline coverage (3x)
Win rate &amp; sales cycle length"></textarea>
                </div>

                <div class="field">
                    <div class="field-label">Key decisions &amp; interfaces <span class="hint">where they have real autonomy</span></div>
                    <textarea id="seatDecisions" placeholder="Can approve discounts to 15%
Owns territory carve-up with RevOps
Prioritises which deals enter exec review"></textarea>
                </div>

                <div class="field">
                    <div class="field-label">Interfaces &amp; handoffs</div>
                    <textarea id="seatInterfaces" placeholder="Hands off closed-won customers to CS
Must align with Product on roadmap impacting top 10 deals"></textarea>
                </div>

                <div class="checkbox-row">
                    <input type="checkbox" id="seatCollapsed" checked>
                    <label for="seatCollapsed">Start this seat collapsed (only show title &amp; owner by default)</label>
                </div>

                <div class="row-inline">
                    <button class="button primary" id="btnAddSeat" type="button">
                        <span class="icon">âž•</span><span>Add seat to function</span>
                    </button>
                    <button class="button outline" id="btnClearSeatForm" type="button">
                        <span class="icon">ðŸ§½</span><span>Clear seat form</span>
                    </button>
                </div>

                <div class="small-text">
                    Once your chart looks right, jump into the People Analyzer to test â€œRight Person / Right Seatâ€ using the same seats.
                </div>
            </div>
        </section>

        <section class="panel">
            <div class="panel-header">
                <div>
                    <div class="panel-title">Accountability Map</div>
                    <div class="panel-subtitle">Each card is a function. Inside are the seats and what they own.</div>
                </div>
              
            </div>

            <div class="summary-row">
                <div class="summary-chip">
                    <span class="icon">ðŸ—ï¸</span>
                    <span><strong id="summaryFunctions">0</strong> functions</span>
                </div>
                <div class="summary-chip">
                    <span class="icon">ðŸª‘</span>
                    <span><strong id="summarySeats">0</strong> seats</span>
                </div>
                <div class="summary-chip">
                    <span class="icon">â“</span>
                    <span><strong id="summaryEmpty">0</strong> open seats (no owner)</span>
                </div>
            </div>

            <div class="focus-bar" id="focusBar">
                <div class="focus-label">
                    <span class="label">Focused function</span>
                    <span class="value" id="focusFunctionName"></span>
                </div>
                <button class="mini-button" id="btnClearFocus" type="button">Clear focus</button>
            </div>

            <div class="pill-list" id="chartSummary"></div>

            <div class="functions-grid" id="functionsGrid"></div>

            <div id="emptyState" class="empty-state" style="margin-top:12px;">
                Start by adding your first function on the left. Example: Leadership, Sales, Marketing.
            </div>
        </section>
    </main>
    <!-- NEXT STEPS CHECKLIST -->
    <section class="next-steps">
        <div class="next-steps-title">Suggested next steps</div>
        <ul class="next-steps-list">
            <li class="checklist-item">
                <input type="checkbox">
                <span><strong>Walk the chart with leadership.</strong> Validate that every critical function has an owner and there are no overlapping seats.</span>
            </li>
            <li class="checklist-item">
                <input type="checkbox">
                <span><strong>Highlight open seats.</strong> Tag seats without owners and label them clearly â€“ these become your hiring priorities.</span>
            </li>
            <li class="checklist-item">
                <input type="checkbox">
                <span><strong>Run â€œRight People / Right Seatsâ€.</strong> Use the People Analyzer to test values fit and GWC (Gets it, Wants it, Capacity) and review the fit summary bar.</span>
            </li>
            <li class="checklist-item">
                <input type="checkbox">
                <span><strong>Turn open or mis-fit seats into job scorecards.</strong> Reuse purpose, responsibilities, and metrics to create external job ads and internal scorecards.</span>
            </li>
            <li class="checklist-item">
                <input type="checkbox">
                <span><strong>Revisit quarterly.</strong> Use this chart as an input into your V/TO and quarterly planning, adjusting seats as the org evolves.</span>
            </li>
        </ul>
    </section>
</div>


    </div>

    <!-- TAB: PEOPLE ANALYZER (Full Tool) -->
    <div class="tab-content" id="tab-people">
    <header class="header">
      <div class="header-main">
        <div class="title-row">
          <h1>People Analyzer</h1>
          <span class="badge">Right People â€¢ Right Seats</span>
        </div>
        <p class="subtitle">
          SaaS-flavoured values (+ / Â± / â€“) with GWC (Gets It, Wants It, Capacity). Sync seats from your Accountability Chart and score each person by function.
        </p>
      </div>
      <div class="header-meta">
        <div class="pill-row">
          <div class="pill"><strong>Values</strong><span>+ Always â€¢ Â± Sometimes â€¢ â€“ Rarely</span></div>
          <div class="pill"><strong>GWC</strong><span>Yes / No per seat</span></div>
        </div>
        <div class="theme-toggle" id="themeToggle">
          <span>Theme</span>
          <div class="toggle-track"><div class="toggle-knob"></div></div>
          <span id="themeLabel">Dark</span>
        </div>
      </div>
    </header>

    <main class="layout">
      <div class="top-row">
        <section class="card insights-card">
          <div class="card-header">
            <h2 class="card-title">Team Snapshot</h2>
          </div>
          <div class="insight-banner" id="insightBanner">
            <div class="insight-main">No data yet. Add people or sync seats to see People / Seats health.</div>
            <div class="insight-metrics" id="insightMetrics" style="display:none;">
              <div class="insight-chip"><strong id="rightPeopleCount">0</strong><span>Right People</span></div>
              <div class="insight-chip"><strong id="rightSeatCount">0</strong><span>Right Seats</span></div>
              <div class="insight-chip"><strong id="fullMatchCount">0</strong><span>Right Person + Right Seat</span></div>
              <div class="insight-chip"><strong id="coachOrExitCount">0</strong><span>Coach / Exit Seats</span></div>
            </div>
          </div>
        </section>

        <section class="card controls-card">
          <div class="card-header">
            <h2 class="card-title">Controls</h2>
          </div>
          <div class="button-row">
            <button class="btn btn-primary" id="addRowBtn">ï¼‹ Add Person</button>
            <button class="btn" id="recalcBtn">Recalculate</button>
            <button class="btn" id="exportBtn">â¬‡ Export CSV</button>
            <button class="btn" id="syncFromChartBtn">â†» Sync from Accountability Chart</button>
            <button class="btn" id="saveBtn">ðŸ’¾ Save</button>
            <button class="btn btn-danger" id="resetBtn">âŸ² Reset</button>
          </div>
        </section>
      </div>

      <!-- Core Value Explorer -->
      <section class="card values-card">
        <div class="card-header">
          <div>
            <h2 class="card-title">Core Value Explorer</h2>
            <p class="values-help">
              Start with Business Values, then refine for each function (Sales, Marketing, CS, Productâ€¦). Click a value header in the grid to jump here.
            </p>
          </div>
        </div>
        <div class="function-tabs" id="functionTabs"></div>
        <div class="values-details" id="valuesDetails"></div>
        <div class="values-legend">
          <span class="legend-chip">+ Always â€“ consistently lives this value</span>
          <span class="legend-chip">Â± Sometimes â€“ mixed / situational</span>
          <span class="legend-chip">â€“ Rarely â€“ misaligned with how we operate</span>
        </div>
      </section>

      <!-- People Analyzer Grid -->
      <section class="card people-card">
        <div class="card-header">
          <h2 class="card-title">People Analyzer Grid</h2>
          <div class="card-subtitle">Filter by function via tabs above. Sync seats from your Accountability Chart and tag per function.</div>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Person</th>
                <th>Seat / Role</th>
                <th>Function</th>
                <th class="core-header" data-value-key="customer_first">Customer-first mindset</th>
                <th class="core-header" data-value-key="ownership_chaos">Ownership over chaos</th>
                <th class="core-header" data-value-key="bias_action">Bias for action</th>
                <th class="core-header" data-value-key="collab_low_ego">Collaboration & low ego</th>
                <th class="core-header" data-value-key="data_informed">Data-informed thinking</th>
                <th class="core-header" data-value-key="learning_velocity">Learning velocity</th>
                <th>G</th>
                <th>W</th>
                <th>C</th>
                <th>Right Person?</th>
                <th>Right Seat?</th>
                <th>Suggested Action</th>
                <th>PDF</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="peopleBody"></tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <!-- Hidden scorecard template for PDF export -->
  <div id="scorecardTemplate" class="scorecard-card" style="display:none;">
    <div class="scorecard-header">
      <div>
        <div class="scorecard-label">PEOPLE ANALYZER SCORECARD</div>
        <h1 id="scName">Name Here</h1>
        <p id="scSeat" class="sc-seat">Seat / Role</p>
        <p id="scFunction" class="sc-function">Function</p>
      </div>
      <div class="scorecard-tag">
        <span id="scRightPerson">Right Person?</span>
        <span id="scRightSeat">Right Seat?</span>
      </div>
    </div>

    <div class="scorecard-section">
<h2>Core Values</h2>
<table class="scorecard-table">
  <thead>
    <tr>
      <th>Value & Result</th>
    </tr>
  </thead>
  <tbody id="scValuesBody"></tbody>
</table>

    </div>

    <div class="scorecard-section">
      <h2>GWC (Gets It, Wants It, Capacity)</h2>
      <table class="scorecard-table">
        <tbody>
          <tr>
            <td>Gets It</td>
            <td id="scG">â€“</td>
          </tr>
          <tr>
            <td>Wants It</td>
            <td id="scW">â€“</td>
          </tr>
          <tr>
            <td>Capacity</td>
            <td id="scC">â€“</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="scorecard-footer">
      <div class="scorecard-pill" id="scSuggestedAction">Suggested Action: â€“</div>
      <div class="scorecard-meta" id="scMeta">
        Generated from People Analyzer
      </div>
    </div>
  </div>

  <!-- PDF libraries -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    </div>


    <!-- TAB 5: RIGHT PERSON / RIGHT SEAT -->
    <div class="tab-content" id="tab-rprs">
        <div class="card">
            <h2 class="card-title">Right Person / Right Seat Summary</h2>
            <p class="card-subtitle">
                Consolidate Accountability Chart + GWC + Roles per Seat into clear RPRS decisions.
            </p>

            <div class="rprs-grid">
                <div>
                    <div class="tiny-label">Seat-Level Summary</div>
                    <ul class="rprs-list" id="rprsList">
                        <!-- Populated by GWC + Org logic -->
                    </ul>
                </div>
                <div>
                    <div class="tiny-label">RPRS Insights</div>
                    <div class="strength-pod" id="rprsStrengths">
                        <strong>Initial Strengths (example)</strong>
                        <p>Leadership team mostly in right seats. Clear ownership of core revenue and delivery functions.</p>
                    </div>
                    <div class="risk-pod" id="rprsRisks">
                        <strong>Risks / Gaps (example)</strong>
                        <p>Marketing & RevOps under-resourced. Visionary still in operational weeds. CS capacity stretched.</p>
                    </div>
                </div>
            </div>

            <div class="section-footer">
                <button class="btn btn-primary" onclick="markSectionComplete('rprs')">
                    Mark RPRS Summary as Drafted
                </button>
                <button class="btn btn-secondary" onclick="switchTab('issues')">
                    Move RPRS Outcomes into Issues & IDS â†’
                </button>
                <span class="section-footer-note">
                    This is where you create your â€œpeople decisionsâ€ list for the next 1â€“3 quarters.
                </span>
            </div>
        </div>
    </div>

    <!-- TAB 6: ISSUES LIST (COMPONENT 4 CROSSOVER) -->
    <div class="tab-content" id="tab-issues">
        <div class="card">
            <h2 class="card-title">Issues List â€“ People & Accountability</h2>
            <p class="card-subtitle">
                Capture people, structure and accountability issues flowing out of Component 3. These will feed your EOS Issues list and IDS cadence.
            </p>

            <div class="issues-layout">
                <div>
                    <div class="tiny-label">Add a New Issue</div>
                    <table class="table">
                        <tr>
                            <td class="compact">
                                <input id="issueTitle" placeholder="Issue title (e.g. CS capacity / Sales leadership gap)" />
                            </td>
                        </tr>
                        <tr>
                            <td class="compact">
                                <textarea id="issueDetail" rows="3" placeholder="Describe what youâ€™re seeing, why it matters, and what â€˜solvedâ€™ would look like."></textarea>
                            </td>
                        </tr>
                        <tr>
                            <td class="compact">
                                <div class="input-row">
                                    <div class="input-group">
                                        <label>Owner</label>
                                        <input id="issueOwner" placeholder="Who owns solving this?" />
                                    </div>
                                    <div class="input-group">
                                        <label>Severity</label>
                                        <select id="issueSeverity">
                                            <option value="low">Low</option>
                                            <option value="medium">Medium</option>
                                            <option value="high">High</option>
                                            <option value="critical">Critical</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <label>Timeframe</label>
                                        <select id="issueTimeframe">
                                            <option value="this_quarter">This Quarter</option>
                                            <option value="next_quarter">Next Quarter</option>
                                            <option value="backlog">Backlog</option>
                                        </select>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>

                    <div class="btn-row">
                        <button class="btn btn-secondary" onclick="addIssue()"><span>âž•</span>Add Issue</button>
                        <button class="btn btn-secondary" onclick="copyIssuesToClipboard()">
                            <span>ðŸ“‹</span>Copy Issues List
                        </button>
                    </div>
                </div>
                <div>
                    <div class="tiny-label">Current Issues (People & Accountability)</div>
                    <ul class="issues-list" id="issuesList"></ul>
                </div>
            </div>

            <div class="section-footer">
                <button class="btn btn-primary" onclick="markSectionComplete('issues')">
                    Mark People Issues List as Drafted
                </button>
                <button class="btn btn-secondary" onclick="switchTab('ids')">
                    Go to IDS Log â†’
                </button>
                <span class="section-footer-note">
                    These issues should show up in your EOS Issues list and be worked through via IDS in L10.
                </span>
            </div>
        </div>
    </div>

    <!-- TAB 7: IDS LOG -->
<!-- ========================================
     ENHANCED IDS TAB - COMPREHENSIVE VERSION
     ======================================== -->
<div class="tab-content" id="tab-ids">
    <!-- AI Assistant Panel -->
    <div class="ai-panel ai-panel-prominent">
        <div class="ai-header">
            <span class="ai-icon">ðŸ¤–</span>
            <span class="ai-title">IDS AI Assistant</span>
            <span class="ai-badge">Powered by Claude</span>
        </div>
        <p class="ai-intro">
            Ask me anything about IDS: how to identify root causes, facilitate difficult discussions, 
            determine if an issue is truly solved, or get suggestions for specific situations.
        </p>
        <div class="ai-input-group">
            <textarea 
                id="idsAiPrompt" 
                placeholder="Example: 'How do I handle a situation where a team member doesn't want to admit ownership of an issue?'"
                rows="3"
            ></textarea>
            <button class="btn btn-primary" id="idsAiSubmit">
                <span>âœ¨</span> Get AI Guidance
            </button>
        </div>
        <div id="idsAiResponse" class="ai-response" style="display: none;">
            <div class="ai-response-header">
                <strong>AI Guidance:</strong>
                <button class="btn-close" onclick="document.getElementById('idsAiResponse').style.display='none'">âœ•</button>
            </div>
            <div id="idsAiResponseContent" class="ai-response-content"></div>
        </div>
    </div>

    <!-- IDS Framework Overview -->
    <div class="card">
        <h2 class="card-title">ðŸ§  IDS Framework: Identify, Discuss, Solve</h2>
        <p class="card-subtitle">
            The EOS discipline for addressing and resolving issues permanently. Every issue goes through three stages, 
            and the goal is to get to the root cause and implement a real solution.
        </p>

        <!-- IDS Stages Explained -->
        <div class="ids-stages-grid">
            <div class="ids-stage-card">
                <div class="ids-stage-header">
                    <span class="ids-stage-icon">ðŸ”</span>
                    <h3>1. IDENTIFY</h3>
                </div>
                <div class="ids-stage-content">
                    <p><strong>Goal:</strong> Surface the real issue, not just symptoms</p>
                    <p><strong>Questions to ask:</strong></p>
                    <ul>
                        <li>What's actually happening vs. what should happen?</li>
                        <li>Is this a pattern or a one-time event?</li>
                        <li>Who is impacted? How?</li>
                        <li>What's the business impact?</li>
                    </ul>
                    <p><strong>Red flags:</strong></p>
                    <ul class="red-flag-list">
                        <li>Issue stated as "we need to..." (that's a solution, not an issue)</li>
                        <li>Vague language like "communication problems"</li>
                        <li>Blaming external factors only</li>
                    </ul>
                    <div class="ai-suggestion-box">
                        <strong>ðŸ’¡ AI Tip:</strong> Ask the AI assistant to help you reframe vague issues into specific, actionable problem statements.
                    </div>
                </div>
            </div>

            <div class="ids-stage-card">
                <div class="ids-stage-header">
                    <span class="ids-stage-icon">ðŸ’¬</span>
                    <h3>2. DISCUSS</h3>
                </div>
                <div class="ids-stage-content">
                    <p><strong>Goal:</strong> Get to root cause through open dialogue</p>
                    <p><strong>Facilitation techniques:</strong></p>
                    <ul>
                        <li><strong>5 Whys:</strong> Keep asking "why" to dig deeper</li>
                        <li><strong>Round-robin:</strong> Everyone speaks, no interruptions</li>
                        <li><strong>Facts first:</strong> Separate facts from opinions/feelings</li>
                        <li><strong>Timeboxing:</strong> 5-10 minutes max per issue in L10</li>
                    </ul>
                    <p><strong>Signs of good discussion:</strong></p>
                    <ul class="good-sign-list">
                        <li>People asking questions, not defending positions</li>
                        <li>Root cause identified (often organizational, not individual)</li>
                        <li>Multiple perspectives shared</li>
                        <li>Emotions acknowledged but not dominating</li>
                    </ul>
                    <div class="ai-suggestion-box">
                        <strong>ðŸ’¡ AI Tip:</strong> Share the issue context with the AI to get facilitation techniques for sensitive discussions.
                    </div>
                </div>
            </div>

            <div class="ids-stage-card">
                <div class="ids-stage-header">
                    <span class="ids-stage-icon">âœ…</span>
                    <h3>3. SOLVE</h3>
                </div>
                <div class="ids-stage-content">
                    <p><strong>Goal:</strong> Implement a solution that prevents recurrence</p>
                    <p><strong>Solution quality check:</strong></p>
                    <ul>
                        <li>Is there a clear owner accountable for implementation?</li>
                        <li>Is the solution addressing root cause (not symptoms)?</li>
                        <li>Can we measure if it worked?</li>
                        <li>Is there a specific deadline?</li>
                    </ul>
                    <p><strong>Common solution types:</strong></p>
                    <ul class="solution-types">
                        <li><strong>Process:</strong> Change workflow, add checklist, automate</li>
                        <li><strong>People:</strong> Training, coaching, role change, hiring</li>
                        <li><strong>Structure:</strong> Org chart change, seat redefinition</li>
                        <li><strong>Systems:</strong> New tool, better reporting, integration</li>
                    </ul>
                    <div class="ai-suggestion-box">
                        <strong>ðŸ’¡ AI Tip:</strong> Describe your root cause and ask the AI for solution approaches used successfully in similar situations.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Active IDS Log -->
    <div class="card">
        <h2 class="card-title">ðŸ“‹ Active IDS Log</h2>
        <p class="card-subtitle">
            Track all issues through the IDS process. Color-coded by status: 
            <span class="status-badge status-identified">Identified</span>
            <span class="status-badge status-discussed">Discussed</span>
            <span class="status-badge status-solved">Solved</span>
        </p>

        <!-- Quick Add Issue -->
        <div class="quick-add-section">
            <div class="quick-add-header">
                <h3>Quick Add Issue</h3>
                <button class="btn btn-secondary" onclick="toggleQuickAdd()">
                    <span id="quickAddToggle">+ Show</span>
                </button>
            </div>
            <div id="quickAddForm" class="quick-add-form" style="display: none;">
                <div class="form-row">
                    <div class="form-group" style="flex: 2;">
                        <label>Issue Statement</label>
                        <input type="text" id="quickIssueTitle" placeholder="Be specific: What's actually happening?" />
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="quickIssueCategory">
                            <option value="people">ðŸ‘¥ People</option>
                            <option value="process">âš™ï¸ Process</option>
                            <option value="accountability">ðŸŽ¯ Accountability</option>
                            <option value="structure">ðŸ—ï¸ Structure</option>
                            <option value="communication">ðŸ’¬ Communication</option>
                            <option value="performance">ðŸ“Š Performance</option>
                            <option value="culture">ðŸ”¥ Culture</option>
                            <option value="other">ðŸ“Œ Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="quickIssuePriority">
                            <option value="high">ðŸ”´ High</option>
                            <option value="medium" selected>ðŸŸ¡ Medium</option>
                            <option value="low">ðŸŸ¢ Low</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group" style="flex: 2;">
                        <label>Initial Context / Impact</label>
                        <textarea id="quickIssueContext" rows="2" placeholder="Why does this matter? Who's affected?"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Owner</label>
                        <input type="text" id="quickIssueOwner" placeholder="Who will drive this?" />
                    </div>
                </div>
                <div class="btn-row">
                    <button class="btn btn-primary" onclick="addQuickIssue()">
                        <span>âž•</span> Add to IDS Log
                    </button>
                    <button class="btn btn-ai" onclick="aiSuggestIssueRefinement()">
                        <span>âœ¨</span> AI: Refine Issue Statement
                    </button>
                </div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="ids-filters">
            <div class="filter-group">
                <label>Filter by Status:</label>
                <div class="filter-pills">
                    <button class="filter-pill active" data-filter="all" onclick="filterIds('all')">All</button>
                    <button class="filter-pill" data-filter="identified" onclick="filterIds('identified')">Identified</button>
                    <button class="filter-pill" data-filter="discussed" onclick="filterIds('discussed')">Discussed</button>
                    <button class="filter-pill" data-filter="solved" onclick="filterIds('solved')">Solved</button>
                </div>
            </div>
            <div class="filter-group">
                <label>Category:</label>
                <select id="categoryFilter" onchange="filterIdsByCategory()">
                    <option value="all">All Categories</option>
                    <option value="people">People</option>
                    <option value="process">Process</option>
                    <option value="accountability">Accountability</option>
                    <option value="structure">Structure</option>
                    <option value="communication">Communication</option>
                    <option value="performance">Performance</option>
                    <option value="culture">Culture</option>
                </select>
            </div>
            <div class="filter-group">
                <input type="search" id="idsSearch" placeholder="ðŸ” Search issues..." oninput="searchIds()" />
            </div>
        </div>

        <!-- IDS Table -->
        <div class="table-container">
            <table class="ids-table-enhanced" id="idsTable">
                <thead>
                    <tr>
                        <th width="5%">
                            <input type="checkbox" id="selectAllIds" onclick="toggleAllIds()" />
                        </th>
                        <th width="5%">Priority</th>
                        <th width="10%">Category</th>
                        <th width="25%">Issue</th>
                        <th width="10%">Owner</th>
                        <th width="10%">Status</th>
                        <th width="8%">Identified</th>
                        <th width="8%">Discussed</th>
                        <th width="8%">Solved</th>
                        <th width="6%">Actions</th>
                    </tr>
                </thead>
                <tbody id="idsTableBody">
                    <!-- Sample row to show structure -->
                    <tr class="ids-row" data-status="identified" data-category="people">
                        <td><input type="checkbox" class="row-select" /></td>
                        <td><span class="priority-badge priority-high">ðŸ”´</span></td>
                        <td><span class="category-badge">ðŸ‘¥ People</span></td>
                        <td>
                            <div class="issue-cell">
                                <strong class="issue-title">Sales Manager role clarity</strong>
                                <p class="issue-context">Overlap between inside and field sales leadership creating confusion</p>
                            </div>
                        </td>
                        <td>CRO</td>
                        <td><span class="status-badge status-identified">Identified</span></td>
                        <td>Dec 01</td>
                        <td>â€”</td>
                        <td>â€”</td>
                        <td>
                            <button class="btn-icon" onclick="expandIssueDetails(this)" title="View Details">ðŸ‘ï¸</button>
                            <button class="btn-icon" onclick="editIssue(this)" title="Edit">âœï¸</button>
                            <button class="btn-icon" onclick="deleteIssue(this)" title="Delete">ðŸ—‘ï¸</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Bulk Actions -->
        <div class="bulk-actions" id="bulkActions" style="display: none;">
            <span id="selectedCount">0 selected</span>
            <button class="btn btn-secondary" onclick="bulkUpdateStatus('discussed')">Mark as Discussed</button>
            <button class="btn btn-secondary" onclick="bulkUpdateStatus('solved')">Mark as Solved</button>
            <button class="btn btn-secondary" onclick="bulkExport()">Export Selected</button>
            <button class="btn btn-danger" onclick="bulkDelete()">Delete Selected</button>
        </div>

        <!-- Action Buttons -->
        <div class="btn-row">
            <button class="btn btn-secondary" onclick="addIdsRow()">
                <span>âž•</span> Add Issue Manually
            </button>
            <button class="btn btn-ai" onclick="aiAnalyzeIssues()">
                <span>âœ¨</span> AI: Analyze All Issues
            </button>
            <button class="btn btn-secondary" onclick="exportIdsLog()">
                <span>ðŸ“¥</span> Export to CSV
            </button>
            <button class="btn btn-secondary" onclick="importIdsLog()">
                <span>ðŸ“¤</span> Import from CSV
            </button>
            <button class="btn btn-secondary" onclick="generateIdsReport()">
                <span>ðŸ“Š</span> Generate Report
            </button>
        </div>
    </div>

    <!-- IDS Metrics Dashboard -->
    <div class="card">
        <h2 class="card-title">ðŸ“Š IDS Metrics & Health</h2>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value" id="totalIssues">0</div>
                <div class="metric-label">Total Issues</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="identifiedCount">0</div>
                <div class="metric-label">Identified</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="discussedCount">0</div>
                <div class="metric-label">Discussed</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="solvedCount">0</div>
                <div class="metric-label">Solved</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="avgTimeToSolve">â€”</div>
                <div class="metric-label">Avg Days to Solve</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="solveRate">â€”</div>
                <div class="metric-label">30-Day Solve Rate</div>
            </div>
        </div>

        <!-- Category Breakdown Chart -->
        <div class="chart-section">
            <h3>Issues by Category</h3>
            <canvas id="idsCategoryChart" width="400" height="200"></canvas>
        </div>
    </div>

    <!-- IDS Best Practices -->
    <div class="card best-practices-card">
        <h2 class="card-title">ðŸ’¡ IDS Best Practices & Common Pitfalls</h2>
        
        <div class="practice-columns">
            <div class="practice-column">
                <h3 class="practice-header">âœ… DO</h3>
                <ul class="practice-list">
                    <li>Surface issues early and often (create psychological safety)</li>
                    <li>Focus on root causes, not symptoms</li>
                    <li>Timebox discussions (5-10 min in L10, longer if needed separately)</li>
                    <li>Assign clear ownership for solutions</li>
                    <li>Follow up to verify solutions worked</li>
                    <li>Keep issues visible on the issues list until truly solved</li>
                    <li>Use "5 Whys" to dig deeper</li>
                    <li>Separate person from problem (attack issue, not individual)</li>
                </ul>
            </div>
            <div class="practice-column">
                <h3 class="practice-header">âŒ DON'T</h3>
                <ul class="practice-list">
                    <li>Let issues sit on the list for months without progress</li>
                    <li>Accept "we need to..." as the issue statement</li>
                    <li>Skip straight to solutions without understanding root cause</li>
                    <li>Allow blame or defensiveness to shut down discussion</li>
                    <li>Mark as "solved" if there's no concrete action/outcome</li>
                    <li>Let one person dominate the discussion</li>
                    <li>Revisit the same issue repeatedly (solve it properly once)</li>
                    <li>Avoid difficult conversations about people/performance</li>
                </ul>
            </div>
        </div>

        <div class="ai-suggestion-box">
            <strong>ðŸ¤– AI Help Available:</strong> Struggling with a specific issue? Ask the AI assistant at the top of this page for guidance on facilitation, root cause analysis, or solution approaches.
        </div>
    </div>
</div>


<!-- ========================================
     ENHANCED L10 TAB - COMPREHENSIVE VERSION
     ======================================== -->
<div class="tab-content" id="tab-l10">
    <!-- AI Assistant Panel -->
    <div class="ai-panel ai-panel-prominent">
        <div class="ai-header">
            <span class="ai-icon">ðŸ¤–</span>
            <span class="ai-title">L10 AI Assistant</span>
            <span class="ai-badge">Powered by Claude</span>
        </div>
        <p class="ai-intro">
            Ask me to help design your L10 agenda, suggest KPIs for your scorecard, draft rock statements, 
            or get advice on improving meeting effectiveness.
        </p>
        <div class="ai-input-group">
            <textarea 
                id="l10AiPrompt" 
                placeholder="Example: 'Help me design a scorecard for a B2B SaaS company with 50 employees'"
                rows="3"
            ></textarea>
            <button class="btn btn-primary" id="l10AiSubmit">
                <span>âœ¨</span> Get AI Guidance
            </button>
        </div>
        <div id="l10AiResponse" class="ai-response" style="display: none;">
            <div class="ai-response-header">
                <strong>AI Guidance:</strong>
                <button class="btn-close" onclick="document.getElementById('l10AiResponse').style.display='none'">âœ•</button>
            </div>
            <div id="l10AiResponseContent" class="ai-response-content"></div>
        </div>
    </div>

    <!-- L10 Framework Overview -->
    <div class="card">
        <h2 class="card-title">ðŸ“† The L10 Meeting Framework</h2>
        <p class="card-subtitle">
            Level 10 meetings are the pulse of your organization. Run the same agenda every week, for 90 minutes, 
            same day and time. The goal: solve the most important issues, keep everyone aligned, and maintain accountability.
        </p>

        <!-- L10 Agenda Breakdown -->
<div class="l10-agenda-visual">
    <!-- Timeline Scale -->
    <div class="timeline-scale">
        <span class="scale-marker">0 min</span>
        <span class="scale-marker">15 min</span>
        <span class="scale-marker">30 min</span>
        <span class="scale-marker">45 min</span>
        <span class="scale-marker">60 min</span>
        <span class="scale-marker">75 min</span>
        <span class="scale-marker">90 min</span>
    </div>

    <!-- Timeline Track -->
    <div class="agenda-timeline">
        <div class="timeline-track">
            <div class="agenda-segment seg-1">
                <div class="segment-time">0-5 min</div>
                <h4>Segue</h4>
            </div>

            <div class="agenda-segment seg-2">
                <div class="segment-time">5-10 min</div>
                <h4>Scorecard</h4>
            </div>

            <div class="agenda-segment seg-3">
                <div class="segment-time">10-15 min</div>
                <h4>Rock Review</h4>
            </div>

            <div class="agenda-segment seg-4">
                <div class="segment-time">15-20 min</div>
                <h4>Headlines</h4>
            </div>

            <div class="agenda-segment seg-5">
                <div class="segment-time">20-80 min</div>
                <h4>IDS (Issues)</h4>
            </div>

            <div class="agenda-segment seg-6">
                <div class="segment-time">80-90 min</div>
                <h4>Conclude</h4>
            </div>
        </div>
    </div>

    <!-- Legend -->
    <div class="timeline-legend">
        <div class="legend-item">
            <div class="legend-box"></div>
            <span>Standard segment</span>
        </div>
        <div class="legend-item">
            <div class="legend-box highlight"></div>
            <span>Primary focus (60+ minutes)</span>
        </div>
    </div>
</div>

<!-- Detailed Breakdown (Optional) -->
<div style="margin-top: 48px; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px;">
    
    <!-- Segue Details -->
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 24px;">
        <div style="font-size: 0.875rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px;">0-5 min â€¢ Segue</div>
        <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 8px 0;">Share good newsâ€”personal or professional</p>
        <div style="padding-top: 12px; border-top: 1px solid var(--border-color); margin-top: 12px;">
            <div style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;">Purpose</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">Start positive, build connection</div>
        </div>
    </div>

    <!-- Scorecard Details -->
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 24px;">
        <div style="font-size: 0.875rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px;">5-10 min â€¢ Scorecard</div>
        <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 8px 0;">Review weekly numbers (5-15 KPIs)</p>
        <div style="padding-top: 12px; border-top: 1px solid var(--border-color); margin-top: 12px;">
            <div style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;">Purpose</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">Identify trends, surface issues</div>
        </div>
    </div>

    <!-- Rock Review Details -->
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 24px;">
        <div style="font-size: 0.875rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px;">10-15 min â€¢ Rock Review</div>
        <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 8px 0;">Track quarterly goalsâ€”on or off track</p>
        <div style="padding-top: 12px; border-top: 1px solid var(--border-color); margin-top: 12px;">
            <div style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;">Purpose</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">Maintain focus on 90-day priorities</div>
        </div>
    </div>

    <!-- Headlines Details -->
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 24px;">
        <div style="font-size: 0.875rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px;">15-20 min â€¢ Headlines</div>
        <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 8px 0;">Customer, employee, company FYIs</p>
        <div style="padding-top: 12px; border-top: 1px solid var(--border-color); margin-top: 12px;">
            <div style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;">Purpose</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">Share context, no discussion</div>
        </div>
    </div>

    <!-- IDS Details (Featured) -->
    <div style="grid-column: 1 / -1; background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(217, 119, 6, 0.15) 100%); border: 1px solid rgba(251, 191, 36, 0.4); border-radius: 12px; padding: 24px;">
        <div style="font-size: 1rem; font-weight: 700; color: #fbbf24; margin-bottom: 4px;">20-80 min â€¢ IDS (Issues)</div>
        <p style="font-size: 0.9375rem; color: var(--text-secondary); margin: 8px 0;"><strong>Identify, Discuss, Solve</strong> the top 3 issues. Work through customer, employee, and company challenges systematically.</p>
        <div style="background: rgba(251, 191, 36, 0.2); border-left: 4px solid #fbbf24; padding: 12px 16px; margin-top: 16px; border-radius: 4px;">
            <strong style="display: block; color: #fbbf24; font-size: 0.875rem; margin-bottom: 4px;">This is where the magic happens</strong>
            <span style="font-size: 0.875rem; color: var(--text-primary);">60+ minutes dedicated to deep problem-solving. Focus on resolving real blockers and moving the business forward.</span>
        </div>
        <div style="padding-top: 12px; border-top: 1px solid rgba(251, 191, 36, 0.3); margin-top: 12px;">
            <div style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;">Purpose</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">Solve real problems, move business forward</div>
        </div>
    </div>

    <!-- Conclude Details -->
    <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 24px;">
        <div style="font-size: 0.875rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px;">80-90 min â€¢ Conclude</div>
        <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 8px 0;">Recap to-dos, rate meeting (1-10), communicate next steps</p>
        <div style="padding-top: 12px; border-top: 1px solid var(--border-color); margin-top: 12px;">
            <div style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;">Purpose</div>
            <div style="font-size: 0.875rem; color: var(--text-secondary);">Ensure clarity, close professionally</div>
        </div>
    </div>

</div>

    <!-- L10 Setup Wizard -->
    <div class="card">
        <h2 class="card-title">âš™ï¸ L10 Setup & Configuration</h2>
        
        <div class="setup-sections">
            <!-- Section 1: Meeting Logistics -->
            <div class="setup-section">
                <div class="setup-section-header">
                    <h3>1ï¸âƒ£ Meeting Logistics</h3>
                    <span class="completion-badge" id="logisticsComplete">Incomplete</span>
                </div>
                <div class="setup-content">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Meeting Day</label>
                            <select id="l10Day">
                                <option>Monday</option>
                                <option selected>Tuesday</option>
                                <option>Wednesday</option>
                                <option>Thursday</option>
                                <option>Friday</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Start Time</label>
                            <input type="time" id="l10StartTime" value="09:00" />
                        </div>
                        <div class="form-group">
                            <label>Duration</label>
                            <select id="l10Duration">
                                <option value="60">60 minutes</option>
                                <option value="90" selected>90 minutes (recommended)</option>
                                <option value="120">120 minutes</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Participants (Leadership Team)</label>
                        <div id="participantsList">
                            <div class="participant-chip">
                                <input type="text" placeholder="Name" />
                                <input type="text" placeholder="Role" />
                                <button class="btn-icon-small" onclick="removeParticipant(this)">âœ•</button>
                            </div>
                        </div>
                        <button class="btn btn-secondary btn-small" onclick="addParticipant()">+ Add Participant</button>
                    </div>

                    <div class="checklist">
                        <label class="checklist-item">
                            <input type="checkbox" id="sameTimeEveryWeek" />
                            <span>Same day/time locked in everyone's calendar for next 13 weeks</span>
                        </label>
                        <label class="checklist-item">
                            <input type="checkbox" id="meetingRoomBooked" />
                            <span>Dedicated meeting room booked (or Zoom link created)</span>
                        </label>
                        <label class="checklist-item">
                            <input type="checkbox" id="noCancellations" />
                            <span>Team committed to no cancellations (L10 is sacred time)</span>
                        </label>
                    </div>

                    <button class="btn btn-ai" onclick="aiOptimizeLogistics()">
                        <span>âœ¨</span> AI: Suggest Optimal Meeting Time
                    </button>
                </div>
            </div>

            <!-- Section 2: Scorecard Design -->
            <div class="setup-section">
                <div class="setup-section-header">
                    <h3>2ï¸âƒ£ Scorecard (5-15 Weekly Measurables)</h3>
                    <span class="completion-badge" id="scorecardComplete">Incomplete</span>
                </div>
                <div class="setup-content">
                    <p class="section-intro">
                        Your scorecard is a handful of weekly numbers that give you a pulse on the business. 
                        Track 5-15 leading and lagging indicators that matter most.
                    </p>

                    <div class="scorecard-categories">
                        <button class="category-btn active" data-category="all" onclick="filterScorecardCategory('all')">All</button>
                        <button class="category-btn" data-category="revenue" onclick="filterScorecardCategory('revenue')">Revenue</button>
                        <button class="category-btn" data-category="sales" onclick="filterScorecardCategory('sales')">Sales</button>
                        <button class="category-btn" data-category="marketing" onclick="filterScorecardCategory('marketing')">Marketing</button>
                        <button class="category-btn" data-category="operations" onclick="filterScorecardCategory('operations')">Operations</button>
                        <button class="category-btn" data-category="people" onclick="filterScorecardCategory('people')">People</button>
                        <button class="category-btn" data-category="financial" onclick="filterScorecardCategory('financial')">Financial</button>
                    </div>

                    <div class="table-container">
                        <table class="scorecard-table" id="scorecardTable">
                            <thead>
                                <tr>
                                    <th width="5%"><input type="checkbox" /></th>
                                    <th width="20%">Measurable</th>
                                    <th width="15%">Who</th>
                                    <th width="10%">Goal</th>
                                    <th width="15%">Category</th>
                                    <th width="25%">Why It Matters</th>
                                    <th width="10%">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="scorecardTableBody">
                                <!-- Sample rows -->
                                <tr data-category="revenue">
                                    <td><input type="checkbox" /></td>
                                    <td><input type="text" value="Weekly Revenue" /></td>
                                    <td><input type="text" value="CFO" /></td>
                                    <td><input type="text" value="$50k" /></td>
                                    <td>
                                        <select>
                                            <option value="revenue" selected>Revenue</option>
                                            <option value="sales">Sales</option>
                                            <option value="marketing">Marketing</option>
                                            <option value="operations">Operations</option>
                                            <option value="people">People</option>
                                            <option value="financial">Financial</option>
                                        </select>
                                    </td>
                                    <td><input type="text" value="Lagging indicator of business health" /></td>
                                    <td>
                                        <button class="btn-icon" onclick="deleteRow(this)">ðŸ—‘ï¸</button>
                                    </td>
                                </tr>
                                <tr data-category="sales">
                                    <td><input type="checkbox" /></td>
                                    <td><input type="text" value="Qualified Leads" /></td>
                                    <td><input type="text" value="CRO" /></td>
                                    <td><input type="text" value="20" /></td>
                                    <td>
                                        <select>
                                            <option value="revenue">Revenue</option>
                                            <option value="sales" selected>Sales</option>
                                            <option value="marketing">Marketing</option>
                                            <option value="operations">Operations</option>
                                            <option value="people">People</option>
                                            <option value="financial">Financial</option>
                                        </select>
                                    </td>
                                    <td><input type="text" value="Leading indicator - pipeline health" /></td>
                                    <td>
                                        <button class="btn-icon" onclick="deleteRow(this)">ðŸ—‘ï¸</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="btn-row">
                        <button class="btn btn-secondary" onclick="addScorecardRow()">
                            <span>âž•</span> Add Measurable
                        </button>
                        <button class="btn btn-ai" onclick="aiSuggestScorecardKPIs()">
                            <span>âœ¨</span> AI: Suggest KPIs for Our Industry
                        </button>
                        <button class="btn btn-secondary" onclick="importScorecardTemplate()">
                            <span>ðŸ“¥</span> Import Template
                        </button>
                    </div>

                    <div class="scorecard-tips">
                        <h4>ðŸ’¡ Scorecard Design Tips:</h4>
                        <ul>
                            <li><strong>Mix leading and lagging:</strong> Revenue (lagging) + Leads (leading)</li>
                            <li><strong>Weekly is best:</strong> Monthly numbers are too slow for course correction</li>
                            <li><strong>One owner per number:</strong> Clear accountability</li>
                            <li><strong>5-15 total:</strong> More than 15 becomes noise</li>
                            <li><strong>Easy to track:</strong> If it takes hours to compile, simplify</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section 3: Rocks (90-Day Priorities) -->
            <div class="setup-section">
                <div class="setup-section-header">
                    <h3>3ï¸âƒ£ Rocks (3-7 Per Person Per Quarter)</h3>
                    <span class="completion-badge" id="rocksComplete">Incomplete</span>
                </div>
                <div class="setup-content">
                    <p class="section-intro">
                        Rocks are your 90-day priorities. Each person (and the company) should have 3-7 rocks per quarter. 
                        Review progress weekly in your L10 (on track / off track).
                    </p>

                    <div class="rock-creator">
                        <h4>Create New Rock</h4>
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label>Rock Statement (SMART goal)</label>
                                <input type="text" id="rockStatement" placeholder="e.g., 'Launch new pricing model by March 31 with 80% customer adoption'" />
                            </div>
                            <div class="form-group">
                                <label>Owner</label>
                                <select id="rockOwner">
                                    <option>Select person...</option>
                                    <!-- Populated from participants -->
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Quarter</label>
                                <select id="rockQuarter">
                                    <option>Q4 2024</option>
                                    <option selected>Q1 2025</option>
                                    <option>Q2 2025</option>
                                    <option>Q3 2025</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Due Date</label>
                                <input type="date" id="rockDueDate" />
                            </div>
                            <div class="form-group">
                                <label>Priority</label>
                                <select id="rockPriority">
                                    <option value="p0">P0 - Critical</option>
                                    <option value="p1" selected>P1 - High</option>
                                    <option value="p2">P2 - Medium</option>
                                </select>
                            </div>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-primary" onclick="addRock()">
                                <span>âž•</span> Add Rock
                            </button>
                            <button class="btn btn-ai" onclick="aiImproveRockStatement()">
                                <span>âœ¨</span> AI: Make Rock Statement SMART
                            </button>
                        </div>
                    </div>

                    <div class="rocks-list" id="rocksList">
                        <h4>Current Quarter Rocks</h4>
                        <!-- Rock items will be added here -->
                        <div class="rock-item">
                            <div class="rock-header">
                                <span class="rock-status status-on-track">âœ… On Track</span>
                                <button class="btn-icon" onclick="toggleRockStatus(this)">â†”ï¸</button>
                                <button class="btn-icon" onclick="editRock(this)">âœï¸</button>
                                <button class="btn-icon" onclick="deleteRock(this)">ðŸ—‘ï¸</button>
                            </div>
                            <div class="rock-content">
                                <div class="rock-statement">Launch new pricing model by March 31 with 80% customer adoption</div>
                                <div class="rock-meta">
                                    <span class="rock-owner">ðŸ‘¤ CRO</span>
                                    <span class="rock-quarter">ðŸ“… Q1 2025</span>
                                    <span class="rock-due">â° Mar 31</span>
                                </div>
                            </div>
                            <div class="rock-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 65%;"></div>
                                </div>
                                <span class="progress-text">65% complete</span>
                            </div>
                        </div>
                    </div>

                    <div class="rock-tips">
                        <h4>ðŸ’¡ Writing Good Rocks:</h4>
                        <ul>
                            <li><strong>Specific:</strong> "Hire 3 SDRs" not "Improve sales team"</li>
                            <li><strong>Measurable:</strong> Include numbers/dates</li>
                            <li><strong>Achievable:</strong> Stretch goal but realistic in 90 days</li>
                            <li><strong>Single owner:</strong> One person accountable</li>
                            <li><strong>Time-bound:</strong> Due date within the quarter</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Section 4: Issues List Setup -->
            <div class="setup-section">
                <div class="setup-section-header">
                    <h3>4ï¸âƒ£ Issues List Process</h3>
                    <span class="completion-badge" id="issuesComplete">Incomplete</span>
                </div>
                <div class="setup-content">
                    <p class="section-intro">
                        Define how your team will surface, prioritize, and track issues. This is critical for L10 effectiveness.
                    </p>

                    <div class="checklist">
                        <label class="checklist-item">
                            <input type="checkbox" id="issuesShared" />
                            <span>Issues list accessible to all team members (shared doc/tool)</span>
                        </label>
                        <label class="checklist-item">
                            <input type="checkbox" id="addIssuesAnytime" />
                            <span>Anyone can add issues anytime (not just during L10)</span>
                        </label>
                        <label class="checklist-item">
                            <input type="checkbox" id="prioritizeBeforeL10" />
                            <span>Issues prioritized before L10 (top 3 tackled first)</span>
                        </label>
                        <label class="checklist-item">
                            <input type="checkbox" id="idsProcess" />
                            <span>Team trained on IDS process (Identify, Discuss, Solve)</span>
                        </label>
                        <label class="checklist-item">
                            <input type="checkbox" id="removeWhenSolved" />
                            <span>Issues only removed when truly solved (not just discussed)</span>
                        </label>
                    </div>

                    <div class="form-group">
                        <label>Issues Tool/Location</label>
                        <select id="issuesTool">
                            <option>This tool (Component 3 IDS tab)</option>
                            <option>Ninety.io</option>
                            <option>Traction Tools</option>
                            <option>Notion</option>
                            <option>Google Sheets</option>
                            <option>Asana</option>
                            <option>Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Prioritization Method</label>
                        <div class="radio-group">
                            <label><input type="radio" name="prioritization" value="voting" checked /> Team votes on top issues</label>
                            <label><input type="radio" name="prioritization" value="integrator" /> Integrator decides priority</label>
                            <label><input type="radio" name="prioritization" value="impact" /> Impact/urgency matrix</label>
                            <label><input type="radio" name="prioritization" value="roi" /> Estimated ROI/effort</label>
                        </div>
                    </div>

                    <button class="btn btn-ai" onclick="aiSuggestIssuesProcess()">
                        <span>âœ¨</span> AI: Design Custom Issues Process
                    </button>
                </div>
            </div>

            <!-- Section 5: Meeting Norms -->
            <div class="setup-section">
                <div class="setup-section-header">
                    <h3>5ï¸âƒ£ Meeting Norms & Ground Rules</h3>
                    <span class="completion-badge" id="normsComplete">Incomplete</span>
                </div>
                <div class="setup-content">
                    <p class="section-intro">
                        Establish clear expectations for how the team will show up and engage during L10s.
                    </p>

                    <div class="norms-editor">
                        <h4>Our L10 Ground Rules:</h4>
                        <div id="normsList">
                            <div class="norm-item">
                                <input type="checkbox" checked />
                                <input type="text" value="Start and end on time (respect the 90 minutes)" />
                                <button class="btn-icon-small" onclick="removeNorm(this)">âœ•</button>
                            </div>
                            <div class="norm-item">
                                <input type="checkbox" checked />
                                <input type="text" value="No phones/laptops during meeting (full presence)" />
                                <button class="btn-icon-small" onclick="removeNorm(this)">âœ•</button>
                            </div>
                            <div class="norm-item">
                                <input type="checkbox" checked />
                                <input type="text" value="Disagree openly but commit fully to decisions" />
                                <button class="btn-icon-small" onclick="removeNorm(this)">âœ•</button>
                            </div>
                            <div class="norm-item">
                                <input type="checkbox" checked />
                                <input type="text" value="Stay on point (use parking lot for tangents)" />
                                <button class="btn-icon-small" onclick="removeNorm(this)">âœ•</button>
                            </div>
                            <div class="norm-item">
                                <input type="checkbox" checked />
                                <input type="text" value="Attack issues, not people" />
                                <button class="btn-icon-small" onclick="removeNorm(this)">âœ•</button>
                            </div>
                        </div>
                        <button class="btn btn-secondary btn-small" onclick="addNorm()">+ Add Norm</button>
                    </div>

                    <div class="form-group">
                        <label>How will you rate meetings? (1-10 scale at end of each L10)</label>
                        <select id="ratingMethod">
                            <option selected>Average of all ratings</option>
                            <option>Must be 8+ to count as good meeting</option>
                            <option>Track trend over time</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>What happens if rating is below 7?</label>
                        <textarea id="lowRatingAction" rows="2" placeholder="e.g., Discuss what went wrong and adjust for next week"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="setup-completion">
            <button class="btn btn-primary btn-large" onclick="saveL10Setup()">
                <span>ðŸ’¾</span> Save L10 Configuration
            </button>
            <button class="btn btn-secondary" onclick="generateL10Agenda()">
                <span>ðŸ“„</span> Generate Printable Agenda
            </button>
            <button class="btn btn-ai" onclick="aiReviewL10Setup()">
                <span>âœ¨</span> AI: Review My Setup
            </button>
        </div>
    </div>

    <!-- L10 Meeting Tracker -->
    <div class="card">
        <h2 class="card-title">ðŸ“Š L10 Meeting History & Metrics</h2>
        
        <div class="meeting-stats">
            <div class="stat-card">
                <div class="stat-value" id="meetingsHeld">0</div>
                <div class="stat-label">Meetings Held</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgRating">â€”</div>
                <div class="stat-label">Average Rating</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="issuesSolved">0</div>
                <div class="stat-label">Issues Solved</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="attendance">â€”</div>
                <div class="stat-label">Attendance Rate</div>
            </div>
        </div>

        <div class="meeting-log">
            <h3>Recent L10s</h3>
            <table class="meeting-history-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Attendance</th>
                        <th>Issues Discussed</th>
                        <th>Issues Solved</th>
                        <th>Rating</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody id="meetingHistoryBody">
                    <!-- Meetings logged here -->
                </tbody>
            </table>
            <button class="btn btn-primary" onclick="logL10Meeting()">
                <span>âž•</span> Log Today's L10
            </button>
        </div>
    </div>

    <!-- L10 Resources -->
    <div class="card">
        <h2 class="card-title">ðŸ“š L10 Resources & Templates</h2>
        
        <div class="resources-grid">
            <div class="resource-card">
                <h3>ðŸ“„ Agenda Template</h3>
                <p>Printable 1-pager for weekly L10s</p>
                <button class="btn btn-secondary" onclick="downloadAgendaTemplate()">Download</button>
            </div>
            <div class="resource-card">
                <h3>ðŸ“Š Scorecard Template</h3>
                <p>Pre-built KPIs by industry</p>
                <button class="btn btn-secondary" onclick="downloadScorecardTemplate()">Download</button>
            </div>
            <div class="resource-card">
                <h3>ðŸŽ¯ Rock Tracker</h3>
                <p>90-day goal tracking spreadsheet</p>
                <button class="btn btn-secondary" onclick="downloadRockTemplate()">Download</button>
            </div>
            <div class="resource-card">
                <h3>ðŸ“‹ Meeting Minutes</h3>
                <p>Template for capturing decisions/actions</p>
                <button class="btn btn-secondary" onclick="downloadMinutesTemplate()">Download</button>
            </div>
        </div>
    </div>
</div>

<!-- TAB: CEO SUMMARY -->
<div class="tab-content" id="tab-summary">
    <div class="card">
        <h2 class="card-title">CEO Summary â€“ Org System Health & 90-Day Focus</h2>
        <p class="card-subtitle">
            A single-page view of where your organisation stands on ownership, accountability, culture and revenue execution â€“ plus the
            90-day moves that will make the biggest difference.
        </p>

        <div class="summary-grid">
            <div class="summary-card">
                <div class="summary-section-label">Overall Health & Stage</div>
                <div style="display:flex; align-items:flex-end; gap:12px; margin-bottom:10px;">
                    <div>
                        <div class="summary-metric-big" id="orgHealthLabelSummary">â€“</div>
                        <div class="summary-metric-label">Org System Health (Pre)</div>
                    </div>
                    <div>
                        <div class="tiny-label">Readiness Stage</div>
                        <div id="readinessStageLabelSummary" style="font-size:0.85rem; font-weight:600;">Not Scored</div>
                        <div style="font-size:0.75rem; color:var(--text-muted);" id="readinessStageDescriptionSummary">
                            Derived from your 1â€“5 scores in Pre-Assessment.
                        </div>
                    </div>
                </div>

                <div class="summary-tag-row">
                    <span class="summary-tag">Ownership & seat clarity score</span>
                    <span class="summary-tag">Leadership alignment & follow-through</span>
                    <span class="summary-tag">Culture (safety + challenge)</span>
                    <span class="summary-tag">Revenue execution & rhythm</span>
                </div>

                <p style="font-size:0.8rem; color:var(--text-muted); margin-top:10px;">
                    Use this as your â€œOrg System Healthâ€ headline in board packs and leadership offsites. You can refresh it post-implementation to show progress.
                </p>

            <div style="margin-top:12px;">
              <div class="tiny-label">Baseline Narrative (Auto-Suggested)</div>
              <textarea
                id="summaryBaselineNarrative"
                class="summary-textarea"
                placeholder="Once you score the Pre-Assessment, an auto-suggested CEO narrative will appear here. You can then edit it freely."
              ></textarea>
            </div>

            <div class="summary-card">
                <div class="summary-section-label">Top 5 Strengths & Top 5 Risks</div>
                <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:8px;">
                    Summarise whatâ€™s working and whatâ€™s fragile based on the Accountability Chart, People Analyzer, Culture heatmap and Pre-Assessment prompts.
                </p>

                <div class="summary-columns-2">
                    <div>
                        <div class="tiny-label">Top Strengths / Advantages</div>
                        <textarea id="summaryStrengths" class="summary-textarea" placeholder="E.g. Strong exec trust, clear ownership for revenue engine, robust culture in GTM teamsâ€¦"></textarea>
                    </div>
                    <div>
                        <div class="tiny-label">Top Risks / Misalignments</div>
                        <textarea id="summaryRisks" class="summary-textarea" placeholder="E.g. Founder still in operational weeds, CS & Product underpowered, cross-functional friction in Sales â†” CSâ€¦"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="summary-card" style="margin-top:18px;">
            <div class="summary-section-label">Friction, People Risk & Talent Capacity</div>
            <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:8px;">
                Turn qualitative noise into a clear risk map the leadership team can align on.
            </p>

            <div class="summary-columns-2">
                <div>
                    <div class="tiny-label">Cross-Functional Friction Zones</div>
                    <textarea id="summaryFriction" class="summary-textarea" placeholder="E.g. Sales vs. CS on renewals, Marketing vs. Sales on MQL quality, Product vs. GTM on roadmap and commitments."></textarea>
                </div>
                <div>
                    <div class="tiny-label">Critical People / Succession Risks</div>
                    <textarea id="summaryPeopleRisks" class="summary-textarea" placeholder="Summarise the most material people / succession risks surfaced across the tool."></textarea>
                </div>
            </div>

            <div class="summary-columns-2" style="margin-top:12px;">
                <div>
                    <div class="tiny-label">Talent & Capacity vs. Growth Plan</div>
                    <textarea id="summaryTalentCapacity" class="summary-textarea" placeholder="Are you under-powered anywhere for the next 12â€“18 months? Where will capacity break first?"></textarea>
                </div>
                <div>
                    <div class="tiny-label">Org Design / Seat Changes to Explore</div>
                    <textarea id="summaryOrgChanges" class="summary-textarea" placeholder="E.g. Split roles, upgrade seats, add new leadership layer, shift responsibilities between functions."></textarea>
                </div>
            </div>
        </div>

        <div class="summary-card" style="margin-top:18px;">
            <div class="summary-section-label">90-Day Action Plan Generator</div>
            <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:8px;">
                Capture the 3â€“5 highest-leverage moves for the next 90 days. Use the button to scaffold a simple outline based on your health score and readiness stage.
            </p>

            <div class="summary-columns-2">
                <div>
                    <div class="tiny-label">Ownership & Accountability Moves (90 Days)</div>
                    <textarea id="planOwnership" class="summary-textarea" placeholder="E.g. Finalise Accountability Chart, run GWC / RPRS decisions, align L10 agendas to seatsâ€¦"></textarea>
                </div>
                <div>
                    <div class="tiny-label">People & Culture Moves (90 Days)</div>
                    <textarea id="planPeople" class="summary-textarea" placeholder="E.g. Address 2â€“3 key people decisions, reset expectations with leaders, embed feedback & coaching rituals."></textarea>
                </div>
            </div>

            <div class="summary-columns-2" style="margin-top:12px;">
                <div>
                    <div class="tiny-label">Revenue Execution & Rhythm Moves (90 Days)</div>
                    <textarea id="planRevenue" class="summary-textarea" placeholder="E.g. Tighten forecast cadence, align handoffs, set clear pipeline accountability and scorecards."></textarea>
                </div>
                <div>
                    <div class="tiny-label">Board / Investor Narrative</div>
                    <textarea id="planBoard" class="summary-textarea" placeholder="How youâ€™ll communicate org health, risks and the 90-day plan to your board and investors."></textarea>
                </div>
            </div>

            <div class="section-footer" style="margin-top:14px;">
                <button class="btn btn-primary" type="button" onclick="generateNinetyDayOutline()">
                    <span>âœ¨</span>Generate 90-Day Plan Outline
                </button>
                <span class="section-footer-note">
                    This wonâ€™t overwrite your notes â€“ it just adds a light scaffold you can refine with your leadership team.
                </span>
            </div>
        </div>
    </div>
</div>

    <div class="tab-content" id="tab-culture">
        <div class="card">
            <h2 class="card-title">Culture & Accountability Heatmap</h2>
            <p class="card-subtitle">
                Score how well your culture supports ownership, clarity and people decisions â€“ now and after implementing Component 3.
            </p>

            <div class="score-pill-row">
                <div class="score-pill">
                    <span class="score-pill-label">Overall Accountability Score</span>
                    <span class="score-pill-value" id="accountabilityScore">â€“</span>
                </div>
                <div class="score-pill">
                    <span class="score-pill-label">People Decisions Pipeline</span>
                    <span class="score-pill-value" id="peopleDecisionsScore">â€“</span>
                </div>
                <div class="score-pill">
                    <span class="score-pill-label">L10 & IDS Discipline</span>
                    <span class="score-pill-value" id="l10DisciplineScore">â€“</span>
                </div>
            </div>

            <div class="heatmap-grid">
                <div class="heatmap-header">Dimension</div>
                <div class="heatmap-header">Clarity of Seats & Roles</div>
                <div class="heatmap-header">Ownership & Follow-Through</div>
                <div class="heatmap-header">People Decisions Discipline</div>
                <div class="heatmap-header">L10 & IDS Rhythm</div>

                <div class="heatmap-label">Today</div>
                <div class="heatmap-cell" data-dimension="clarity" data-time="today" onclick="cycleHeatmap(this)">â€“</div>
                <div class="heatmap-cell" data-dimension="ownership" data-time="today" onclick="cycleHeatmap(this)">â€“</div>
                <div class="heatmap-cell" data-dimension="people_decisions" data-time="today" onclick="cycleHeatmap(this)">â€“</div>
                <div class="heatmap-cell" data-dimension="l10_ids" data-time="today" onclick="cycleHeatmap(this)">â€“</div>

                <div class="heatmap-label">Target â€“ 12 Months</div>

    <script>
    // ==========================================
    // COMPONENT 3 CORE JAVASCRIPT
    // ==========================================
    
    // Tab switching function
    function switchTab(tabId) {
        console.log('ðŸ”„ Switching to tab:', tabId);
        
        // Hide all tabs and deactivate all buttons
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        
        // Show selected tab and activate button
        const tab = document.getElementById('tab-' + tabId);
        const btn = document.querySelector(`[data-tab="${tabId}"]`);
        if (tab) tab.classList.add('active');
        if (btn) btn.classList.add('active');
        
        // Initialize tools when first accessed
        if (tabId === 'org' && typeof AccountabilityChart !== 'undefined') {
            setTimeout(() => AccountabilityChart.init(), 100);
        }
        if (tabId === 'people' && typeof PeopleAnalyzer !== 'undefined') {
            setTimeout(() => PeopleAnalyzer.init(), 100);
        }
    }

    // ==========================================
    // ACCOUNTABILITY CHART (Tab: org)
    // All variables scoped inside this IIFE
    // ==========================================
    const AccountabilityChart = (function() {
        // Private variables - scoped to this module
        const STORAGE_KEY = 'bearopsAccountabilityChart_v4';
        let initialized = false;
        
        function init() {
            if (initialized) return;
            console.log('ðŸ›ï¸ Initializing Accountability Chart...');
            
            try {
                // All accountability chart code here
                
                    const state = {
                        companyName: '',
                        focusedFunctionId: null,
                        functions: [] // {id, name, collapsed, seats:[{id, role, owner, purpose, responsibilities[], comms[], metrics[], decisions[], interfaces[], collapsed}]}
                    };
                
                    const companyNameInput = document.getElementById('companyName');
                    const companyLabel = document.getElementById('companyLabel');
                    const functionsGrid = document.getElementById('functionsGrid');
                    const seatFunctionSelect = document.getElementById('seatFunctionSelect');
                    const emptyState = document.getElementById('emptyState');
                    const chartSummary = document.getElementById('chartSummary');
                
                    const functionNameInput = document.getElementById('functionName');
                    const seatRoleInput = document.getElementById('seatRole');
                    const seatOwnerInput = document.getElementById('seatOwner');
                    const seatPurposeInput = document.getElementById('seatPurpose');
                    const seatResponsibilitiesInput = document.getElementById('seatResponsibilities');
                    const seatCommsInput = document.getElementById('seatComms');
                    const seatMetricsInput = document.getElementById('seatMetrics');
                    const seatDecisionsInput = document.getElementById('seatDecisions');
                    const seatInterfacesInput = document.getElementById('seatInterfaces');
                    const seatCollapsedCheckbox = document.getElementById('seatCollapsed');
                
                    const btnAddFunction = document.getElementById('btnAddFunction');
                    const btnAddSeat = document.getElementById('btnAddSeat');
                    const btnClearSeatForm = document.getElementById('btnClearSeatForm');
                    const btnReset = document.getElementById('btnReset');
                    const btnCollapseAll = document.getElementById('btnCollapseAll');
                    const btnExpandAll = document.getElementById('btnExpandAll');
                
                    const summaryFunctions = document.getElementById('summaryFunctions');
                    const summarySeats = document.getElementById('summarySeats');
                    const summaryEmpty = document.getElementById('summaryEmpty');
                
                    const focusBar = document.getElementById('focusBar');
                    const focusFunctionNameEl = document.getElementById('focusFunctionName');
                    const btnClearFocus = document.getElementById('btnClearFocus');
                    const togglePeople = document.getElementById('togglePeople');
                
                    const themeLabel = document.getElementById('themeLabel');
                    const themeToggleWrapper = document.querySelector('.toggle-pill');
                
                    function generateId() {
                        return 'fn_' + Math.random().toString(36).substr(2, 9);
                    }
                
                    function safeParseArray(value) {
                        if (!value) return [];
                        if (Array.isArray(value)) return value;
                        if (typeof value !== 'string') return [];
                        return value
                            .split('\n')
                            .map(r => r.trim())
                            .filter(Boolean);
                    }
                
                    function saveState() {
                        try {
                            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
                        } catch (e) {
                            console.error('Failed to save chart', e);
                        }
                    }
                
                    function loadState() {
                        try {
                            const raw = localStorage.getItem(STORAGE_KEY);
                            if (!raw) return;
                            const parsed = JSON.parse(raw);
                            if (parsed && typeof parsed === 'object') {
                                state.companyName = parsed.companyName || '';
                                state.focusedFunctionId = parsed.focusedFunctionId || null;
                                state.functions = Array.isArray(parsed.functions) ? parsed.functions : [];
                
                                state.functions.forEach(fn => {
                                    if (typeof fn.collapsed !== 'boolean') fn.collapsed = false;
                                    fn.seats = Array.isArray(fn.seats) ? fn.seats : [];
                                    fn.seats.forEach(seat => {
                                        if (typeof seat.collapsed !== 'boolean') seat.collapsed = true;
                                    });
                                });
                            }
                        } catch (e) {
                            console.error('Failed to parse saved chart', e);
                        }
                    }
                
                    function updateCompanyLabel() {
                        if (state.companyName && state.companyName.trim() !== '') {
                            companyLabel.textContent = state.companyName.trim() + ' â€¢ Accountability Chart';
                        } else {
                            companyLabel.textContent = '';
                        }
                    }
                
                    function renderFunctionSelect() {
                        seatFunctionSelect.innerHTML = '<option value="">Choose functionâ€¦</option>';
                        state.functions.forEach(fn => {
                            const opt = document.createElement('option');
                            opt.value = fn.id;
                            opt.textContent = fn.name;
                            seatFunctionSelect.appendChild(opt);
                        });
                    }
                
                    function renderSummary() {
                        const totalFunctions = state.functions.length;
                        let totalSeats = 0;
                        let emptySeats = 0;
                
                        state.functions.forEach(fn => {
                            fn.seats = Array.isArray(fn.seats) ? fn.seats : [];
                            totalSeats += fn.seats.length;
                            fn.seats.forEach(seat => {
                                if (!seat.owner || !seat.owner.trim()) {
                                    emptySeats++;
                                }
                            });
                        });
                
                        summaryFunctions.textContent = totalFunctions;
                        summarySeats.textContent = totalSeats;
                        summaryEmpty.textContent = emptySeats;
                
                        chartSummary.innerHTML = '';
                
                        if (totalFunctions === 0) return;
                
                        const leaderFn = state.functions.find(fn => /lead|exec|founder|board/i.test(fn.name)) || null;
                        if (leaderFn) {
                            const pill = document.createElement('div');
                            pill.className = 'pill-summary';
                            pill.textContent = 'Leadership function: ' + leaderFn.name;
                            chartSummary.appendChild(pill);
                        }
                
                        const openSeatPill = document.createElement('div');
                        openSeatPill.className = 'pill-summary';
                        openSeatPill.textContent = emptySeats === 0
                            ? 'All seats have owners assigned.'
                            : emptySeats + ' seat' + (emptySeats === 1 ? '' : 's') + ' with no owner (hiring / promotion opportunities).';
                        chartSummary.appendChild(openSeatPill);
                
                        const multiSeatFns = state.functions.filter(fn => fn.seats.length >= 4);
                        if (multiSeatFns.length > 0) {
                            const names = multiSeatFns.map(f => f.name).join(', ');
                            const pill = document.createElement('div');
                            pill.className = 'pill-summary';
                            pill.textContent = 'Broad functions: ' + names + ' â€“ consider splitting into clearer sub-functions.';
                            chartSummary.appendChild(pill);
                        }
                    }
                
                    function createDetailBlock(title, contentOrList) {
                        if (!contentOrList) return null;
                        const isArray = Array.isArray(contentOrList);
                        const lines = isArray ? contentOrList : safeParseArray(contentOrList);
                        if (!lines.length && typeof contentOrList === 'string' && !contentOrList.trim()) {
                            return null;
                        }
                
                        const block = document.createElement('div');
                        block.className = 'seat-detail-block';
                
                        const titleEl = document.createElement('div');
                        titleEl.className = 'seat-detail-title';
                        titleEl.textContent = title;
                
                        const bodyEl = document.createElement('div');
                        bodyEl.className = 'seat-detail-body';
                
                        if (lines.length) {
                            const ul = document.createElement('ul');
                            ul.style.paddingLeft = '16px';
                            ul.style.margin = '0';
                            lines.forEach(line => {
                                const li = document.createElement('li');
                                li.textContent = line;
                                ul.appendChild(li);
                            });
                            bodyEl.appendChild(ul);
                        } else {
                            bodyEl.textContent = typeof contentOrList === 'string' ? contentOrList : '';
                        }
                
                        block.appendChild(titleEl);
                        block.appendChild(bodyEl);
                        return block;
                    }
                
                    function renderChart() {
                        functionsGrid.innerHTML = '';
                
                        if (state.functions.length === 0) {
                            emptyState.style.display = 'block';
                        } else {
                            emptyState.style.display = 'none';
                        }
                
                        // Focus pill bar
                        if (state.focusedFunctionId) {
                            const focusedFn = state.functions.find(f => f.id === state.focusedFunctionId);
                            if (focusedFn) {
                                focusBar.style.display = 'flex';
                                focusFunctionNameEl.textContent = focusedFn.name;
                            } else {
                                focusBar.style.display = 'none';
                                focusFunctionNameEl.textContent = '';
                                state.focusedFunctionId = null;
                            }
                        } else {
                            focusBar.style.display = 'none';
                            focusFunctionNameEl.textContent = '';
                        }
                
                        state.functions.forEach(fn => {
                            if (typeof fn.collapsed !== 'boolean') fn.collapsed = false;
                
                            const card = document.createElement('div');
                            card.className = 'function-card';
                            if (fn.collapsed) card.classList.add('collapsed');
                
                            const header = document.createElement('div');
                            header.className = 'function-header';
                
                            const headerLeft = document.createElement('div');
                            headerLeft.className = 'function-header-left';
                
                            const nameEl = document.createElement('div');
                            nameEl.className = 'function-name';
                            nameEl.textContent = fn.name;
                
                            const seatCount = document.createElement('div');
                            seatCount.className = 'seat-count';
                            seatCount.textContent = fn.seats.length + ' seat' + (fn.seats.length === 1 ? '' : 's');
                
                            headerLeft.appendChild(nameEl);
                            headerLeft.appendChild(seatCount);
                
                            const headerRight = document.createElement('div');
                            headerRight.className = 'function-header-right';
                
                            // Focus icon if this is the focused function
                            if (state.focusedFunctionId && state.focusedFunctionId === fn.id) {
                                const focusIcon = document.createElement('button');
                                focusIcon.className = 'function-focus-icon';
                                focusIcon.type = 'button';
                                focusIcon.title = 'Click to clear focus and show all functions';
                                focusIcon.addEventListener('click', clearFocus);
                
                                const iconSpan = document.createElement('span');
                                iconSpan.className = 'icon';
                                iconSpan.textContent = 'ðŸŽ¯';
                
                                const textSpan = document.createElement('span');
                                textSpan.textContent = 'Focused';
                
                                focusIcon.appendChild(iconSpan);
                                focusIcon.appendChild(textSpan);
                
                                headerRight.appendChild(focusIcon);
                            }
                
                            // Per-function seat detail collapse/expand
                            const collapseSeatsBtn = document.createElement('button');
                            collapseSeatsBtn.className = 'mini-button';
                            collapseSeatsBtn.textContent = 'Collapse seats';
                            collapseSeatsBtn.addEventListener('click', () => collapseAllSeatsInFunction(fn.id));
                
                            const expandSeatsBtn = document.createElement('button');
                            expandSeatsBtn.className = 'mini-button';
                            expandSeatsBtn.textContent = 'Expand seats';
                            expandSeatsBtn.addEventListener('click', () => expandAllSeatsInFunction(fn.id));
                
                            headerRight.appendChild(collapseSeatsBtn);
                            headerRight.appendChild(expandSeatsBtn);
                
                            const deleteFnBtn = document.createElement('button');
                            deleteFnBtn.className = 'mini-button danger';
                            deleteFnBtn.textContent = 'Delete';
                            deleteFnBtn.title = 'Delete this function and all its seats';
                            deleteFnBtn.addEventListener('click', () => deleteFunction(fn.id));
                            headerRight.appendChild(deleteFnBtn);
                
                            const toggleBtn = document.createElement('button');
                            toggleBtn.className = 'mini-button';
                            toggleBtn.textContent = fn.collapsed ? 'Show seats' : 'Hide seats';
                            toggleBtn.addEventListener('click', () => toggleFunctionCollapse(fn.id));
                
                            headerRight.appendChild(toggleBtn);
                
                            header.appendChild(headerLeft);
                            header.appendChild(headerRight);
                
                            const seatsList = document.createElement('div');
                            seatsList.className = 'seats-list';
                
                            if (fn.seats.length === 0) {
                                const empty = document.createElement('div');
                                empty.className = 'empty-state';
                                empty.textContent = 'No seats yet. Add roles for this function on the left.';
                                seatsList.appendChild(empty);
                            } else if (!fn.collapsed) {
                                fn.seats.forEach(seat => {
                                    if (typeof seat.collapsed !== 'boolean') seat.collapsed = true;
                
                                    const seatCard = document.createElement('div');
                                    seatCard.className = 'seat-card';
                                    if (seat.collapsed) seatCard.classList.add('collapsed-details');
                
                                    const seatTop = document.createElement('div');
                                    seatTop.className = 'seat-top';
                
                                    const seatRole = document.createElement('div');
                                    seatRole.className = 'seat-role';
                                    seatRole.textContent = seat.role;
                
                                    const seatOwner = document.createElement('div');
                                    seatOwner.className = 'seat-owner';
                
                                    if (!togglePeople.checked) {
                                        if (!seat.owner || !seat.owner.trim()) {
                                            seatOwner.textContent = 'Open seat';
                                            seatOwner.classList.add('empty');
                                        } else {
                                            seatOwner.textContent = 'Owned by ' + seat.owner;
                                        }
                                    } else {
                                        if (!seat.owner || !seat.owner.trim()) {
                                            seatOwner.textContent = 'No owner yet';
                                            seatOwner.classList.add('empty');
                                        } else {
                                            seatOwner.textContent = seat.owner;
                                        }
                                    }
                
                                    seatTop.appendChild(seatRole);
                                    seatTop.appendChild(seatOwner);
                
                                    // click header to toggle this seat only
                                    seatTop.addEventListener('click', () => toggleSeatCollapse(fn.id, seat.id));
                
                                    seatCard.appendChild(seatTop);
                
                                    if (!seat.collapsed) {
                                        const meta = document.createElement('div');
                                        meta.className = 'seat-meta';
                                        meta.textContent = (seat.responsibilities?.length || 0) + ' key responsibilities';
                                        seatCard.appendChild(meta);
                
                                        const purposeBlock = createDetailBlock('Purpose', seat.purpose);
                                        if (purposeBlock) seatCard.appendChild(purposeBlock);
                
                                        if ((seat.responsibilities || []).length)
                                            seatCard.appendChild(createDetailBlock('Scope & Responsibilities', seat.responsibilities));
                
                                        const commsBlock = createDetailBlock('Communication Norms', seat.comms || []);
                                        if (commsBlock) seatCard.appendChild(commsBlock);
                
                                        const metricsBlock = createDetailBlock('Metrics of Success', seat.metrics || []);
                                        if (metricsBlock) seatCard.appendChild(metricsBlock);
                
                                        const decisionsBlock = createDetailBlock('Key Decisions', seat.decisions || []);
                                        if (decisionsBlock) seatCard.appendChild(decisionsBlock);
                
                                        const interfacesBlock = createDetailBlock('Interfaces & Handoffs', seat.interfaces || []);
                                        if (interfacesBlock) seatCard.appendChild(interfacesBlock);
                                    } else {
                                        if ((seat.responsibilities || []).length > 0) {
                                            const collapsedNote = document.createElement('div');
                                          
                                         
                                            seatCard.appendChild(collapsedNote);
                                        }
                                    }
                
                                    seatsList.appendChild(seatCard);
                                });
                            } else if (fn.seats.length > 0) {
                                const collapsedNote = document.createElement('div');
                                collapsedNote.className = 'empty-state';
                                collapsedNote.textContent = 'Seats hidden â€“ click "Show seats" to expand.';
                                seatsList.appendChild(collapsedNote);
                            }
                
                            card.appendChild(header);
                            card.appendChild(seatsList);
                            functionsGrid.appendChild(card);
                        });
                
                        renderSummary();
                    }
                
                    function addFunction() {
                        const name = functionNameInput.value.trim();
                        if (!name) {
                            alert('Please enter a function name.');
                            return;
                        }
                        const existing = state.functions.find(fn => fn.name.toLowerCase() === name.toLowerCase());
                        if (existing) {
                            alert('That function already exists.');
                            return;
                        }
                        state.functions.push({ id: generateId(), name, collapsed: false, seats: [] });
                        functionNameInput.value = '';
                        saveState();
                        renderFunctionSelect();
                        renderChart();
                    }
                
                    function deleteFunction(functionId) {
                        const idx = state.functions.findIndex(fn => fn.id === functionId);
                        if (idx === -1) return;
                        const fn = state.functions[idx];
                        const confirmed = confirm('Delete function "' + fn.name + '" and all its seats? This cannot be undone.');
                        if (!confirmed) return;
                        if (state.focusedFunctionId === functionId) {
                            state.focusedFunctionId = null;
                        }
                        state.functions.splice(idx, 1);
                        saveState();
                        renderFunctionSelect();
                        renderChart();
                    }
                
                    function clearFunctionForm() {
                        functionNameInput.value = '';
                    }
                
                    function parseLines(value) {
                        return value
                            .split('\n')
                            .map(r => r.trim())
                            .filter(Boolean);
                    }
                
                    function addSeat() {
                        const functionId = seatFunctionSelect.value;
                        if (!functionId) {
                            alert('Please choose a function before adding a seat.');
                            return;
                        }
                        const fn = state.functions.find(f => f.id === functionId);
                        if (!fn) {
                            alert('Selected function not found.');
                            return;
                        }
                
                        const role = seatRoleInput.value.trim();
                        if (!role) {
                            alert('Please add a seat / role title.');
                            return;
                        }
                
                        const owner = seatOwnerInput.value.trim();
                        const purpose = seatPurposeInput.value.trim();
                        const responsibilities = parseLines(seatResponsibilitiesInput.value || '');
                        const comms = parseLines(seatCommsInput.value || '');
                        const metrics = parseLines(seatMetricsInput.value || '');
                        const decisions = parseLines(seatDecisionsInput.value || '');
                        const interfaces = parseLines(seatInterfacesInput.value || '');
                        const collapsed = !!seatCollapsedCheckbox.checked;
                
                        fn.seats.push({
                            id: generateId(),
                            role,
                            owner,
                            purpose,
                            responsibilities,
                            comms,
                            metrics,
                            decisions,
                            interfaces,
                            collapsed
                        });
                
                        clearSeatForm(false);
                        saveState();
                        renderChart();
                    }
                
                    function clearSeatForm(resetFunction = false) {
                        if (resetFunction) seatFunctionSelect.value = '';
                        seatRoleInput.value = '';
                        seatOwnerInput.value = '';
                        seatPurposeInput.value = '';
                        seatResponsibilitiesInput.value = '';
                        seatCommsInput.value = '';
                        seatMetricsInput.value = '';
                        seatDecisionsInput.value = '';
                        seatInterfacesInput.value = '';
                        seatCollapsedCheckbox.checked = true;
                    }
                
                    function resetChart() {
                        const confirmReset = confirm('This will clear all functions and seats from the chart. You cannot undo this. Continue?');
                        if (!confirmReset) return;
                        state.companyName = '';
                        state.functions = [];
                        state.focusedFunctionId = null;
                        companyNameInput.value = '';
                        saveState();
                        updateCompanyLabel();
                        renderFunctionSelect();
                        renderChart();
                    }
                
                    function collapseAllFunctions() {
                        state.functions.forEach(fn => {
                            fn.collapsed = true;
                        });
                        saveState();
                        renderChart();
                    }
                
                    function expandAllFunctions() {
                        state.functions.forEach(fn => {
                            fn.collapsed = false;
                        });
                        saveState();
                        renderChart();
                    }
                
                    function toggleFunctionCollapse(functionId) {
                        const fn = state.functions.find(f => f.id === functionId);
                        if (!fn) return;
                        fn.collapsed = !fn.collapsed;
                        saveState();
                        renderChart();
                    }
                
                    function toggleSeatCollapse(functionId, seatId) {
                        const fn = state.functions.find(f => f.id === functionId);
                        if (!fn) return;
                        const seat = fn.seats.find(s => s.id === seatId);
                        if (!seat) return;
                        seat.collapsed = !seat.collapsed;
                        saveState();
                        renderChart();
                    }
                
                    function collapseAllSeatsInFunction(functionId) {
                        const fn = state.functions.find(f => f.id === functionId);
                        if (!fn) return;
                        fn.seats.forEach(seat => { seat.collapsed = true; });
                        saveState();
                        renderChart();
                    }
                
                    function expandAllSeatsInFunction(functionId) {
                        const fn = state.functions.find(f => f.id === functionId);
                        if (!fn) return;
                        fn.seats.forEach(seat => { seat.collapsed = false; });
                        saveState();
                        renderChart();
                    }
                
                    function clearFocus() {
                        state.focusedFunctionId = null;
                        state.functions.forEach(fn =>
                            fn.collapsed = false
                        );
                        saveState();
                        renderChart();
                    }
                
                    function initTheme() {
                        const stored = localStorage.getItem('bearopsTheme') || 'dark';
                        if (stored === 'light') {
                            document.body.classList.add('light');
                            themeLabel.textContent = 'â˜€ï¸ Light';
                        } else {
                            document.body.classList.remove('light');
                            themeLabel.textContent = 'ðŸŒ™ Dark';
                        }
                    }
                
                    function toggleTheme() {
                        if (document.body.classList.contains('light')) {
                            document.body.classList.remove('light');
                            themeLabel.textContent = 'ðŸŒ™ Dark';
                            localStorage.setItem('bearopsTheme', 'dark');
                        } else {
                            document.body.classList.add('light');
                            themeLabel.textContent = 'â˜€ï¸ Light';
                            localStorage.setItem('bearopsTheme', 'light');
                        }
                    }
                
                    companyNameInput.addEventListener('input', () => {
                        state.companyName = companyNameInput.value;
                        updateCompanyLabel();
                        saveState();
                    });
                
                    btnAddFunction.addEventListener('click', addFunction);
                    btnAddSeat.addEventListener('click', addSeat);
                    btnClearSeatForm.addEventListener('click', () => clearSeatForm(true));
                    btnReset.addEventListener('click', resetChart);
                    togglePeople.addEventListener('change', renderChart);
                    themeToggleWrapper.addEventListener('click', toggleTheme);
                    btnCollapseAll.addEventListener('click', collapseAllFunctions);
                    btnExpandAll.addEventListener('click', expandAllFunctions);
                    btnClearFocus.addEventListener('click', clearFocus);
                
                    // Init
                    loadState();
                    companyNameInput.value = state.companyName || '';
                    updateCompanyLabel();
                    renderFunctionSelect();
                    renderChart();
                    initTheme();
                
                initialized = true;
                console.log('âœ… Accountability Chart initialized');
            } catch(error) {
                console.error('âŒ Accountability Chart initialization failed:', error);
            }
        }
        
        return { 
            init: init,
            get initialized() { return initialized; }
        };
    })();

    // ==========================================
    // PEOPLE ANALYZER (Tab: people)
    // All variables scoped inside this IIFE
    // ==========================================
    const PeopleAnalyzer = (function() {
        // Private variables - scoped to this module
        const STORAGE_KEY = 'eosPeopleAnalyzer_v6';
        const ACCT_STORAGE_KEY = 'bearopsAccountabilityChart_v4';
        let initialized = false;
        
        function init() {
            if (initialized) return;
            console.log('ðŸ§‘â€ðŸ¤â€ðŸ§‘ Initializing People Analyzer...');
            
            try {
                // All people analyzer code here
                
                    const valueKeys = [
                      'customer_first',
                      'ownership_chaos',
                      'bias_action',
                      'collab_low_ego',
                      'data_informed',
                      'learning_velocity'
                    ];
                
                    const valueLabels = {
                      customer_first: 'Customer-first mindset',
                      ownership_chaos: 'Ownership over chaos',
                      bias_action: 'Bias for action',
                      collab_low_ego: 'Collaboration & low ego',
                      data_informed: 'Data-informed thinking',
                      learning_velocity: 'Learning velocity'
                    };
                
                    const defaultFunctionList = [
                      { key: 'business',    label: 'Business Values',   builtIn: true },
                      { key: 'sales',       label: 'Sales',             builtIn: true },
                      { key: 'marketing',   label: 'Marketing',         builtIn: true },
                      { key: 'success',     label: 'Customer Success',  builtIn: true },
                      { key: 'product',     label: 'Product',           builtIn: true },
                      { key: 'engineering', label: 'Engineering',       builtIn: true },
                      { key: 'support',     label: 'Support',           builtIn: true }
                    ];
                
                    const defaultValueDefinitions = {
                      customer_first: 'Always starts from the customerâ€™s problem, not our internal preferences or politics.',
                      ownership_chaos: 'Steps into messy situations, makes decisions, and owns outcomes without waiting for perfect clarity.',
                      bias_action: 'Moves fast, runs small experiments, and unblocks progress instead of waiting for perfect information.',
                      collab_low_ego: 'Works cross-functionally, shares context, and optimises for the best outcome, not personal credit.',
                      data_informed: 'Uses metrics and evidence to shape opinions and changes approach when the data says so.',
                      learning_velocity: 'Learns quickly, adapts to change, and scales as the company grows.'
                    };
                
                    const functionDefaultDefinitions = {
                      sales: {
                        customer_first: 'Discovery starts with outcomes and pains, not our pitch. Protects trust over short-term quota.',
                        ownership_chaos: 'Takes ownership of messy territories, unclear ICP, and broken handoffs.',
                        bias_action: 'Follows up quickly, tests new talk tracks, and experiments with sequences.',
                        collab_low_ego: 'Brings CS/Product into deals early and shares learning with the team.',
                        data_informed: 'Looks at win rate, stage conversion, and coverage before shouting â€œwe need more leadsâ€.',
                        learning_velocity: 'Updates messaging after wins/losses and shares what works with the team.'
                      },
                      marketing: {
                        customer_first: 'Campaigns start with real customer language and problems.',
                        ownership_chaos: 'Ships campaigns even when personas and segments are still evolving.',
                        bias_action: 'Launches iterative campaigns rather than waiting for perfect assets.',
                        collab_low_ego: 'Pulls in feedback from Sales and CS and kills low-performing ideas quickly.',
                        data_informed: 'Optimises for pipeline and revenue, not just MQL volume.',
                        learning_velocity: 'Tests new channels and formats and rolls out winners fast.'
                      }
                    };
                
                    let functionList = JSON.parse(JSON.stringify(defaultFunctionList));
                    let valueDefinitions = {};
                    let currentFunctionKey = 'business';
                
                    const body = document.body;
                    const themeToggle = document.getElementById('themeToggle');
                    const themeLabel = document.getElementById('themeLabel');
                
                    const peopleBody = document.getElementById('peopleBody');
                    const addRowBtn = document.getElementById('addRowBtn');
                    const recalcBtn = document.getElementById('recalcBtn');
                    const exportBtn = document.getElementById('exportBtn');
                    const syncFromChartBtn = document.getElementById('syncFromChartBtn');
                    const saveBtn = document.getElementById('saveBtn');
                    const resetBtn = document.getElementById('resetBtn');
                
                    const rightPeopleCountEl = document.getElementById('rightPeopleCount');
                    const rightSeatCountEl = document.getElementById('rightSeatCount');
                    const fullMatchCountEl = document.getElementById('fullMatchCount');
                    const coachOrExitCountEl = document.getElementById('coachOrExitCount');
                    const insightBanner = document.getElementById('insightBanner');
                    const insightMetrics = document.getElementById('insightMetrics');
                
                    const functionTabs = document.getElementById('functionTabs');
                    const valuesDetails = document.getElementById('valuesDetails');
                
                    const coreHeaders = document.querySelectorAll('.core-header');
                
                    function getFunctionByKey(key) {
                      return functionList.find(f => f.key === key);
                    }
                
                    function ensureBusinessExists() {
                      if (!functionList.some(f => f.key === 'business')) {
                        functionList.unshift({ key: 'business', label: 'Business Values', builtIn: true });
                      }
                    }
                
                    function getFunctionLabel(fnKey) {
                      const f = getFunctionByKey(fnKey);
                      if (f) return f.label;
                      const nice = (fnKey || '').replace(/_/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
                      return nice || 'Business Values';
                    }
                
                    function ensureFunctionInList(fnKey, labelOverride) {
                      ensureBusinessExists();
                      let fn = getFunctionByKey(fnKey);
                      if (!fn) {
                        fn = {
                          key: fnKey,
                          label: labelOverride || getFunctionLabel(fnKey),
                          builtIn: false
                        };
                        functionList.push(fn);
                      } else if (labelOverride) {
                        fn.label = labelOverride;
                      }
                      return fn.key;
                    }
                
                    function mapFunctionNameToFnKey(name) {
                      if (!name) return 'business';
                      const trimmed = name.trim();
                      if (!trimmed) return 'business';
                      const lower = trimmed.toLowerCase();
                
                      const existing = functionList.find(f => f.label.toLowerCase() === lower);
                      if (existing) return existing.key;
                
                      let baseKey = lower
                        .replace(/[^a-z0-9]+/g, '_')
                        .replace(/^_+|_+$/g, '');
                      if (!baseKey) baseKey = 'fn_' + Date.now();
                
                      let key = baseKey;
                      let i = 2;
                      while (functionList.some(f => f.key === key)) {
                        key = baseKey + '_' + i++;
                      }
                      return key;
                    }
                
                    themeToggle.addEventListener('click', () => {
                      const current = body.getAttribute('data-theme') || 'dark';
                      const next = current === 'dark' ? 'light' : 'dark';
                      body.setAttribute('data-theme', next);
                      themeLabel.textContent = next === 'dark' ? 'Dark' : 'Light';
                      saveState();
                    });
                
                    function renderFunctionTabs() {
                      ensureBusinessExists();
                      const tabsHtml = functionList.map(fn => {
                        const canDelete = !fn.builtIn && fn.key !== 'business';
                        return `
                          <button class="fn-tab" data-fn="${fn.key}" type="button">
                            <span>${fn.label}</span>
                            ${canDelete ? `<span class="fn-tab-delete" data-fn="${fn.key}" title="Delete function">âœ•</span>` : ''}
                          </button>
                        `;
                      }).join('');
                      const addHtml = `<button class="fn-add" type="button" data-add-fn>ï¼‹ Add Function</button>`;
                      functionTabs.innerHTML = tabsHtml + addHtml;
                      setActiveFunctionTab(currentFunctionKey);
                    }
                
                    function setActiveFunctionTab(fnKey) {
                      const tabs = functionTabs.querySelectorAll('.fn-tab');
                      tabs.forEach(tab => {
                        tab.classList.toggle('active', tab.dataset.fn === fnKey);
                      });
                    }
                
                    function captureCurrentFunctionDefinitions() {
                      if (!currentFunctionKey) return;
                      const map = valueDefinitions[currentFunctionKey] || {};
                      const rows = valuesDetails.querySelectorAll('.value-row');
                      rows.forEach(row => {
                        const key = row.dataset.valueRow;
                        const textarea = row.querySelector('textarea.value-textarea');
                        if (key && textarea) {
                          map[key] = textarea.value;
                        }
                      });
                      valueDefinitions[currentFunctionKey] = map;
                    }
                
                    function renderValuesDetails(fnKey) {
                      const defs = valueDefinitions[fnKey] || {};
                      const baseDefaults =
                        fnKey === 'business'
                          ? defaultValueDefinitions
                          : (functionDefaultDefinitions[fnKey] || {});
                
                      const html = valueKeys.map(key => {
                        const label = valueLabels[key];
                        const text =
                          defs[key] ||
                          baseDefaults[key] ||
                          defaultValueDefinitions[key] ||
                          '';
                        return `
                          <div class="value-row" data-value-row="${key}">
                            <div class="value-header">
                              <span class="value-name">${label}</span>
                              <span class="value-badge">${getFunctionLabel(fnKey)}</span>
                            </div>
                            <textarea
                              class="value-textarea"
                              data-function="${fnKey}"
                              data-value-key="${key}"
                              placeholder="Define how â€˜${label}â€™ shows up for ${getFunctionLabel(fnKey)}â€¦"
                            >${text}</textarea>
                          </div>
                        `;
                      }).join('');
                      valuesDetails.innerHTML = html;
                    }
                
                    function highlightValueRow(valueKey) {
                      document.querySelector('.values-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
                      const rows = valuesDetails.querySelectorAll('.value-row');
                      rows.forEach(r => r.classList.remove('highlight'));
                      const target = valuesDetails.querySelector(`.value-row[data-value-row="${valueKey}"]`);
                      if (target) {
                        target.classList.add('highlight');
                        setTimeout(() => target.classList.remove('highlight'), 2000);
                      }
                    }
                
                    function filterRowsForFunction() {
                      const rows = peopleBody.querySelectorAll('tr');
                      rows.forEach(tr => {
                        const sel = tr.querySelector('.fn-select');
                        const rowFn = sel ? sel.value : 'business';
                        if (currentFunctionKey === 'business') {
                          tr.style.display = '';
                        } else {
                          tr.style.display = rowFn === currentFunctionKey ? '' : 'none';
                        }
                      });
                    }
                
                    function refreshFnSelectOptions() {
                      const selects = peopleBody.querySelectorAll('.fn-select');
                      selects.forEach(sel => {
                        const current = sel.value || 'business';
                        sel.innerHTML = functionList.map(f =>
                          `<option value="${f.key}" ${f.key === current ? 'selected' : ''}>${f.label}</option>`
                        ).join('');
                      });
                    }
                
                    function switchFunction(fnKey) {
                      captureCurrentFunctionDefinitions();
                      currentFunctionKey = fnKey;
                      setActiveFunctionTab(fnKey);
                      renderValuesDetails(fnKey);
                      filterRowsForFunction();
                      recalcAll();
                      saveState();
                    }
                
                    function deleteFunction(fnKey) {
                      if (!fnKey || fnKey === 'business') {
                        alert('You cannot delete Business Values.');
                        return;
                      }
                      const fn = getFunctionByKey(fnKey);
                      if (!fn) return;
                      if (!confirm(`Delete function "${fn.label}" and move its seats back to Business Values?`)) return;
                
                      functionList = functionList.filter(f => f.key !== fnKey);
                      delete valueDefinitions[fnKey];
                
                      peopleBody.querySelectorAll('.fn-select').forEach(sel => {
                        if (sel.value === fnKey) sel.value = 'business';
                      });
                
                      if (currentFunctionKey === fnKey) currentFunctionKey = 'business';
                
                      renderFunctionTabs();
                      renderValuesDetails(currentFunctionKey);
                      refreshFnSelectOptions();
                      filterRowsForFunction();
                      recalcAll();
                      saveState();
                    }
                
                    function addNewFunction() {
                      const name = prompt('Name for new function (e.g. "RevOps", "EMEA Sales")?');
                      if (!name) return;
                      const trimmed = name.trim();
                      if (!trimmed) return;
                
                      const lower = trimmed.toLowerCase();
                      if (lower === 'business values' || lower === 'business') {
                        alert('â€œBusiness Valuesâ€ is reserved. Please choose another name.');
                        return;
                      }
                
                      let key = mapFunctionNameToFnKey(trimmed);
                      key = ensureFunctionInList(key, trimmed);
                
                      currentFunctionKey = key;
                      renderFunctionTabs();
                      renderValuesDetails(key);
                      refreshFnSelectOptions();
                      filterRowsForFunction();
                      recalcAll();
                      saveState();
                    }
                
                    functionTabs.addEventListener('click', (e) => {
                      const deleteBtn = e.target.closest('.fn-tab-delete');
                      if (deleteBtn) {
                        deleteFunction(deleteBtn.dataset.fn);
                        return;
                      }
                      const addBtn = e.target.closest('[data-add-fn]');
                      if (addBtn) {
                        addNewFunction();
                        return;
                      }
                      const tab = e.target.closest('.fn-tab');
                      if (!tab) return;
                      switchFunction(tab.dataset.fn);
                    });
                
                    valuesDetails.addEventListener('input', (e) => {
                      if (e.target.classList.contains('value-textarea')) {
                        captureCurrentFunctionDefinitions();
                        saveState();
                      }
                    });
                
                    coreHeaders.forEach(th => {
                      const key = th.dataset.valueKey;
                      if (!key) return;
                      th.addEventListener('click', () => highlightValueRow(key));
                    });
                
                    function updateCoreValueUI(scoreButtons, value) {
                      const buttons = scoreButtons.querySelectorAll('.score-btn');
                      buttons.forEach(btn => {
                        btn.classList.remove('active-plus', 'active-mid', 'active-minus');
                        if (btn.dataset.score === value) {
                          if (value === '+') btn.classList.add('active-plus');
                          else if (value === 'Â±') btn.classList.add('active-mid');
                          else if (value === '-') btn.classList.add('active-minus');
                        }
                      });
                      scoreButtons.dataset.score = value || '';
                    }
                
                    function updateGwcUI(toggle, value) {
                      const yesBtn = toggle.querySelector('.yes');
                      const noBtn = toggle.querySelector('.no');
                      yesBtn.classList.remove('active');
                      noBtn.classList.remove('active');
                      if (value === 'yes') yesBtn.classList.add('active');
                      if (value === 'no') noBtn.classList.add('active');
                      toggle.dataset.value = value || '';
                    }
                
                    function createRow(name = '', seat = '', coreScores = [], gwcValues = ['', '', ''], fnKey = 'business') {
                      fnKey = ensureFunctionInList(fnKey);
                      const safeScores = coreScores && coreScores.length === valueKeys.length
                        ? coreScores
                        : new Array(valueKeys.length).fill('');
                
                      const tr = document.createElement('tr');
                      tr.innerHTML = `
                        <td><input class="name-input" type="text" placeholder="Name" value="${name}"></td>
                        <td><input class="seat-input" type="text" placeholder="Seat / Role" value="${seat}"></td>
                        <td>
                          <select class="fn-select">
                            ${functionList.map(f => `<option value="${f.key}" ${f.key === fnKey ? 'selected' : ''}>${f.label}</option>`).join('')}
                          </select>
                        </td>
                        ${valueKeys.map((_, i) => `
                          <td>
                            <div class="score-buttons" data-score="${safeScores[i] || ''}">
                              <button class="score-btn" data-score="+">+</button>
                              <button class="score-btn" data-score="Â±">Â±</button>
                              <button class="score-btn" data-score="-">-</button>
                            </div>
                          </td>
                        `).join('')}
                        <td>
                          <div class="gwc-toggle" data-value="${gwcValues[0] || ''}">
                            <button class="gwc-btn yes" data-value="yes">Yes</button>
                            <button class="gwc-btn no" data-value="no">No</button>
                          </div>
                        </td>
                        <td>
                          <div class="gwc-toggle" data-value="${gwcValues[1] || ''}">
                            <button class="gwc-btn yes" data-value="yes">Yes</button>
                            <button class="gwc-btn no" data-value="no">No</button>
                          </div>
                        </td>
                        <td>
                          <div class="gwc-toggle" data-value="${gwcValues[2] || ''}">
                            <button class="gwc-btn yes" data-value="yes">Yes</button>
                            <button class="gwc-btn no" data-value="no">No</button>
                          </div>
                        </td>
                        <td class="right-person-cell"><span class="tag-pill">â€“</span></td>
                        <td class="right-seat-cell"><span class="tag-pill">â€“</span></td>
                        <td class="action-cell"><span class="action-pill">No data</span></td>
                        <td><button class="scorecard-btn" title="Export PDF">ðŸ“„</button></td>
                        <td><button class="remove-btn" title="Remove">âœ–</button></td>
                      `;
                      peopleBody.appendChild(tr);
                
                      const scoreButtons = tr.querySelectorAll('.score-buttons');
                      scoreButtons.forEach((sb, idx) => {
                        updateCoreValueUI(sb, safeScores[idx] || '');
                      });
                
                      const gwcToggles = tr.querySelectorAll('.gwc-toggle');
                      gwcToggles.forEach((toggle, idx) => {
                        updateGwcUI(toggle, gwcValues[idx] || '');
                      });
                
                      return tr;
                    }
                
                    function evaluateRow(tr) {
                      const coreScoreEls = tr.querySelectorAll('.score-buttons');
                      let hasMinus = false;
                      let hasPlusOrMid = false;
                
                      coreScoreEls.forEach(sb => {
                        const val = sb.dataset.score || '';
                        if (val === '-') hasMinus = true;
                        if (val === '+' || val === 'Â±') hasPlusOrMid = true;
                      });
                
                      const rightPerson = !hasMinus && hasPlusOrMid;
                
                      const gwcToggles = tr.querySelectorAll('.gwc-toggle');
                      let rightSeat = true;
                      gwcToggles.forEach(toggle => {
                        const val = toggle.dataset.value;
                        if (val !== 'yes') rightSeat = false;
                      });
                
                      const rightPersonCell = tr.querySelector('.right-person-cell');
                      const rightSeatCell = tr.querySelector('.right-seat-cell');
                      const actionCell = tr.querySelector('.action-cell');
                
                      if (rightPerson) {
                        rightPersonCell.innerHTML = `<span class="tag-pill good">Right Person</span>`;
                      } else {
                        rightPersonCell.innerHTML = `<span class="tag-pill bad">Not Aligned</span>`;
                      }
                
                      if (rightSeat) {
                        rightSeatCell.innerHTML = `<span class="tag-pill good">Right Seat</span>`;
                      } else {
                        rightSeatCell.innerHTML = `<span class="tag-pill">Check GWC</span>`;
                      }
                
                      let actionLabel = 'No data';
                      let actionClass = '';
                      if (rightPerson && rightSeat) {
                        actionLabel = 'Keep & Grow';
                        actionClass = 'action-keep';
                      } else if (rightPerson && !rightSeat) {
                        actionLabel = 'Move Seat / Develop';
                        actionClass = 'action-move';
                      } else if (!rightPerson && rightSeat) {
                        actionLabel = 'Coach Hard / Consider Exit';
                        actionClass = 'action-coach';
                      } else {
                        actionLabel = 'Exit / Replace';
                        actionClass = 'action-exit';
                      }
                      actionCell.innerHTML = `<span class="action-pill ${actionClass}">${actionLabel}</span>`;
                
                      return { rightPerson, rightSeat };
                    }
                
                    function recalcAll() {
                      const rows = peopleBody.querySelectorAll('tr');
                      let totalVisible = 0;
                      let rightPeople = 0;
                      let rightSeats = 0;
                      let fullMatch = 0;
                      let coachOrExit = 0;
                
                      rows.forEach(tr => {
                        if (tr.style.display === 'none') return;
                        totalVisible++;
                        const result = evaluateRow(tr);
                        if (result.rightPerson) rightPeople++;
                        if (result.rightSeat) rightSeats++;
                        if (result.rightPerson && result.rightSeat) fullMatch++;
                        if (!result.rightPerson || !result.rightSeat) coachOrExit++;
                      });
                
                      if (totalVisible === 0) {
                        const msg = currentFunctionKey === 'business'
                          ? 'No people scored yet. Add rows or sync from the Accountability Chart.'
                          : `No people tagged to ${getFunctionLabel(currentFunctionKey)} yet. Tag seats to this function to see insights.`;
                        insightBanner.querySelector('.insight-main').textContent = msg;
                        insightMetrics.style.display = 'none';
                      } else {
                        const ratio = fullMatch / totalVisible;
                        insightBanner.querySelector('.insight-main').textContent =
                          ratio < 0.7
                            ? `Less than 70% of ${getFunctionLabel(currentFunctionKey)} seats are Right Person + Right Seat. Prioritise people decisions this quarter.`
                            : `Strong coverage of Right Person + Right Seat for ${getFunctionLabel(currentFunctionKey)}. Focus on coaching and succession.`;
                        insightMetrics.style.display = 'flex';
                      }
                
                      rightPeopleCountEl.textContent = rightPeople;
                      rightSeatCountEl.textContent = rightSeats;
                      fullMatchCountEl.textContent = fullMatch;
                      coachOrExitCountEl.textContent = coachOrExit;
                
                      saveState();
                    }
                
                    addRowBtn.addEventListener('click', () => {
                      const row = createRow('', '', [], ['', '', ''], currentFunctionKey);
                      evaluateRow(row);
                      filterRowsForFunction();
                      recalcAll();
                    });
                
                    recalcBtn.addEventListener('click', () => {
                      filterRowsForFunction();
                      recalcAll();
                    });
                
                    peopleBody.addEventListener('click', (e) => {
                      const target = e.target;
                
                      if (target.classList.contains('score-btn')) {
                        const sb = target.closest('.score-buttons');
                        const score = target.dataset.score;
                        updateCoreValueUI(sb, score);
                        evaluateRow(sb.closest('tr'));
                        recalcAll();
                      }
                
                      if (target.classList.contains('gwc-btn')) {
                        const toggle = target.closest('.gwc-toggle');
                        const val = target.dataset.value;
                        updateGwcUI(toggle, val);
                        evaluateRow(toggle.closest('tr'));
                        recalcAll();
                      }
                
                      if (target.classList.contains('scorecard-btn')) {
                        const tr = target.closest('tr');
                        if (tr) exportRowToPDF(tr);
                      }
                
                      if (target.classList.contains('remove-btn')) {
                        const tr = target.closest('tr');
                        tr.remove();
                        recalcAll();
                      }
                    });
                
                    peopleBody.addEventListener('change', (e) => {
                      if (e.target.classList.contains('fn-select')) {
                        filterRowsForFunction();
                        recalcAll();
                      }
                    });
                
                    peopleBody.addEventListener('input', (e) => {
                      if (e.target.classList.contains('name-input') || e.target.classList.contains('seat-input')) {
                        recalcAll();
                      }
                    });
                
                    function exportToCsv() {
                      const rows = [];
                      const headers = [
                        'Person',
                        'Seat',
                        'Function',
                        ...valueKeys.map(k => valueLabels[k]),
                        'GetsIt',
                        'WantsIt',
                        'Capacity',
                        'RightPerson',
                        'RightSeat',
                        'SuggestedAction'
                      ];
                      rows.push(headers.join(','));
                
                      peopleBody.querySelectorAll('tr').forEach(tr => {
                        const name = tr.querySelector('.name-input')?.value || '';
                        const seat = tr.querySelector('.seat-input')?.value || '';
                        const fnSel = tr.querySelector('.fn-select');
                        const fnLabel = fnSel ? getFunctionLabel(fnSel.value) : '';
                
                        const coreScores = Array.from(tr.querySelectorAll('.score-buttons')).map(sb => sb.dataset.score || '');
                        const gwcVals = Array.from(tr.querySelectorAll('.gwc-toggle')).map(t => t.dataset.value || '');
                        const rightPersonText = tr.querySelector('.right-person-cell')?.innerText.trim() || '';
                        const rightSeatText = tr.querySelector('.right-seat-cell')?.innerText.trim() || '';
                        const actionText = tr.querySelector('.action-cell')?.innerText.trim() || '';
                
                        const row = [
                          name,
                          seat,
                          fnLabel,
                          ...coreScores,
                          gwcVals[0] || '',
                          gwcVals[1] || '',
                          gwcVals[2] || '',
                          rightPersonText,
                          rightSeatText,
                          actionText
                        ].map(v => `"${String(v).replace(/"/g, '""')}"`);
                
                        rows.push(row.join(','));
                      });
                
                      const blob = new Blob([rows.join('\n')], { type: 'text/csv;charset=utf-8;' });
                      const url = URL.createObjectURL(blob);
                      const a = document.createElement('a');
                      a.href = url;
                      a.download = 'people-analyzer-export.csv';
                      document.body.appendChild(a);
                      a.click();
                      document.body.removeChild(a);
                      URL.revokeObjectURL(url);
                    }
                
                    exportBtn.addEventListener('click', exportToCsv);
                
                    function getStateFromDOM() {
                      captureCurrentFunctionDefinitions();
                
                      const rows = [];
                      peopleBody.querySelectorAll('tr').forEach(tr => {
                        const name = tr.querySelector('.name-input')?.value || '';
                        const seat = tr.querySelector('.seat-input')?.value || '';
                        const fnSel = tr.querySelector('.fn-select');
                        const fnKey = fnSel ? fnSel.value : 'business';
                
                        const coreScores = Array.from(tr.querySelectorAll('.score-buttons')).map(sb => sb.dataset.score || '');
                        const gwcVals = Array.from(tr.querySelectorAll('.gwc-toggle')).map(t => t.dataset.value || '');
                
                        rows.push({
                          name,
                          seat,
                          fnKey,
                          coreScores,
                          gwcVals
                        });
                      });
                
                      return {
                        theme: body.getAttribute('data-theme') || 'dark',
                        rows,
                        functionList,
                        valueDefinitions,
                        currentFunctionKey
                      };
                    }
                
                    function saveState() {
                      try {
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(getStateFromDOM()));
                      } catch (e) {
                        console.warn('Failed to save People Analyzer state', e);
                      }
                    }
                
                    function loadState() {
                      try {
                        const raw = localStorage.getItem(STORAGE_KEY);
                        if (!raw) return null;
                      return JSON.parse(raw);
                      } catch (e) {
                        console.warn('Failed to load People Analyzer state', e);
                        return null;
                      }
                    }
                
                    function applyState(state) {
                      if (!state) return;
                
                      functionList = Array.isArray(state.functionList) && state.functionList.length
                        ? state.functionList
                        : JSON.parse(JSON.stringify(defaultFunctionList));
                      ensureBusinessExists();
                
                      valueDefinitions = state.valueDefinitions || {};
                      currentFunctionKey = state.currentFunctionKey || 'business';
                
                      const theme = state.theme || 'dark';
                      body.setAttribute('data-theme', theme);
                      themeLabel.textContent = theme === 'dark' ? 'Dark' : 'Light';
                
                      renderFunctionTabs();
                      renderValuesDetails(currentFunctionKey);
                
                      peopleBody.innerHTML = '';
                      if (state.rows && state.rows.length) {
                        state.rows.forEach(r => {
                          const row = createRow(
                            r.name || '',
                            r.seat || '',
                            r.coreScores || [],
                            r.gwcVals || ['', '', ''],
                            r.fnKey || 'business'
                          );
                          evaluateRow(row);
                        });
                      }
                
                      refreshFnSelectOptions();
                      filterRowsForFunction();
                      recalcAll();
                    }
                
                    saveBtn.addEventListener('click', () => {
                      saveState();
                      alert('People Analyzer saved locally in this browser.');
                    });
                
                    resetBtn.addEventListener('click', () => {
                      if (!confirm('This clears all People Analyzer data from this browser (does NOT touch the Accountability Chart). Continue?')) return;
                      localStorage.removeItem(STORAGE_KEY);
                      valueDefinitions = {};
                      functionList = JSON.parse(JSON.stringify(defaultFunctionList));
                      currentFunctionKey = 'business';
                      renderFunctionTabs();
                      renderValuesDetails(currentFunctionKey);
                      peopleBody.innerHTML = '';
                      seedDefaultRows();
                      filterRowsForFunction();
                      recalcAll();
                    });
                
                    function loadAccountabilityChartState() {
                      try {
                        const raw = localStorage.getItem(ACCT_STORAGE_KEY);
                        if (!raw) return null;
                        const parsed = JSON.parse(raw);
                        if (!parsed || typeof parsed !== 'object') return null;
                        if (!Array.isArray(parsed.functions)) return null;
                        return parsed;
                      } catch (e) {
                        console.warn('Unable to load Accountability Chart state:', e);
                        return null;
                      }
                    }
                
                    function syncFromAccountabilityChart(opts) {
                      const options = opts || {};
                      const replaceExisting = !!options.replaceExisting;
                
                      const acctState = loadAccountabilityChartState();
                      if (!acctState) {
                        alert('No Accountability Chart data found in this browser.');
                        return;
                      }
                
                      const functions = Array.isArray(acctState.functions) ? acctState.functions : [];
                      if (!functions.length) {
                        alert('Accountability Chart has no functions/seats yet.');
                        return;
                      }
                
                      functions.forEach(fn => {
                        const fnName = (fn.name || '').trim();
                        if (!fnName) return;
                        const fnKey = mapFunctionNameToFnKey(fnName);
                        ensureFunctionInList(fnKey, fnName);
                      });
                
                      renderFunctionTabs();
                      refreshFnSelectOptions();
                
                      if (replaceExisting) {
                        peopleBody.innerHTML = '';
                      }
                
                      const existingKeys = new Set(
                        Array.from(peopleBody.querySelectorAll('tr')).map(tr => {
                          const seat = (tr.querySelector('.seat-input')?.value || '').trim().toLowerCase();
                          const fnSel = tr.querySelector('.fn-select');
                          const fnKey = fnSel ? fnSel.value : 'business';
                          return seat + '|' + fnKey;
                        })
                      );
                
                      let addedCount = 0;
                
                      functions.forEach(fn => {
                        const fnName = (fn.name || '').trim();
                        if (!fnName) return;
                        let fnKey = mapFunctionNameToFnKey(fnName);
                        fnKey = ensureFunctionInList(fnKey, fnName);
                
                        const seats = Array.isArray(fn.seats) ? fn.seats : [];
                        seats.forEach(seat => {
                          const role = (seat.role || '').trim();
                          if (!role) return;
                          const owner = (seat.owner || '').trim();
                          const key = role.toLowerCase() + '|' + fnKey;
                          if (existingKeys.has(key)) return;
                
                          const row = createRow(owner, role, [], ['', '', ''], fnKey);
                          evaluateRow(row);
                          existingKeys.add(key);
                          addedCount++;
                        });
                      });
                
                      filterRowsForFunction();
                      recalcAll();
                
                      if (!addedCount) {
                        alert('Functions synced. No new seats to import.');
                      } else {
                        alert(`Imported ${addedCount} seat(s) from the Accountability Chart.`);
                      }
                    }
                
                    syncFromChartBtn.addEventListener('click', () => {
                      syncFromAccountabilityChart({ replaceExisting: false });
                    });
                
                    async function exportRowToPDF(tr) {
                      const { jsPDF } = window.jspdf;
                
                      const name = tr.querySelector('.name-input')?.value || '';
                      const seat = tr.querySelector('.seat-input')?.value || '';
                      const fnSel = tr.querySelector('.fn-select');
                      const fnLabel = fnSel ? fnSel.options[fnSel.selectedIndex].textContent : '';
                
                      const rightPersonText = tr.querySelector('.right-person-cell')?.innerText.trim() || '';
                      const rightSeatText = tr.querySelector('.right-seat-cell')?.innerText.trim() || '';
                      const actionText = tr.querySelector('.action-cell')?.innerText.trim() || '';
                
                      const scoreButtons = tr.querySelectorAll('.score-buttons');
                      const gwcToggles = tr.querySelectorAll('.gwc-toggle');
                
                      document.getElementById('scName').textContent = name || 'Unnamed Person';
                      document.getElementById('scSeat').textContent = seat || 'Seat not set';
                      document.getElementById('scFunction').textContent = fnLabel || 'Business Values';
                      document.getElementById('scRightPerson').textContent = rightPersonText || 'Right Person? â€“';
                      document.getElementById('scRightSeat').textContent = rightSeatText || 'Right Seat? â€“';
                      document.getElementById('scSuggestedAction').textContent = `Suggested Action: ${actionText || 'â€“'}`;
                      document.getElementById('scMeta').textContent =
                        `Generated from People Analyzer â€¢ ${new Date().toLocaleDateString()}`;
                
                      const scValuesBody = document.getElementById('scValuesBody');
                      scValuesBody.innerHTML = '';
                
                      const scoreMeta = {
                        '+': { label: 'Always', cls: 'sc-score-plus' },
                        'Â±': { label: 'Sometimes', cls: 'sc-score-mid' },
                        '-': { label: 'Rarely', cls: 'sc-score-minus' }
                      };
                
                      scoreButtons.forEach((sb, idx) => {
                        let score = 'â€“';
                        const activeBtn = sb.querySelector('.score-btn.active-plus, .score-btn.active-mid, .score-btn.active-minus');
                
                        if (activeBtn) {
                          score = activeBtn.dataset.score || activeBtn.textContent.trim() || 'â€“';
                        } else if (sb.dataset.score) {
                          score = sb.dataset.score;
                        }
                
                        const key = valueKeys[idx];
                        const label = valueLabels[key] || key;
                
                        const meta = scoreMeta[score] || { label: 'Not set', cls: '' };
                
                const trVal = document.createElement('tr');
                trVal.innerHTML = `
                  <td>
                    ${label} â€“ 
                    <span class="sc-score-inline ${meta.cls}">
                      ${score} ${meta.label}
                    </span>
                  </td>
                `;
                scValuesBody.appendChild(trVal);
                      });
                
                      document.getElementById('scG').textContent =
                        gwcToggles[0]?.dataset.value === 'yes' ? 'Yes' : 'No / n/a';
                      document.getElementById('scW').textContent =
                        gwcToggles[1]?.dataset.value === 'yes' ? 'Yes' : 'No / n/a';
                      document.getElementById('scC').textContent =
                        gwcToggles[2]?.dataset.value === 'yes' ? 'Yes' : 'No / n/a';
                
                      const card = document.getElementById('scorecardTemplate');
                      card.style.display = 'block';
                
                      const canvas = await html2canvas(card, { scale: 2 });
                      const imgData = canvas.toDataURL('image/png');
                
                      const pdf = new jsPDF('p', 'mm', 'a5');
                      const pageWidth = pdf.internal.pageSize.getWidth();
                      const pageHeight = pdf.internal.pageSize.getHeight();
                
                      const margin = 8;
                      const imgWidth = pageWidth - margin * 2;
                      const imgHeight = canvas.height * imgWidth / canvas.width;
                      const yPos = Math.max(margin, (pageHeight - imgHeight) / 2);
                
                      pdf.addImage(imgData, 'PNG', margin, yPos, imgWidth, imgHeight);
                
                      const safeName = (name || 'Seat').replace(/[^a-z0-9]+/gi, '_');
                      pdf.save(`PeopleScorecard_${safeName}.pdf`);
                
                      card.style.display = 'none';
                    }
                
                    function seedDefaultRows() {
                      const examples = [
                        {
                          name: 'Alice â€“ Head of Sales',
                          fnKey: 'sales',
                          coreScores: ['+', '+', '+', 'Â±', '+', '+'],
                          gwc: ['yes', 'yes', 'yes']
                        },
                        {
                          name: 'Brian â€“ CS Lead',
                          fnKey: 'success',
                          coreScores: ['Â±', '+', 'Â±', '+', 'Â±', '-'],
                          gwc: ['yes', 'yes', 'no']
                        }
                      ];
                
                      examples.forEach(ex => {
                        const [personName, seat] = ex.name.split(' â€“ ');
                        const row = createRow(personName, seat, ex.coreScores, ex.gwc, ex.fnKey);
                        evaluateRow(row);
                      });
                
                      filterRowsForFunction();
                      recalcAll();
                    }
                
                    (function init() {
                      renderFunctionTabs();
                      renderValuesDetails(currentFunctionKey);
                
                      const state = loadState();
                      if (state && state.rows && state.rows.length) {
                        applyState(state);
                      } else {
                        const acctState = loadAccountabilityChartState();
                        if (acctState && Array.isArray(acctState.functions) && acctState.functions.length) {
                          syncFromAccountabilityChart({ replaceExisting: true });
                        } else {
                          seedDefaultRows();
                        }
                      }
                    })();
                
                initialized = true;
                console.log('âœ… People Analyzer initialized');
            } catch(error) {
                console.error('âŒ People Analyzer initialization failed:', error);
            }
        }
        
        return { 
            init: init,
            get initialized() { return initialized; }
        };
    })();

// ==========================================
// ISSUES LIST â€“ DATA MODEL & FUNCTIONS
// ==========================================
const ISSUES_STORAGE_KEY = 'bearops_component3_peopleIssues_v1';
let issuesState = [];

// Load issues from localStorage and render
function loadIssuesFromStorage() {
    try {
        const raw = localStorage.getItem(ISSUES_STORAGE_KEY);
        issuesState = raw ? JSON.parse(raw) : [];
    } catch (e) {
        console.warn('Could not parse issues from localStorage', e);
        issuesState = [];
    }
    renderIssuesList();
}

// Save current issues to localStorage
function saveIssuesToStorage() {
    try {
        localStorage.setItem(ISSUES_STORAGE_KEY, JSON.stringify(issuesState));
    } catch (e) {
        console.warn('Could not save issues to localStorage', e);
    }
}

// Add a new issue from the form on the Issues tab
function addIssue() {
    const titleEl = document.getElementById('issueTitle');
    const detailEl = document.getElementById('issueDetail');
    const ownerEl = document.getElementById('issueOwner');
    const severityEl = document.getElementById('issueSeverity');
    const timeframeEl = document.getElementById('issueTimeframe');

    if (!titleEl || !detailEl || !ownerEl || !severityEl || !timeframeEl) {
        console.error('Issues form elements not found.');
        return;
    }

    const title = titleEl.value.trim();
    const detail = detailEl.value.trim();
    const owner = ownerEl.value.trim();
    const severity = severityEl.value;
    const timeframe = timeframeEl.value;

    if (!title) {
        alert('Please add an issue title.');
        return;
    }

    const issue = {
        id: Date.now(),
        title,
        detail,
        owner: owner || 'Unassigned',
        severity,
        timeframe,
        status: 'open',
        createdAt: new Date().toISOString()
    };

    issuesState.push(issue);
    saveIssuesToStorage();
    renderIssuesList();

    // Clear the form
    titleEl.value = '';
    detailEl.value = '';
    ownerEl.value = '';
    severityEl.value = 'low';
    timeframeEl.value = 'this_quarter';
}

// Render the issues into the <ul id="issuesList">
function renderIssuesList() {
    const container = document.getElementById('issuesList');
    if (!container) return;

    container.innerHTML = '';

    if (!issuesState.length) {
        const li = document.createElement('li');
        li.className = 'issues-empty-state';
        li.textContent = 'No people / accountability issues captured yet. Add your first issue on the left.';
        container.appendChild(li);
        return;
    }

    issuesState
        .slice()
        // optional: show critical first, then medium, then low
        .sort((a, b) => severityWeight(b.severity) - severityWeight(a.severity))
        .forEach(issue => {
            const li = document.createElement('li');
            li.className = 'issue-item';

            const createdDate = new Date(issue.createdAt);
            const ageDays = Math.floor((Date.now() - createdDate.getTime()) / (1000 * 60 * 60 * 24));

            // Simple â€œagingâ€ label
            let ageLabel = '';
            if (ageDays >= 30) ageLabel = 'ðŸ”¥ Aging';
            else if (ageDays >= 14) ageLabel = 'âš ï¸ Warm';

            li.innerHTML = `
                <div class="issue-main">
                    <div class="issue-header">
                        <span class="issue-severity issue-severity-${issue.severity}">
                            ${issue.severity === 'critical' ? 'ðŸ”´ Critical' :
                              issue.severity === 'medium' ? 'ðŸŸ  Medium' :
                              'ðŸŸ¢ Low'}
                        </span>
                        ${ageLabel ? `<span class="issue-age">${ageLabel}</span>` : ''}
                        <span class="issue-timeframe">${formatTimeframe(issue.timeframe)}</span>
                    </div>
                    <div class="issue-title-row">
                        <strong>${issue.title}</strong>
                        <span class="issue-owner">Owner: ${issue.owner}</span>
                    </div>
                    <p class="issue-detail">${issue.detail || ''}</p>
                </div>
                <div class="issue-actions">
                    <button class="btn-icon-small" onclick="sendIssueToIds(${issue.id})" title="Push to IDS">â†ª IDS</button>
                    <button class="btn-icon-small" onclick="deleteIssueById(${issue.id})" title="Delete">ðŸ—‘</button>
                </div>
            `;

            container.appendChild(li);
        });
}

// Helper: severity ordering
function severityWeight(severity) {
    switch (severity) {
        case 'critical': return 3;
        case 'medium': return 2;
        case 'low':
        default: return 1;
    }
}

function formatTimeframe(tf) {
    if (tf === 'this_quarter') return 'This Quarter';
    if (tf === 'next_quarter') return 'Next Quarter';
    if (tf === 'backlog') return 'Backlog';
    return tf;
}

// Delete single issue
function deleteIssueById(id) {
    issuesState = issuesState.filter(i => i.id !== id);
    saveIssuesToStorage();
    renderIssuesList();
}

// Copy issues list to clipboard (wired to your "Copy Issues List" button)
function copyIssuesToClipboard() {
    if (!issuesState.length) {
        alert('No issues to copy yet.');
        return;
    }

    const lines = issuesState.map(i =>
        `Title: ${i.title}\nOwner: ${i.owner}\nSeverity: ${i.severity}\nTimeframe: ${formatTimeframe(i.timeframe)}\nDetail: ${i.detail}\n`
    );

    const text = lines.join('\n---------------------------\n');

    navigator.clipboard.writeText(text)
        .then(() => alert('Issues list copied to clipboard.'))
        .catch(err => {
            console.error('Clipboard error', err);
            alert('Could not copy to clipboard. Check browser permissions.');
        });
}

// Stub: push a selected issue straight into IDS (you can extend this later)
function sendIssueToIds(id) {
    const issue = issuesState.find(i => i.id === id);
    if (!issue) return;

    // For now we just alert so you can see it's working.
    // Later you can create a real IDS row here.
    alert(`(Placeholder) Would push to IDS:\n\n${issue.title}`);
}


// === AI Coach: Baseline Narrative from Pre-Assessment ===
function generateBaselineNarrativeFromPre() {
    const ownership = Number(document.getElementById('preScoreOwnership')?.value || 0);
    const leadership = Number(document.getElementById('preScoreLeadership')?.value || 0);
    const culture = Number(document.getElementById('preScoreCulture')?.value || 0);
    const revenue = Number(document.getElementById('preScoreRevenue')?.value || 0);

    const scores = [ownership, leadership, culture, revenue].filter(Boolean);
    if (!scores.length) return;

    const avg = scores.reduce((a, b) => a + b, 0) / scores.length;

    let stageLabel;
    if (avg < 2.5) stageLabel = 'Stage 1â€“2: Foundations are fragile â€“ focus on clarity & basic discipline.';
    else if (avg < 3.5) stageLabel = 'Stage 2â€“3: Mixed â€“ some solid ownership, but gaps and inconsistency.';
    else stageLabel = 'Stage 3â€“4: Strong foundations â€“ focus on scaling discipline and cross-functional rhythm.';

    const reality = (document.getElementById('preCurrentReality')?.value || '').trim();
    const symptoms = (document.getElementById('preSymptoms')?.value || '').trim();
    const outcomes = (document.getElementById('preDesiredOutcomes')?.value || '').trim();
    const constraints = (document.getElementById('preConstraints')?.value || '').trim();

    const narrativeParts = [];

    narrativeParts.push(
        `Org System Health (Pre) is ${avg.toFixed(1)}/5 across ownership, leadership alignment, ` +
        `culture and revenue execution. ${stageLabel}`
    );

    if (reality) {
        narrativeParts.push(`Today, leadership describes the ownership & accountability reality as: ${reality}`);
    }
    if (symptoms) {
        narrativeParts.push(`The main symptoms weâ€™re seeing are: ${symptoms}`);
    }
    if (outcomes) {
        narrativeParts.push(`From Component 3, the top outcomes weâ€™re aiming for are: ${outcomes}`);
    }
    if (constraints) {
        narrativeParts.push(`Key constraints / non-negotiables shaping our design are: ${constraints}`);
    }

    const field = document.getElementById('summaryBaselineNarrative');
    if (field) {
        field.value = narrativeParts.join('\n\n');
    }

    const summaryHealth = document.getElementById('orgHealthLabelSummary');
    if (summaryHealth) {
        summaryHealth.textContent = `${avg.toFixed(1)}/5`;
    }
}

// ==========================================
// PAGE INITIALIZATION
// ==========================================
document.addEventListener('DOMContentLoaded', function () {
    console.log('ðŸ“„ Component 3 loaded');

    // --- TAB SETUP (original behaviour) ---
    document.querySelectorAll('.tab-button').forEach(btn => {
        btn.addEventListener('click', function () {
            const tabId = this.getAttribute('data-tab');
            switchTab(tabId);
        });
    });

    // --- INITIALISE FIRST TAB (original behaviour) ---
    const activeTab = document.querySelector('.tab-content.active');
    if (activeTab) {
        const tabId = activeTab.id.replace('tab-', '');
        if (tabId === 'org' && typeof AccountabilityChart !== 'undefined') {
            setTimeout(() => AccountabilityChart.init(), 200);
        } else if (tabId === 'people' && typeof PeopleAnalyzer !== 'undefined') {
            setTimeout(() => PeopleAnalyzer.init(), 200);
        }
    }

// Load Issues tab data once the page is ready
document.addEventListener('DOMContentLoaded', function () {
    if (typeof loadIssuesFromStorage === 'function') {
        loadIssuesFromStorage();
    }
});


    // --- UPDATE OVERALL PROGRESS (existing function) ---
    if (typeof updateOverallProgress === 'function') {
        updateOverallProgress();
    }

    // --- AI COACH: AUTO NARRATIVE LISTENERS ---
    const preScoreIds = [
        'preScoreOwnership',
        'preScoreLeadership',
        'preScoreCulture',
        'preScoreRevenue'
    ];

    preScoreIds.forEach(id => {
        const el = document.getElementById(id);
        if (el) {
            el.addEventListener('change', generateBaselineNarrativeFromPre);
        }
    });

    const preTextIds = [
        'preCurrentReality',
        'preSymptoms',
        'preDesiredOutcomes',
        'preConstraints'
    ];

    preTextIds.forEach(id => {
        const el = document.getElementById(id);
        if (el) {
            el.addEventListener('blur', generateBaselineNarrativeFromPre);
        }
    });

    // Run once on load in case fields are already filled (e.g. reviewing a saved session)
    generateBaselineNarrativeFromPre();

    console.log('âœ… Component 3 Integration Complete');
});




// ========================================
// ENHANCED IDS & L10 JAVASCRIPT
// ========================================

// AI Integration (placeholder - needs actual Claude API integration)
async function callClaudeAPI(prompt, context) {
    // This is a placeholder. In production, you'd call your Claude API endpoint
    // For now, we'll simulate with a timeout
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve({
                response: "This is a placeholder response. In production, this would call the Claude API with your prompt: " + prompt
            });
        }, 1000);
    });
}

// IDS AI Assistant
document.addEventListener('DOMContentLoaded', function() {
    const idsAiSubmit = document.getElementById('idsAiSubmit');
    if (idsAiSubmit) {
        idsAiSubmit.addEventListener('click', async function() {
            const prompt = document.getElementById('idsAiPrompt').value;
            if (!prompt) return;
            
            // Show loading state
            this.innerHTML = '<span>â³</span> Thinking...';
            this.disabled = true;
            
            try {
                // Call Claude API
                const result = await callClaudeAPI(prompt, {
                    context: 'IDS',
                    currentIssues: getIdsData()
                });
                
                // Display response
                document.getElementById('idsAiResponse').style.display = 'block';
                document.getElementById('idsAiResponseContent').innerHTML = formatAIResponse(result.response);
            } catch (error) {
                console.error('AI Error:', error);
                alert('Error getting AI response. Please try again.');
            } finally {
                this.innerHTML = '<span>âœ¨</span> Get AI Guidance';
                this.disabled = false;
            }
        });
    }
    
    // L10 AI Assistant
    const l10AiSubmit = document.getElementById('l10AiSubmit');
    if (l10AiSubmit) {
        l10AiSubmit.addEventListener('click', async function() {
            const prompt = document.getElementById('l10AiPrompt').value;
            if (!prompt) return;
            
            this.innerHTML = '<span>â³</span> Thinking...';
            this.disabled = true;
            
            try {
                const result = await callClaudeAPI(prompt, {
                    context: 'L10',
                    currentSetup: getL10Data()
                });
                
                document.getElementById('l10AiResponse').style.display = 'block';
                document.getElementById('l10AiResponseContent').innerHTML = formatAIResponse(result.response);
            } catch (error) {
                console.error('AI Error:', error);
                alert('Error getting AI response. Please try again.');
            } finally {
                this.innerHTML = '<span>âœ¨</span> Get AI Guidance';
                this.disabled = false;
            }
        });
    }
});

function formatAIResponse(text) {
    // Format AI response with markdown-like formatting
    return text
        .replace(/\n\n/g, '</p><p>')
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/^- (.+)$/gm, '<li>$1</li>');
}

// IDS Functions
function toggleQuickAdd() {
    const form = document.getElementById('quickAddForm');
    const toggle = document.getElementById('quickAddToggle');
    if (form.style.display === 'none') {
        form.style.display = 'block';
        toggle.textContent = '- Hide';
    } else {
        form.style.display = 'none';
        toggle.textContent = '+ Show';
    }
}

function addQuickIssue() {
    const title = document.getElementById('quickIssueTitle').value;
    const category = document.getElementById('quickIssueCategory').value;
    const priority = document.getElementById('quickIssuePriority').value;
    const context = document.getElementById('quickIssueContext').value;
    const owner = document.getElementById('quickIssueOwner').value;
    
    if (!title) {
        alert('Please enter an issue statement');
        return;
    }
    
    // Add to table
    const tbody = document.getElementById('idsTableBody');
    const row = tbody.insertRow(0);
    row.className = 'ids-row';
    row.dataset.status = 'identified';
    row.dataset.category = category;
    
    const priorityEmoji = priority === 'high' ? 'ðŸ”´' : priority === 'medium' ? 'ðŸŸ¡' : 'ðŸŸ¢';
    const categoryEmoji = getCategoryEmoji(category);
    
    row.innerHTML = `
        <td><input type="checkbox" class="row-select" /></td>
        <td><span class="priority-badge priority-${priority}">${priorityEmoji}</span></td>
        <td><span class="category-badge">${categoryEmoji} ${category.charAt(0).toUpperCase() + category.slice(1)}</span></td>
        <td>
            <div class="issue-cell">
                <strong class="issue-title">${title}</strong>
                <p class="issue-context">${context}</p>
            </div>
        </td>
        <td>${owner}</td>
        <td><span class="status-badge status-identified">Identified</span></td>
        <td>${new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</td>
        <td>â€”</td>
        <td>â€”</td>
        <td>
            <button class="btn-icon" onclick="expandIssueDetails(this)" title="View Details">ðŸ‘ï¸</button>
            <button class="btn-icon" onclick="editIssue(this)" title="Edit">âœï¸</button>
            <button class="btn-icon" onclick="deleteIssue(this)" title="Delete">ðŸ—‘ï¸</button>
        </td>
    `;
    
    // Clear form
    document.getElementById('quickIssueTitle').value = '';
    document.getElementById('quickIssueContext').value = '';
    
    updateIdsMetrics();
    saveIdsData();
}

function getCategoryEmoji(category) {
    const emojis = {
        people: 'ðŸ‘¥',
        process: 'âš™ï¸',
        accountability: 'ðŸŽ¯',
        structure: 'ðŸ—ï¸',
        communication: 'ðŸ’¬',
        performance: 'ðŸ“Š',
        culture: 'ðŸ”¥',
        other: 'ðŸ“Œ'
    };
    return emojis[category] || 'ðŸ“Œ';
}

function filterIds(status) {
    const rows = document.querySelectorAll('.ids-row');
    const buttons = document.querySelectorAll('.filter-pill');
    
    buttons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    rows.forEach(row => {
        if (status === 'all' || row.dataset.status === status) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

function updateIdsMetrics() {
    const rows = document.querySelectorAll('.ids-row');
    let identified = 0, discussed = 0, solved = 0;
    
    rows.forEach(row => {
        const status = row.dataset.status;
        if (status === 'identified') identified++;
        else if (status === 'discussed') discussed++;
        else if (status === 'solved') solved++;
    });
    
    document.getElementById('totalIssues').textContent = rows.length;
    document.getElementById('identifiedCount').textContent = identified;
    document.getElementById('discussedCount').textContent = discussed;
    document.getElementById('solvedCount').textContent = solved;
}

// L10 Functions
function addParticipant() {
    const list = document.getElementById('participantsList');
    const chip = document.createElement('div');
    chip.className = 'participant-chip';
    chip.innerHTML = `
        <input type="text" placeholder="Name" />
        <input type="text" placeholder="Role" />
        <button class="btn-icon-small" onclick="removeParticipant(this)">âœ•</button>
    `;
    list.appendChild(chip);
}

function removeParticipant(btn) {
    btn.parentElement.remove();
}

function addScorecardRow() {
    const tbody = document.getElementById('scorecardTableBody');
    const row = tbody.insertRow();
    row.innerHTML = `
        <td><input type="checkbox" /></td>
        <td><input type="text" placeholder="Measurable name" /></td>
        <td><input type="text" placeholder="Owner" /></td>
        <td><input type="text" placeholder="Goal" /></td>
        <td>
            <select>
                <option value="revenue">Revenue</option>
                <option value="sales">Sales</option>
                <option value="marketing">Marketing</option>
                <option value="operations">Operations</option>
                <option value="people">People</option>
                <option value="financial">Financial</option>
            </select>
        </td>
        <td><input type="text" placeholder="Why it matters" /></td>
        <td>
            <button class="btn-icon" onclick="deleteRow(this)">ðŸ—‘ï¸</button>
        </td>
    `;
}

function deleteRow(btn) {
    if (confirm('Delete this row?')) {
        btn.closest('tr').remove();
    }
}

function addRock() {
    const statement = document.getElementById('rockStatement').value;
    const owner = document.getElementById('rockOwner').value;
    const quarter = document.getElementById('rockQuarter').value;
    
    if (!statement || !owner) {
        alert('Please fill in rock statement and owner');
        return;
    }
    
    const rocksList = document.getElementById('rocksList');
    const rockItem = document.createElement('div');
    rockItem.className = 'rock-item';
    rockItem.innerHTML = `
        <div class="rock-header">
            <span class="rock-status status-on-track">âœ… On Track</span>
            <button class="btn-icon" onclick="toggleRockStatus(this)">â†”ï¸</button>
            <button class="btn-icon" onclick="editRock(this)">âœï¸</button>
            <button class="btn-icon" onclick="deleteRock(this)">ðŸ—‘ï¸</button>
        </div>
        <div class="rock-content">
            <div class="rock-statement">${statement}</div>
            <div class="rock-meta">
                <span class="rock-owner">ðŸ‘¤ ${owner}</span>
                <span class="rock-quarter">ðŸ“… ${quarter}</span>
                <span class="rock-due">â° ${document.getElementById('rockDueDate').value}</span>
            </div>
        </div>
        <div class="rock-progress">
            <div class="progress-bar">
                <div class="progress-fill" style="width: 0%;"></div>
            </div>
            <span class="progress-text">0% complete</span>
        </div>
    `;
    
    rocksList.appendChild(rockItem);
    
    // Clear form
    document.getElementById('rockStatement').value = '';
}

function toggleRockStatus(btn) {
    const status = btn.previousElementSibling;
    if (status.classList.contains('status-on-track')) {
        status.classList.remove('status-on-track');
        status.classList.add('status-off-track');
        status.innerHTML = 'âŒ Off Track';
    } else {
        status.classList.remove('status-off-track');
        status.classList.add('status-on-track');
        status.innerHTML = 'âœ… On Track';
    }
}

// Data persistence helpers
function getIdsData() {
    // Collect IDS data from DOM
    const rows = document.querySelectorAll('.ids-row');
    return Array.from(rows).map(row => ({
        category: row.dataset.category,
        status: row.dataset.status,
        // ... collect other data
    }));
}

function getL10Data() {
    // Collect L10 setup data from DOM
    return {
        day: document.getElementById('l10Day')?.value,
        startTime: document.getElementById('l10StartTime')?.value,
        // ... collect other data
    };
}

function saveIdsData() {
    const data = getIdsData();
    localStorage.setItem('bearops_ids_data', JSON.stringify(data));
}

function saveL10Data() {
    const data = getL10Data();
    localStorage.setItem('bearops_l10_data', JSON.stringify(data));
}

// Initialize on load
document.addEventListener('DOMContentLoaded', function() {
    updateIdsMetrics();
    
    // Load saved data if exists
    const savedIds = localStorage.getItem('bearops_ids_data');
    if (savedIds) {
        // Restore IDS data
    }
    
    const savedL10 = localStorage.getItem('bearops_l10_data');
    if (savedL10) {
        // Restore L10 data
    }
});
    </script>
<script>
// ==========================================
// ISSUES LIST â€“ DATA MODEL & FUNCTIONS
// (Tab: issues â€“ People & Accountability)
// ==========================================
const ISSUES_STORAGE_KEY = 'component3_peopleIssues_v1';
let issuesState = [];

// Load from localStorage
function loadIssuesFromStorage() {
    try {
        const raw = localStorage.getItem(ISSUES_STORAGE_KEY);
        issuesState = raw ? JSON.parse(raw) : [];
        if (!Array.isArray(issuesState)) issuesState = [];
    } catch (e) {
        console.warn('Failed to parse issues from storage', e);
        issuesState = [];
    }
}

// Save to localStorage
function saveIssuesToStorage() {
    try {
        localStorage.setItem(ISSUES_STORAGE_KEY, JSON.stringify(issuesState));
    } catch (e) {
        console.warn('Failed to save issues to storage', e);
    }
}

// Render into <ul id="issuesList">
function renderIssuesList() {
    const listEl = document.getElementById('issuesList');
    if (!listEl) return;

    listEl.innerHTML = '';

    if (!issuesState.length) {
        const emptyLi = document.createElement('li');
        emptyLi.className = 'issues-empty';
        emptyLi.textContent = 'No people / accountability issues captured yet. Add your first issue on the left.';
        listEl.appendChild(emptyLi);
        return;
    }

    const severityLabels = { low: 'Low', medium: 'Medium', high: 'High' };
    const statusLabels = {
        identified: 'Identified',
        inProgress: 'In Progress',
        solved: 'Solved',
        backlog: 'Backlog'
    };

    issuesState.forEach(issue => {
        const li = document.createElement('li');
        li.className = 'issue-item';

        li.innerHTML = `
            <div class="issue-item-main">
                <div class="issue-title-row">
                    <strong>${issue.title || '(Untitled issue)'}</strong>
                    <span class="status-badge status-${issue.status || 'identified'}">
                        ${statusLabels[issue.status] || 'Identified'}
                    </span>
                </div>
                ${issue.detail ? `<p class="issue-detail">${issue.detail}</p>` : ''}
                <div class="issue-meta-row">
                    ${issue.owner ? `<span>Owner: ${issue.owner}</span>` : ''}
                    ${issue.severity ? `<span>Severity: ${severityLabels[issue.severity] || issue.severity}</span>` : ''}
                    ${issue.horizon ? `<span>Horizon: ${issue.horizon}</span>` : ''}
                    ${issue.source ? `<span>Source: ${issue.source}</span>` : ''}
                </div>
            </div>
            <div class="issue-actions">
                <button class="btn btn-secondary btn-compact" onclick="deletePeopleIssue('${issue.id}')">
                    âœ• Delete
                </button>
            </div>
        `;

        listEl.appendChild(li);
    });
}

// Called by your "âž• Add Issue" button (onclick="addIssue()")
function addIssue() {
    const titleEl = document.getElementById('issueTitle');
    const detailEl = document.getElementById('issueDetail');
    const ownerEl = document.getElementById('issueOwner');
    const severityEl = document.getElementById('issueSeverity');
    const horizonEl = document.getElementById('issueHorizon');
    const sourceEl = document.getElementById('issueSource');
    const statusEl = document.getElementById('issueStatus');

    if (!titleEl) return; // defensive

    const title = (titleEl.value || '').trim();
    if (!title) {
        alert('Please add an issue title before saving.');
        titleEl.focus();
        return;
    }

    const issue = {
        id: 'iss_' + Date.now() + '_' + Math.random().toString(36).slice(2, 7),
        title,
        detail: (detailEl?.value || '').trim(),
        owner: (ownerEl?.value || '').trim(),
        severity: severityEl?.value || 'medium',
        horizon: (horizonEl?.value || '').trim(),
        source: (sourceEl?.value || '').trim(),
        status: statusEl?.value || 'identified',
        createdAt: new Date().toISOString()
    };

    // newest first
    issuesState.unshift(issue);
    saveIssuesToStorage();
    renderIssuesList();

    // Clear form (but leave owner if you like â€“ easy to tweak)
    titleEl.value = '';
    if (detailEl) detailEl.value = '';
    if (horizonEl) horizonEl.value = '';
    if (sourceEl) sourceEl.value = '';
    if (severityEl) severityEl.value = 'medium';
    if (statusEl) statusEl.value = 'identified';
}

// Delete a single issue (wired from the Delete button above)
function deletePeopleIssue(issueId) {
    issuesState = issuesState.filter(i => i.id !== issueId);
    saveIssuesToStorage();
    renderIssuesList();
}

// Called by your "ðŸ“‹ Copy Issues List" button (onclick="copyIssuesToClipboard()")
function copyIssuesToClipboard() {
    if (!issuesState.length) {
        alert('No issues to copy yet.');
        return;
    }

    const lines = issuesState.map((iss, idx) => {
        const owner = iss.owner || 'TBC';
        const severity = iss.severity || 'n/a';
        const status = iss.status || 'identified';
        const detail = iss.detail ? ` â€“ ${iss.detail}` : '';
        return `${idx + 1}. ${iss.title} [Owner: ${owner} Â· Severity: ${severity} Â· Status: ${status}]${detail}`;
    });

    const text = lines.join('\n');

    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text)
            .then(() => alert('Issues list copied to clipboard.'))
            .catch(err => {
                console.error('Clipboard error', err);
                alert('Could not copy to clipboard in this browser.');
            });
    } else {
        // Fallback: basic prompt
        window.prompt('Copy the issues list below:', text);
    }
}

// Initialise Issues tab on load
document.addEventListener('DOMContentLoaded', function () {
    loadIssuesFromStorage();
    renderIssuesList();
});
</script>
<script>
// ===================================================
// ISSUES COCKPIT â€“ DATA MODEL, STORAGE & UI BEHAVIOUR
// ===================================================

const ISSUES_STORAGE_KEY = 'component3_peopleIssues_v2';
let issuesData = [];
let dragSourceIssueId = null;

// -------- Storage helpers --------
function loadIssuesFromStorage() {
    try {
        const raw = localStorage.getItem(ISSUES_STORAGE_KEY);
        const parsed = raw ? JSON.parse(raw) : [];
        issuesData = Array.isArray(parsed) ? parsed : [];
    } catch (e) {
        console.warn('Issues: failed to load from storage', e);
        issuesData = [];
    }
}

function saveIssuesToStorage() {
    try {
        localStorage.setItem(ISSUES_STORAGE_KEY, JSON.stringify(issuesData));
    } catch (e) {
        console.warn('Issues: failed to save to storage', e);
    }
}

// -------- Scoring & flags --------
function getIssuePriorityScore(issue) {
    let severityScore = 0;
    switch (issue.severity) {
        case 'critical': severityScore = 4; break;
        case 'high': severityScore = 3; break;
        case 'medium': severityScore = 2; break;
        case 'low': severityScore = 1; break;
    }

    let timeframeScore = 0;
    switch (issue.timeframe) {
        case 'this_quarter': timeframeScore = 3; break;
        case 'next_quarter': timeframeScore = 2; break;
        case 'backlog': timeframeScore = 1; break;
    }

    return severityScore * 10 + timeframeScore;
}

function getIssueFlags(issue) {
    const flags = [];
    const created = issue.createdAt ? new Date(issue.createdAt) : null;
    const now = new Date();

    if (issue.severity === 'critical' && issue.timeframe === 'this_quarter') {
        flags.push('hot');
    }

    if (created && !isNaN(created.getTime())) {
        const ageDays = Math.floor((now - created) / (1000 * 60 * 60 * 24));
        if (ageDays >= 30) flags.push('aging');
    }

    // crude "looping" heuristic: same title appears > 1 time
    const sameTitleCount = issuesData.filter(i => 
        i.title.trim().toLowerCase() === issue.title.trim().toLowerCase()
    ).length;
    if (sameTitleCount > 1) {
        flags.push('looping');
    }

    return flags;
}

// -------- Auto-seed from other tabs --------
function seedIssuesFromOtherTabsIfEmpty() {
    if (issuesData.length > 0) return;

    const seeds = [];

    // From Pre-Assessment Symptoms
    const preSymptomsEl = document.getElementById('preSymptoms');
    if (preSymptomsEl && preSymptomsEl.value.trim()) {
        const lines = preSymptomsEl.value
            .split(/\r?\n/)
            .map(l => l.trim())
            .filter(l => l.length > 3);

        lines.forEach(line => {
            seeds.push({
                title: line,
                detail: 'Captured from Pre-Assessment: Symptoms & friction.',
                owner: '',
                severity: 'medium',
                timeframe: 'this_quarter',
                source: 'preSymptoms'
            });
        });
    }

    // From RPRS Risks box
    const rprsRisksEl = document.getElementById('rprsRisks');
    if (rprsRisksEl) {
        const raw = rprsRisksEl.innerText || rprsRisksEl.textContent || '';
        const cleaned = raw.replace('Risks / Gaps (example)', '').trim();
        if (cleaned) {
            const fragments = cleaned
                .split(/[.;â€¢\-]/)
                .map(f => f.trim())
                .filter(f => f.length > 3);

            fragments.forEach(f => {
                seeds.push({
                    title: f,
                    detail: 'Captured from RPRS Risks / Gaps summary.',
                    owner: '',
                    severity: 'high',
                    timeframe: 'this_quarter',
                    source: 'rprsRisks'
                });
            });
        }
    }

    if (!seeds.length) return;

    const nowIso = new Date().toISOString();
    seeds.forEach(seed => {
        issuesData.push({
            id: 'seed_' + Date.now() + '_' + Math.random().toString(36).slice(2, 7),
            createdAt: nowIso,
            ...seed
        });
    });

    saveIssuesToStorage();
}

// -------- Core CRUD --------
function addIssue() {
    const titleEl = document.getElementById('issueTitle');
    const detailEl = document.getElementById('issueDetail');
    const ownerEl = document.getElementById('issueOwner');
    const severityEl = document.getElementById('issueSeverity');
    const timeframeEl = document.getElementById('issueTimeframe');

    if (!titleEl) return;

    const title = (titleEl.value || '').trim();
    if (!title) {
        alert('Please add an issue title before saving.');
        titleEl.focus();
        return;
    }

    const issue = {
        id: 'iss_' + Date.now() + '_' + Math.random().toString(36).slice(2, 7),
        title,
        detail: (detailEl?.value || '').trim(),
        owner: (ownerEl?.value || '').trim() || 'Unassigned',
        severity: severityEl?.value || 'medium',
        timeframe: timeframeEl?.value || 'this_quarter',
        source: 'manual',
        createdAt: new Date().toISOString()
    };

    issuesData.unshift(issue);
    saveIssuesToStorage();
    clearIssueForm();
    renderIssuesList();
}

function clearIssueForm() {
    const ids = ['issueTitle','issueDetail','issueOwner'];
    ids.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = '';
    });
    const sev = document.getElementById('issueSeverity');
    if (sev) sev.value = 'medium';
    const tf = document.getElementById('issueTimeframe');
    if (tf) tf.value = 'this_quarter';
}

function deleteIssueById(issueId) {
    issuesData = issuesData.filter(i => i.id !== issueId);
    saveIssuesToStorage();
    renderIssuesList();
}

// -------- Push to IDS --------
function sendIssueToIds(issueId) {
    const issue = issuesData.find(i => i.id === issueId);
    if (!issue) return;

    const table = document.getElementById('idsTable');
    if (!table || !table.tBodies.length) {
        alert('IDS table not found on this page.');
        return;
    }

    const tbody = table.tBodies[0];
    const row = tbody.insertRow(-1);

    // Keep columns consistent with your existing IDS table:
    // [0] checkbox, [1] priority, [2] category, [3] issue, [4] root cause,
    // [5] discuss notes, [6] next actions, [7] owner, [8] due date, [9] status
    row.innerHTML = `
        <td><input type="checkbox" class="ids-select-row" /></td>
        <td contenteditable="true">P3</td>
        <td>
            <select class="ids-category">
                <option value="people" selected>People</option>
                <option value="process">Process</option>
                <option value="accountability">Accountability</option>
                <option value="structure">Structure</option>
                <option value="communication">Communication</option>
                <option value="performance">Performance</option>
                <option value="culture">Culture</option>
            </select>
        </td>
        <td contenteditable="true">${issue.title}</td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true">${issue.owner || ''}</td>
        <td><input type="date" class="ids-due-date" /></td>
        <td>
            <select class="ids-status">
                <option value="identified" selected>Identified</option>
                <option value="discussed">Discussed</option>
                <option value="solved">Solved</option>
            </select>
        </td>
    `;

    alert('Issue pushed into IDS log. You can now work it through IDS.');
}

// -------- Drag & drop ordering --------
function handleIssueDragStart(e) {
    const li = e.currentTarget;
    dragSourceIssueId = li.dataset.issueId;
    e.dataTransfer.effectAllowed = 'move';
}

function handleIssueDragOver(e) {
    e.preventDefault();
    e.dataTransfer.dropEffect = 'move';
}

function handleIssueDrop(e) {
    e.preventDefault();
    const targetLi = e.currentTarget;
    const targetId = targetLi.dataset.issueId;
    if (!dragSourceIssueId || !targetId || dragSourceIssueId === targetId) return;

    const srcIndex = issuesData.findIndex(i => i.id === dragSourceIssueId);
    const tgtIndex = issuesData.findIndex(i => i.id === targetId);
    if (srcIndex === -1 || tgtIndex === -1) return;

    const [moved] = issuesData.splice(srcIndex, 1);
    issuesData.splice(tgtIndex, 0, moved);
    dragSourceIssueId = null;
    saveIssuesToStorage();
    renderIssuesList();
}

// -------- Rendering --------
function renderIssuesList() {
    const listEl = document.getElementById('issuesList');
    if (!listEl) return;

    // Sort by priority score (desc) as default view
    const sorted = [...issuesData].sort(
        (a, b) => getIssuePriorityScore(b) - getIssuePriorityScore(a)
    );

    listEl.innerHTML = '';

    if (!sorted.length) {
        const emptyLi = document.createElement('li');
        emptyLi.className = 'issues-empty';
        emptyLi.textContent = 'No people / accountability issues captured yet. Add 3â€“7 priority issues for this quarter.';
        listEl.appendChild(emptyLi);
        return;
    }

    sorted.forEach(issue => {
        const li = document.createElement('li');
        li.className = 'issue-item';
        li.draggable = true;
        li.dataset.issueId = issue.id;

        const priorityScore = getIssuePriorityScore(issue);
        const flags = getIssueFlags(issue);

        const flagBadges = flags.map(f => {
            if (f === 'hot') return '<span class="tag-chip tag-hot">ðŸ”¥ Hot</span>';
            if (f === 'aging') return '<span class="tag-chip tag-aging">â³ Aging</span>';
            if (f === 'looping') return '<span class="tag-chip tag-looping">â™» Looping</span>';
            return '';
        }).join(' ');

        const severityLabel = issue.severity.charAt(0).toUpperCase() + issue.severity.slice(1);
        let timeframeLabel = issue.timeframe;
        if (issue.timeframe === 'this_quarter') timeframeLabel = 'This Quarter';
        if (issue.timeframe === 'next_quarter') timeframeLabel = 'Next Quarter';
        if (issue.timeframe === 'backlog') timeframeLabel = 'Backlog';

        li.innerHTML = `
            <div class="issue-item-main">
                <div class="issue-title-row">
                    <strong>${issue.title}</strong>
                    <span class="status-badge status-${issue.severity === 'critical' ? 'solved' : issue.severity}">
                        ${severityLabel}
                    </span>
                    <span class="tag-chip">TF: ${timeframeLabel}</span>
                    <span class="tag-chip">Score: ${priorityScore}</span>
                    ${flagBadges}
                </div>
                ${issue.detail ? `<p class="issue-detail">${issue.detail}</p>` : ''}
                <div class="issue-meta-row">
                    <span>Owner: ${issue.owner || 'Unassigned'}</span>
                    ${issue.source ? `<span>Source: ${issue.source}</span>` : ''}
                </div>
            </div>
            <div class="issue-actions">
                <button class="btn btn-secondary btn-compact" onclick="sendIssueToIds('${issue.id}')">âž¡ IDS</button>
                <button class="btn btn-secondary btn-compact" onclick="deleteIssueById('${issue.id}')">âœ•</button>
            </div>
        `;

        li.addEventListener('dragstart', handleIssueDragStart);
        li.addEventListener('dragover', handleIssueDragOver);
        li.addEventListener('drop', handleIssueDrop);

        listEl.appendChild(li);
    });
}

// -------- Clipboard export --------
function copyIssuesToClipboard() {
    if (!issuesData.length) {
        alert('No issues to copy yet.');
        return;
    }

    const lines = issuesData.map((issue, idx) => {
        const severity = issue.severity || 'n/a';
        const timeframe = issue.timeframe || 'n/a';
        const owner = issue.owner || 'TBC';
        const flags = getIssueFlags(issue);
        const flagText = flags.length ? ` [${flags.join(', ')}]` : '';
        const detail = issue.detail ? ` â€“ ${issue.detail}` : '';
        return `${idx + 1}. ${issue.title}${flagText}
Owner: ${owner} | Severity: ${severity} | Timeframe: ${timeframe}${detail}`;
    });

    const text = lines.join('\n\n');

    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text)
            .then(() => alert('Issues list copied to clipboard.'))
            .catch(err => {
                console.error('Clipboard error', err);
                alert('Could not copy to clipboard in this browser.');
            });
    } else {
        window.prompt('Copy the issues list below:', text);
    }
}

// -------- Initialise on page load --------
document.addEventListener('DOMContentLoaded', function () {
    loadIssuesFromStorage();
    seedIssuesFromOtherTabsIfEmpty();
    renderIssuesList();
});
</script>
 AI Coach: Baseline Narrative from Pre-Assessment 
</body>
</html>
