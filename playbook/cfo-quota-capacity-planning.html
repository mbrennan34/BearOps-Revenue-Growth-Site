<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Revenue Planning Framework | 6-Week Process</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700;800&family=IBM+Plex+Mono:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0A0E1A;
            --bg-secondary: #111827;
            --bg-card: #1E293B;
            --accent-primary: #3B82F6;
            --accent-secondary: #8B5CF6;
            --accent-success: #10B981;
            --accent-warning: #F59E0B;
            --accent-danger: #EF4444;
            --text-primary: #F9FAFB;
            --text-secondary: #D1D5DB;
            --text-muted: #9CA3AF;
            --border: #334155;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'DM Sans', sans-serif;
            background: radial-gradient(circle at top, var(--bg-secondary) 0%, var(--bg-primary) 45%, var(--bg-primary) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: repeating-linear-gradient(45deg, transparent, transparent 40px, rgba(59, 130, 246, 0.02) 40px, rgba(59, 130, 246, 0.02) 80px);
            pointer-events: none;
            z-index: 0;
        }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 40px 24px; position: relative; z-index: 1; }
        
        header { text-align: center; padding: 60px 20px 40px; margin-bottom: 60px; }
        .header-badge { display: inline-flex; align-items: center; gap: 10px; padding: 8px 20px; border-radius: 999px; 
                        border: 1px solid rgba(59, 130, 246, 0.4); background: radial-gradient(circle at top left, rgba(59, 130, 246, 0.15), transparent);
                        font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.15em; color: var(--accent-primary); margin-bottom: 20px; font-weight: 600; }
        h1 { font-size: 3.5rem; font-weight: 800; line-height: 1.1; margin-bottom: 24px; 
             background: linear-gradient(135deg, #60A5FA, #A78BFA, #F472B6); -webkit-background-clip: text; 
             -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: -0.02em; }
        .subtitle { font-size: 1.2rem; color: var(--text-secondary); max-width: 900px; margin: 0 auto 40px; font-weight: 400; line-height: 1.7; }
        
        .journey-nav { display: flex; justify-content: center; align-items: center; gap: 0; margin: 50px 0; padding: 8px;
                       background: var(--bg-card); border-radius: 16px; border: 1px solid var(--border); 
                       box-shadow: 0 10px 40px rgba(0,0,0,0.5); flex-wrap: wrap; }
        .journey-step { flex: 1; min-width: 140px; padding: 18px 12px; text-align: center; cursor: pointer; 
                        transition: all 0.3s ease; border-radius: 12px; position: relative; }
        .journey-step::after { content: '‚Üí'; position: absolute; right: -12px; top: 50%; transform: translateY(-50%);
                               color: var(--text-muted); font-weight: 700; font-size: 1.2rem; }
        .journey-step:last-child::after { display: none; }
        .journey-step:hover { background: rgba(59, 130, 246, 0.1); }
        .journey-step.active { background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); }
        .step-number { font-family: 'IBM Plex Mono', monospace; font-weight: 700; font-size: 0.7rem; margin-bottom: 6px; color: var(--text-muted); }
        .journey-step.active .step-number { color: rgba(255, 255, 255, 0.8); }
        .step-title { font-weight: 700; font-size: 0.85rem; color: var(--text-primary); }
        
        .section { display: none; animation: fadeInUp 0.6s ease; }
        .section.active { display: block; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        
        .section-header { text-align: center; margin-bottom: 50px; }
        .week-badge { display: inline-block; padding: 6px 16px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
                      color: white; border-radius: 6px; font-size: 0.85rem; font-weight: 700; text-transform: uppercase; 
                      letter-spacing: 0.1em; margin-bottom: 20px; }
        .section-title { font-size: 2.5rem; font-weight: 800; margin-bottom: 16px; 
                         background: linear-gradient(135deg, #60A5FA, #A78BFA); -webkit-background-clip: text;
                         -webkit-text-fill-color: transparent; background-clip: text; }
        .section-subtitle { font-size: 1.1rem; color: var(--text-secondary); max-width: 800px; margin: 0 auto; line-height: 1.6; }
        
        .card { background: radial-gradient(circle at top left, rgba(59, 130, 246, 0.08), transparent 55%),
                           linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(30, 41, 59, 0.98));
                border: 1px solid var(--border); border-radius: 24px; padding: 40px; margin-bottom: 30px;
                box-shadow: 0 24px 60px rgba(0,0,0,0.5); transition: all 0.3s ease; }
        .card:hover { transform: translateY(-4px); box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6); border-color: var(--accent-primary); }
        .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px;
                       padding-bottom: 20px; border-bottom: 1px solid var(--border); }
        .card-title { font-size: 1.8rem; font-weight: 700; color: var(--text-primary); }
        .card-badge { padding: 6px 14px; background: var(--accent-primary); color: white; border-radius: 6px;
                      font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em;
                      font-family: 'IBM Plex Mono', monospace; }
        
        .info-box { padding: 24px; border-radius: 12px; margin: 24px 0; border-left: 4px solid; }
        .info-box.blue { background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05)); border-left-color: var(--accent-primary); }
        .info-box.warning { background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05)); border-left-color: var(--accent-warning); }
        .info-box.success { background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05)); border-left-color: var(--accent-success); }
        .info-box.red { background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05)); border-left-color: var(--accent-danger); }
        .info-box h4 { font-weight: 700; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; }
        .info-box.blue h4 { color: var(--accent-primary); }
        .info-box.warning h4 { color: var(--accent-warning); }
        .info-box.success h4 { color: var(--accent-success); }
        .info-box.red h4 { color: var(--accent-danger); }
        
        .form-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; margin: 25px 0; }
        .form-group { display: flex; flex-direction: column; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-group label { font-weight: 600; margin-bottom: 10px; color: var(--text-primary); font-size: 0.9rem;
                            text-transform: uppercase; letter-spacing: 0.05em; }
        .form-group input, .form-group select, .form-group textarea {
            padding: 14px 18px; background: var(--bg-secondary); border: 2px solid var(--border); border-radius: 10px;
            color: var(--text-primary); font-family: 'DM Sans', sans-serif; font-size: 1rem; transition: all 0.3s ease; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none; border-color: var(--accent-primary); background: var(--bg-card);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); }
        .form-group textarea { min-height: 120px; resize: vertical; font-family: 'DM Sans', sans-serif; }
        .form-hint { font-size: 0.85rem; color: var(--text-muted); margin-top: 6px; font-style: italic; }
        
        .btn { padding: 16px 32px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
               color: white; border: none; border-radius: 10px; font-weight: 700; font-size: 1rem; cursor: pointer;
               transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 0.05em; font-family: 'DM Sans', sans-serif; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4); }
        .btn:active { transform: translateY(-1px); }
        .btn-secondary { background: var(--bg-secondary); border: 2px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); background: var(--bg-card); }
        
        .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin: 30px 0; }
        .result-box { background: var(--bg-secondary); border: 2px solid var(--border); border-radius: 12px; padding: 24px;
                      text-align: center; transition: all 0.3s ease; }
        .result-box:hover { border-color: var(--accent-primary); transform: translateY(-4px); }
        .result-value { font-size: 2.5rem; font-weight: 800; color: var(--accent-primary); 
                        font-family: 'IBM Plex Mono', monospace; margin-bottom: 10px; }
        .result-label { font-size: 0.9rem; color: var(--text-secondary); text-transform: uppercase; 
                        letter-spacing: 0.05em; font-weight: 600; }
        
        .data-table { width: 100%; border-collapse: collapse; margin: 24px 0; background: var(--bg-secondary); 
                      border-radius: 12px; overflow: hidden; }
        .data-table thead th { background: var(--bg-primary); color: var(--text-primary); padding: 16px; text-align: left;
                               font-weight: 700; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.05em;
                               border-bottom: 2px solid var(--border); }
        .data-table tbody td { padding: 16px; border-bottom: 1px solid var(--border); color: var(--text-primary); }
        .data-table tbody tr:last-child td { border-bottom: none; }
        .data-table tbody tr:hover { background: var(--bg-card); }
        
        .step-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; margin: 30px 0; }
        .step-card { background: var(--bg-secondary); border: 2px solid var(--border); border-radius: 16px; 
                     padding: 30px; transition: all 0.3s ease; cursor: pointer; }
        .step-card:hover { border-color: var(--accent-primary); transform: translateY(-4px); 
                           box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3); }
        .step-card.selected { border-color: var(--accent-primary); background: rgba(59, 130, 246, 0.1); }
        .step-card-title { font-size: 1.4rem; font-weight: 700; margin-bottom: 16px; color: var(--text-primary); }
        .step-card-subtitle { font-size: 0.95rem; color: var(--accent-primary); margin-bottom: 16px; font-weight: 600; }
        .step-card-content { color: var(--text-secondary); line-height: 1.8; font-size: 0.95rem; }
        
        @media (max-width: 1024px) {
            h1 { font-size: 2.5rem; }
            .form-grid { grid-template-columns: 1fr; }
            .journey-nav { flex-direction: column; }
            .journey-step::after { display: none; }
            .step-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-badge"></span> Complete Revenue Planning Framework</div>
            <h1>Baseline ‚Üí Market ‚Üí Capacity ‚Üí Scenarios ‚Üí Validation</h1>
            <p class="subtitle">
                A comprehensive framework that prevents the 91% quota miss problem by validating targets 
                against historical reality, market opportunity, and sales capacity.
            </p>
        </header>
        
        
        <!-- ============================================ -->
        <!-- CFO EXECUTIVE DASHBOARD -->
        <!-- ============================================ -->
        <div class="cfo-dashboard" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(139, 92, 246, 0.15));
                                         border: 2px solid var(--accent-primary); border-radius: 24px; padding: 40px; margin-bottom: 50px;
                                         box-shadow: 0 24px 60px rgba(0,0,0,0.5);">
            <div style="text-align: center; margin-bottom: 32px;">
                <h2 style="font-size: 2rem; font-weight: 800; color: var(--accent-primary); margin-bottom: 12px;">
                    üí∞ CFO Executive Dashboard
                </h2>
                <p style="color: var(--text-secondary);">
                    Live financial summary - updates as you input data across all sections
                </p>
            </div>

            <!-- Data Quality Banner -->
            <div id="dataQualityBanner" style="background: rgba(245, 158, 11, 0.1); border: 2px solid var(--accent-warning);
                                               border-radius: 12px; padding: 20px; margin-bottom: 30px; display: flex;
                                               align-items: center; gap: 16px;">
                <div style="font-size: 2rem;">üìä</div>
                <div style="flex: 1;">
                    <div style="margin-bottom: 8px;">
                        <strong>Data Quality Score:</strong> 
                        <span id="dataQualityScore" style="font-size: 1.5rem; font-weight: 700; color: var(--accent-warning);">0/100</span>
                    </div>
                    <div style="display: flex; gap: 16px; flex-wrap: wrap; font-size: 0.875rem;">
                        <span id="quality-revenue">‚ö™ Historical Revenue: Not Entered</span>
                        <span id="quality-capacity">‚ö™ Capacity Data: Not Entered</span>
                        <span id="quality-market">‚ö™ Market Sizing: Not Entered</span>
                    </div>
                </div>
            </div>

            <!-- Financial Metrics Grid -->
            <div class="results-grid">
                <div class="result-box">
                    <div class="result-value" id="cfo-totalQuota">‚Ç¨0.0M</div>
                    <div class="result-label">Total Annual Quota</div>
                </div>
                <div class="result-box">
                    <div class="result-value" id="cfo-boardTarget">‚Ç¨0.0M</div>
                    <div class="result-label">Board Target</div>
                    <div id="cfo-variance-indicator" style="font-size: 0.75rem; margin-top: 8px; padding: 4px 10px;
                                                            border-radius: 999px; display: inline-block; font-weight: 600;">
                        ‚ö™ Not Set
                    </div>
                </div>
                <div class="result-box">
                    <div class="result-value" id="cfo-totalHeadcount">0</div>
                    <div class="result-label">Required Headcount</div>
                </div>
                <div class="result-box">
                    <div class="result-value" id="cfo-totalComp">‚Ç¨0.0M</div>
                    <div class="result-label">Annual Comp Expense</div>
                    <div id="cfo-comp-indicator" style="font-size: 0.75rem; margin-top: 8px; padding: 4px 10px;
                                                        border-radius: 999px; display: inline-block; font-weight: 600;">
                        ‚ö™ Not Calculated
                    </div>
                </div>
                <div class="result-box">
                    <div class="result-value" id="cfo-cac">‚Ç¨0</div>
                    <div class="result-label">Estimated CAC</div>
                </div>
                <div class="result-box">
                    <div class="result-value" id="cfo-magic">0.00</div>
                    <div class="result-label">Magic Number</div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 24px;">
                <button onclick="recalculateAll()" style="padding: 12px 24px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
                                                          color: white; border: none; border-radius: 8px; font-weight: 700;
                                                          cursor: pointer; font-size: 0.9rem;">
                    üîÑ Recalculate All Metrics
                </button>
            </div>
        </div>
<nav class="journey-nav">
            <div class="journey-step active" onclick="goToStep('historical')">
              
                <div class="step-title">Historical Analysis</div>
            </div>
            <div class="journey-step" onclick="goToStep('icp')">
              
                <div class="step-title">ICP & Market</div>
            </div>
            <div class="journey-step" onclick="goToStep('capacity')">
              
                <div class="step-title">Capacity Planning</div>
            </div>
            <div class="journey-step" onclick="goToStep('scenarios')">
               
                <div class="step-title">Scenarios</div>
            </div>
            <div class="journey-step" onclick="goToStep('validation')">
                
                <div class="step-title">Validation</div>
            </div>
            <div class="journey-step" onclick="goToStep('quotas')">
                <div class="step-number">FINAL</div>
                <div class="step-title">Quotas</div>
            </div>
            <div class="journey-step" onclick="goToStep('compensation')">
                <div class="step-number">COMP</div>
                <div class="step-title">Compensation</div>
            </div>
            <div class="journey-step" onclick="goToStep('cfo-analysis')">
                <div class="step-number">CFO</div>
                <div class="step-title">CFO Analysis</div>
            </div>
        </nav>
        
        <!-- ============================================ -->
        <!-- WEEK 1-2: HISTORICAL PERFORMANCE ANALYSIS -->
        <!-- ============================================ -->
        <section id="historical" class="section active">
            <div class="section-header">
               
                <h2 class="section-title">Historical Performance Analysis</h2>
                <p class="section-subtitle">Understand your baseline reality‚Äîanalyze actual performance, not aspirational targets</p>
            </div>
            
            <div class="info-box warning">
                <h4>‚ö†Ô∏è The Anchoring Bias Problem</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                    Most companies make this mistake: They missed last year's ‚Ç¨15M target and only hit ‚Ç¨12M, 
                    then set next year's target at ‚Ç¨18M (‚Ç¨15M + 20%). This compounds failure. 
                    <strong>Start with ‚Ç¨12M (actual) as your baseline.</strong>
                </p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Revenue Performance Overview</h3>
                    <span class="card-badge">BASELINE</span>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Current Year Actual Revenue (‚Ç¨) *</label>
                        <input type="number" id="currentRevenue" required placeholder="12500000">
                        <div class="form-hint">What you actually closed, not target</div>
                    </div>
                    <div class="form-group">
                        <label>Current Year Revenue Target (‚Ç¨) *</label>
                        <input type="number" id="currentTarget" required placeholder="15000000">
                        <div class="form-hint">What you were supposed to hit</div>
                    </div>
                    <div class="form-group">
                        <label>Previous Year Revenue (‚Ç¨) *</label>
                        <input type="number" id="previousRevenue" required placeholder="10200000">
                        <div class="form-hint">For YoY growth calculation</div>
                    </div>
                    <div class="form-group">
                        <label>Number of Sales Reps</label>
                        <input type="number" id="currentReps" placeholder="12">
                        <div class="form-hint">Total selling capacity</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Current Year Quarterly Breakdown</h3>
                    <span class="card-badge">DETAIL</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 25px;">
                    Enter quarterly revenue to identify seasonal patterns and performance trends.
                </p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Q1 Revenue (‚Ç¨) *</label>
                        <input type="number" id="currentQ1" required placeholder="2800000">
                        <div class="form-hint">Jan-Mar</div>
                    </div>
                    <div class="form-group">
                        <label>Q2 Revenue (‚Ç¨) *</label>
                        <input type="number" id="currentQ2" required placeholder="3000000">
                        <div class="form-hint">Apr-Jun</div>
                    </div>
                    <div class="form-group">
                        <label>Q3 Revenue (‚Ç¨) *</label>
                        <input type="number" id="currentQ3" required placeholder="3100000">
                        <div class="form-hint">Jul-Sep</div>
                    </div>
                    <div class="form-group">
                        <label>Q4 Revenue (‚Ç¨) *</label>
                        <input type="number" id="currentQ4" required placeholder="3600000">
                        <div class="form-hint">Oct-Dec</div>
                    </div>
                </div>
                
                <div class="info-box blue">
                    <h4>üí° Why Quarterly Breakdown Matters</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        Understanding quarterly patterns helps you:
                        <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                            <li>Identify seasonal trends (Q4 often stronger in B2B)</li>
                            <li>Set realistic quarterly targets for next year</li>
                            <li>Plan hiring timing (hire before strong quarters)</li>
                            <li>Avoid setting Q1 too high if historically slow</li>
                        </ul>
                    </p>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Previous Year Quarterly Breakdown</h3>
                    <span class="card-badge">COMPARISON</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 25px;">
                    Enter previous year quarterly revenue for YoY quarter-over-quarter comparison.
                </p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Previous Q1 Revenue (‚Ç¨) *</label>
                        <input type="number" id="prevQ1" required placeholder="2300000">
                        <div class="form-hint">Jan-Mar last year</div>
                    </div>
                    <div class="form-group">
                        <label>Previous Q2 Revenue (‚Ç¨) *</label>
                        <input type="number" id="prevQ2" required placeholder="2450000">
                        <div class="form-hint">Apr-Jun last year</div>
                    </div>
                    <div class="form-group">
                        <label>Previous Q3 Revenue (‚Ç¨) *</label>
                        <input type="number" id="prevQ3" required placeholder="2600000">
                        <div class="form-hint">Jul-Sep last year</div>
                    </div>
                    <div class="form-group">
                        <label>Previous Q4 Revenue (‚Ç¨) *</label>
                        <input type="number" id="prevQ4" required placeholder="2850000">
                        <div class="form-hint">Oct-Dec last year</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Revenue Composition</h3>
                    <span class="card-badge">BREAKDOWN</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 25px;">
                    Break down where revenue came from. This reveals which growth levers are working.
                </p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>New Customer Revenue (‚Ç¨) *</label>
                        <input type="number" id="newCustomerRev" required placeholder="4800000">
                        <div class="form-hint">Brand new logos</div>
                    </div>
                    <div class="form-group">
                        <label>Expansion/Upsell Revenue (‚Ç¨) *</label>
                        <input type="number" id="expansionRev" required placeholder="2100000">
                        <div class="form-hint">Existing customers buying more</div>
                    </div>
                    <div class="form-group">
                        <label>Renewal Revenue (‚Ç¨) *</label>
                        <input type="number" id="renewalRev" required placeholder="5600000">
                        <div class="form-hint">Recurring revenue base</div>
                    </div>
                    <div class="form-group">
                        <label>Churn/Contraction (‚Ç¨) *</label>
                        <input type="number" id="churnAmount" required placeholder="850000">
                        <div class="form-hint">Lost revenue (enter as positive)</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Sales Performance Metrics</h3>
                    <span class="card-badge">CAPACITY</span>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>% of Reps Who Hit Quota *</label>
                        <input type="number" id="quotaAttainmentPct" required placeholder="58" min="0" max="100">
                        <div class="form-hint">Healthy: 70-85%</div>
                    </div>
                    <div class="form-group">
                        <label>Average Deal Size (‚Ç¨)</label>
                        <input type="number" id="histAvgDeal" placeholder="45000">
                    </div>
                    <div class="form-group">
                        <label>Average Sales Cycle (Days)</label>
                        <input type="number" id="histSalesCycle" placeholder="75">
                    </div>
                    <div class="form-group">
                        <label>Overall Win Rate (%)</label>
                        <input type="number" id="histWinRate" placeholder="28" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label>Pipeline Coverage Ratio</label>
                        <input type="number" id="pipelineCoverageHist" placeholder="2.8" step="0.1">
                        <div class="form-hint">Pipeline √∑ Quota (Healthy: 3-4x)</div>
                    </div>
                    <div class="form-group">
                        <label>Net Revenue Retention (%)</label>
                        <input type="number" id="nrr" placeholder="105" min="0">
                        <div class="form-hint">100%+ means expansion > churn</div>
                    </div>
                </div>
                
                <div class="info-box warning">
                    <h4>üö® Red Flags in Performance</h4>
                    <ul style="color: var(--text-secondary); line-height: 1.9; margin-top: 12px; margin-left: 20px;">
                        <li><strong>Quota attainment <70%:</strong> Quotas set too high or enablement problem</li>
                        <li><strong>Pipeline coverage <3x:</strong> Not enough opportunities to hit target</li>
                        <li><strong>Win rate <25%:</strong> Wrong ICP or weak sales process</li>
                        <li><strong>Churn >10% of revenue:</strong> Fix retention before scaling acquisition</li>
                    </ul>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">One-Time Events</h3>
                    <span class="card-badge">ADJUSTMENTS</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 25px;">
                    Identify any one-time events that inflated or deflated results. These should NOT be part of your baseline.
                </p>
                
                <div class="form-group full-width">
                    <label>Positive One-Time Events</label>
                    <textarea id="positiveEvents" placeholder="Example: Large enterprise deal ‚Ç¨500K that won't repeat annually, Product launch spike"></textarea>
                </div>
                
                <div class="form-group full-width">
                    <label>Negative One-Time Events</label>
                    <textarea id="negativeEvents" placeholder="Example: Major customer churned due to M&A (‚Ç¨300K), Sales team turnover affected pipeline"></textarea>
                </div>
            </div>
            
            <button class="btn" onclick="analyzeHistoricalPerformance()" style="width: 100%; padding: 20px; font-size: 1.1rem;">
                üìä Analyze Historical Performance
            </button>
            
            <div id="historicalResults" style="display: none; margin-top: 40px;">
                <div class="card">
                    <h3 style="margin-bottom: 25px; font-weight: 800;">üìä Performance Dashboard</h3>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-value" id="yoyGrowth">0%</div>
                            <div class="result-label">YoY Growth Rate</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="targetAttainment">0%</div>
                            <div class="result-label">Target Attainment</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="revenuePerRep">‚Ç¨0</div>
                            <div class="result-label">Revenue per Rep</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="churnPct">0%</div>
                            <div class="result-label">Churn % of Revenue</div>
                        </div>
                    </div>
                    
                    <div id="compositionTable" style="margin-top: 30px;">
                        <h4 style="margin-bottom: 20px; font-weight: 700;">Revenue Composition</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Amount (‚Ç¨)</th>
                                    <th>% of Total</th>
                                    <th>Health Status</th>
                                </tr>
                            </thead>
                            <tbody id="compositionTableBody"></tbody>
                        </table>
                    </div>
                    
                    <div id="quarterlyAnalysis" style="margin-top: 40px;">
                        <h4 style="margin-bottom: 20px; font-weight: 700;">üìä Quarterly Performance Analysis</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Quarter</th>
                                    <th>Current Year (‚Ç¨)</th>
                                    <th>Previous Year (‚Ç¨)</th>
                                    <th>YoY Growth</th>
                                    <th>% of Annual</th>
                                    <th>Trend</th>
                                </tr>
                            </thead>
                            <tbody id="quarterlyTableBody"></tbody>
                        </table>
                        
                        <div id="seasonalInsights" style="margin-top: 30px;"></div>
                    </div>
                    
                    <div id="historicalInsights" style="margin-top: 30px;"></div>
                    <div id="historicalRecommendations" style="margin-top: 30px;"></div>
                </div>
            </div>
        </section>
        
        <!-- ============================================ -->
        <!-- WEEK 2-3: ICP & MARKET ASSESSMENT -->
        <!-- ============================================ -->
        <section id="icp" class="section">
            <div class="section-header">
               
                <h2 class="section-title">ICP & Market Assessment</h2>
                <p class="section-subtitle">Define who you serve, then size the obtainable market opportunity</p>
            </div>
            
            <div class="info-box blue">
                <h4>üí° Critical Sequencing</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                    <strong>ICP MUST come before TAM/SAM/SOM.</strong> You can't size a market without knowing who you're targeting.  
                    ICP characteristics (especially ACV) are required inputs for accurate market sizing.
                </p>
            </div>
            
            <!-- ICP DEFINITION -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Step 2A: Define Your ICP</h3>
                    <span class="card-badge">CRITICAL</span>
                </div>
                
                <h4 style="margin-bottom: 20px; font-weight: 700;">ICP Overview</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ICP Name/Label *</label>
                        <input type="text" id="icpName" required placeholder="Enterprise B2B SaaS - EMEA">
                    </div>
                    <div class="form-group">
                        <label>Target Industry/Vertical</label>
                        <input type="text" id="icpIndustry" placeholder="Financial Services, Healthcare, SaaS">
                    </div>
                </div>
                
                <h4 style="margin: 30px 0 20px; font-weight: 700;">Firmographics</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Company Size (Employees)</label>
                        <input type="text" id="icpSize" placeholder="100-500 employees">
                    </div>
                    <div class="form-group">
                        <label>Revenue Band</label>
                        <input type="text" id="icpRevenue" placeholder="‚Ç¨10M-‚Ç¨50M">
                    </div>
                    <div class="form-group">
                        <label>Geography</label>
                        <input type="text" id="icpGeo" placeholder="EMEA, North America">
                    </div>
                    <div class="form-group">
                        <label>Company Type</label>
                        <select id="icpType">
                            <option value="">Select type</option>
                            <option value="public">Public</option>
                            <option value="private">Private</option>
                            <option value="pe">PE-backed</option>
                            <option value="vc">VC-backed</option>
                        </select>
                    </div>
                </div>
                
                <h4 style="margin: 30px 0 20px; font-weight: 700;">Buying Center</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Economic Buyer (Role)</label>
                        <input type="text" id="icpBuyer" placeholder="VP Sales, CRO">
                    </div>
                    <div class="form-group">
                        <label>Primary Champion</label>
                        <input type="text" id="icpChampion" placeholder="Sales Operations Manager">
                    </div>
                    <div class="form-group">
                        <label>Committee Size (Typical)</label>
                        <input type="number" id="icpCommittee" placeholder="3-5">
                    </div>
                </div>
                
                <h4 style="margin: 30px 0 20px; font-weight: 700;">Performance Metrics (Critical for TAM)</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Average Contract Value - ACV (‚Ç¨) *</label>
                        <input type="number" id="icpACV" required placeholder="75000">
                        <div class="form-hint">Used in TAM calculation</div>
                    </div>
                    <div class="form-group">
                        <label>Sales Cycle Length (Days) *</label>
                        <input type="number" id="icpCycle" required placeholder="90">
                    </div>
                    <div class="form-group">
                        <label>Win Rate vs ICP (%) *</label>
                        <input type="number" id="icpWinRate" required placeholder="35" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label>Churn Rate (Annual %)</label>
                        <input type="number" id="icpChurn" placeholder="8" min="0" max="100">
                    </div>
                </div>
                
                <button class="btn" onclick="saveICP()">Save ICP Profile</button>
                
                <div id="icpSummary" style="display: none; margin-top: 30px;">
                    <div class="info-box success">
                        <h4>‚úì ICP Saved</h4>
                        <p id="icpSummaryText" style="color: var(--text-secondary);"></p>
                    </div>
                </div>
            </div>
            
            <!-- TAM/SAM/SOM CALCULATION -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Step 2B: Calculate TAM/SAM/SOM</h3>
                    <span class="card-badge">MARKET SIZE</span>
                </div>
                
                <div class="info-box warning">
                    <h4>‚ö†Ô∏è Prerequisite</h4>
                    <p style="color: var(--text-secondary);">
                        You must complete Step 2A (ICP Definition) first. We need your ACV to calculate TAM.
                    </p>
                </div>
                
                <h4 style="margin-bottom: 20px; font-weight: 700;">TAM Calculation (Bottom-Up Method)</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Total ICP-Matching Companies *</label>
                        <input type="number" id="tamCompanies" required placeholder="50000">
                        <div class="form-hint">Companies globally that match your ICP</div>
                    </div>
                    <div class="form-group">
                        <label>Average ACV (‚Ç¨)</label>
                        <input type="number" id="tamACV" readonly placeholder="Auto-filled from ICP">
                        <div class="form-hint">From ICP definition</div>
                    </div>
                </div>
                
                <h4 style="margin: 30px 0 20px; font-weight: 700;">SAM Calculation (Filters)</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Geographic Filter (% of TAM) *</label>
                        <input type="number" id="samGeo" required placeholder="20" min="0" max="100">
                        <div class="form-hint">Example: 20% if focusing on EMEA only</div>
                    </div>
                    <div class="form-group">
                        <label>Product/Solution Fit (% of TAM) *</label>
                        <input type="number" id="samFit" required placeholder="80" min="0" max="100">
                        <div class="form-hint">% you can actually serve</div>
                    </div>
                </div>
                
                <h4 style="margin: 30px 0 20px; font-weight: 700;">SOM Calculation (Realistic Capture)</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Time Horizon (Years) *</label>
                        <input type="number" id="somYears" required placeholder="3" min="1" max="10">
                        <div class="form-hint">Typically 3-5 years</div>
                    </div>
                    <div class="form-group">
                        <label>Market Share Target (% of SAM) *</label>
                        <input type="number" id="somShare" required placeholder="2" min="0.1" max="20" step="0.1">
                        <div class="form-hint">Realistic: 0.5-5% | Aggressive: 5-10%</div>
                    </div>
                </div>
                
                <button class="btn" onclick="calculateMarket()">Calculate Market Opportunity</button>
                
                <div id="marketResults" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 25px; font-weight: 800;">Market Opportunity</h3>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-value" id="tamResult">‚Ç¨0</div>
                            <div class="result-label">TAM (Total Market)</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="samResult">‚Ç¨0</div>
                            <div class="result-label">SAM (Serviceable)</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="somResult">‚Ç¨0</div>
                            <div class="result-label">SOM (Obtainable)</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="annualCeiling">‚Ç¨0</div>
                            <div class="result-label">Annual Quota Ceiling</div>
                        </div>
                    </div>
                    
                    <div id="marketWarnings" style="margin-top: 30px;"></div>
                    
                    <div class="info-box red">
                        <h4>üö® YOUR QUOTA CEILING</h4>
                        <p style="color: var(--text-secondary); line-height: 1.7;">
                            The Annual Quota Ceiling shown above is the MAXIMUM you can set as annual target. 
                            Setting quotas above this means you're targeting market share that doesn't exist 
                            or you can't realistically capture. This will be validated in Week 6.
                        </p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- ============================================ -->
        <!-- WEEK 3-4: SALES CAPACITY PLANNING -->
        <!-- ============================================ -->
        <section id="capacity" class="section">
            <div class="section-header">
               
                <h2 class="section-title">Sales Capacity Planning</h2>
                <p class="section-subtitle">Calculate realistic revenue generation capacity with ramp times and attrition</p>
            </div>
            
            <div class="info-box blue">
                <h4>üìê The Capacity Formula</h4>
                <p style="color: var(--text-secondary); line-height: 1.7; font-family: 'IBM Plex Mono', monospace; font-size: 1rem;">
                    <strong>Sales Capacity = # of Fully Ramped Rep Months √ó Quota per Month</strong>
                </p>
                <p style="color: var(--text-secondary); margin-top: 12px;">
                    Accounts for: (1) Current team, (2) New hires & ramp time, (3) Attrition, (4) Productivity improvements
                </p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Current State Analysis</h3>
                    <span class="card-badge">BASELINE</span>
                </div>
                
                <h4 style="margin-bottom: 20px; font-weight: 700;">Current Team</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Current Sales Reps *</label>
                        <input type="number" id="capacityCurrentReps" required placeholder="12">
                    </div>
                    <div class="form-group">
                        <label>Average Productivity per Rep (‚Ç¨/year) *</label>
                        <input type="number" id="capacityAvgQuota" required placeholder="800000">
                        <div class="form-hint">Use actual, not target quota</div>
                    </div>
                    <div class="form-group">
                        <label>Current Year Revenue (‚Ç¨)</label>
                        <input type="number" id="capacityBaseRevenue" readonly placeholder="Auto-filled">
                        <div class="form-hint">From historical analysis</div>
                    </div>
                    <div class="form-group">
                        <label>Current Capacity (‚Ç¨)</label>
                        <input type="number" id="currentCapacity" readonly placeholder="Auto-calculated">
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">New Hire Planning</h3>
                    <span class="card-badge">GROWTH</span>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>New Hires to Add *</label>
                        <input type="number" id="capacityNewHires" required placeholder="5" min="0">
                    </div>
                    <div class="form-group">
                        <label>Ramp Period (Months) *</label>
                        <input type="number" id="capacityRamp" required placeholder="6" min="3" max="12">
                        <div class="form-hint">SMB: 3-4 | Mid-Market: 6 | Enterprise: 9-12</div>
                    </div>
                    <div class="form-group">
                        <label>When Do They Start?</label>
                        <select id="capacityHiringTiming">
                            <option value="spread">Spread across year</option>
                            <option value="q1">Q1 (Jan-Mar)</option>
                            <option value="q2">Q2 (Apr-Jun)</option>
                            <option value="q3">Q3 (Jul-Sep)</option>
                            <option value="q4">Q4 (Oct-Dec)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Expected Attrition Rate (%) *</label>
                        <input type="number" id="capacityAttrition" required placeholder="12" min="0" max="50">
                        <div class="form-hint">Typical: 10-15%</div>
                    </div>
                    <div class="form-group">
                        <label>Productivity Improvement (%)</label>
                        <input type="number" id="capacityProductivity" placeholder="5" min="0" max="20">
                        <div class="form-hint">From tools/process (3-5% realistic)</div>
                    </div>
                </div>
                
                <button class="btn" onclick="calculateCapacity()">Calculate Annual Capacity</button>
                
                <div id="capacityResults" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 25px; font-weight: 800;">üìä Capacity Analysis</h3>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-value" id="q1Capacity">‚Ç¨0</div>
                            <div class="result-label">Q1 Capacity</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="q2Capacity">‚Ç¨0</div>
                            <div class="result-label">Q2 Capacity</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="q3Capacity">‚Ç¨0</div>
                            <div class="result-label">Q3 Capacity</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="q4Capacity">‚Ç¨0</div>
                            <div class="result-label">Q4 Capacity</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <div class="result-box" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));">
                            <div class="result-value" id="totalAnnualCapacity" style="font-size: 3rem;">‚Ç¨0</div>
                            <div class="result-label">Total Annual Capacity</div>
                        </div>
                    </div>
                    
                    <div id="capacityWarnings" style="margin-top: 30px;"></div>
                </div>
            </div>
            
            <div class="info-box warning">
                <h4>‚ö†Ô∏è The Over-Hiring Trap</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                    Hiring 10 reps in January doesn't give you 10x capacity immediately. With 6-month ramps, 
                    you only get ~5 FREs (Fully Ramped Equivalents) in Year 1. Q4 hires barely impact the year at all.
                </p>
            </div>
        </section>
        
        <!-- ============================================ -->
        <!-- WEEK 4-5: STRATEGIC SCENARIO MODELING -->
        <!-- ============================================ -->
        <section id="scenarios" class="section">
            <div class="section-header">

                <h2 class="section-title">Strategic Scenario Modeling</h2>
                <p class="section-subtitle">Model three scenarios showing trade-offs between growth, investment, and risk</p>
            </div>
            
            <div class="info-box blue">
                <h4>üí° Why Three Scenarios?</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                    Your board/investors want options, not just one plan. Conservative preserves cash, 
                    Moderate balances risk/reward, Aggressive captures market share. Each has different 
                    capacity requirements and investment needs.
                </p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Select Your Growth Scenario</h3>
                    <span class="card-badge">CHOOSE ONE</span>
                </div>
                
                <div class="step-grid">
                    <div class="step-card" onclick="selectScenario('conservative')" id="conservativeCard">
                        <div class="step-card-title" style="color: var(--accent-success);">Conservative</div>
                        <div class="step-card-subtitle">10-15% Growth | Low Risk</div>
                        <div class="step-card-content">
                            <strong>Profile:</strong><br/>
                            ‚Ä¢ Minimal new hires (+1-2 reps)<br/>
                            ‚Ä¢ Low investment (‚Ç¨200-400K)<br/>
                            ‚Ä¢ Cash preservation focus<br/><br/>
                            <strong>Best for:</strong><br/>
                            Cash-constrained, uncertain market, proving model
                        </div>
                    </div>
                    
                    <div class="step-card" onclick="selectScenario('moderate')" id="moderateCard" style="border: 3px solid var(--accent-primary);">
                        <div class="step-card-title" style="color: var(--accent-primary);">Moderate ‚≠ê</div>
                        <div class="step-card-subtitle">25-40% Growth | Balanced</div>
                        <div class="step-card-content">
                            <strong>Profile:</strong><br/>
                            ‚Ä¢ 20-30% headcount increase<br/>
                            ‚Ä¢ Medium investment (‚Ç¨600K-1M)<br/>
                            ‚Ä¢ Balanced risk/reward<br/><br/>
                            <strong>Best for:</strong><br/>
                            PMF validated, healthy metrics, growth capital
                        </div>
                    </div>
                    
                    <div class="step-card" onclick="selectScenario('aggressive')" id="aggressiveCard">
                        <div class="step-card-title" style="color: var(--accent-danger);">Aggressive</div>
                        <div class="step-card-subtitle">60-80% Growth | High Risk</div>
                        <div class="step-card-content">
                            <strong>Profile:</strong><br/>
                            ‚Ä¢ 50%+ headcount increase<br/>
                            ‚Ä¢ High investment (‚Ç¨1.5M-2.5M)<br/>
                            ‚Ä¢ Market share capture<br/><br/>
                            <strong>Best for:</strong><br/>
                            Well-funded, category leader play, land grab
                        </div>
                    </div>
                </div>
                
                <div id="scenarioDetail" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 25px; font-weight: 800;">
                        <span id="selectedScenarioName">Moderate</span> Scenario Analysis
                    </h3>
                    
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-value" id="scenarioGrowth">0%</div>
                            <div class="result-label">Growth Rate</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="scenarioTarget">‚Ç¨0</div>
                            <div class="result-label">Revenue Target</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="scenarioHires">0</div>
                            <div class="result-label">New Hires</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value" id="scenarioInvestment">‚Ç¨0</div>
                            <div class="result-label">Investment Required</div>
                        </div>
                    </div>
                    
                    <div id="scenarioBreakdown" style="margin-top: 30px;">
                        <h4 style="margin-bottom: 20px; font-weight: 700;">Revenue Build-Up</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Amount (‚Ç¨)</th>
                                    <th>% of Target</th>
                                    <th>Assumptions</th>
                                </tr>
                            </thead>
                            <tbody id="scenarioBreakdownBody"></tbody>
                        </table>
                    </div>
                    
                    <div id="scenarioValidation" style="margin-top: 30px;"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Scenario Comparison</h3>
                    <span class="card-badge">SIDE-BY-SIDE</span>
                </div>
                
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Conservative</th>
                            <th>Moderate</th>
                            <th>Aggressive</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Growth Rate</strong></td>
                            <td id="compConGrowth">12%</td>
                            <td id="compModGrowth">32%</td>
                            <td id="compAggGrowth">65%</td>
                        </tr>
                        <tr>
                            <td><strong>Revenue Target</strong></td>
                            <td id="compConRevenue">-</td>
                            <td id="compModRevenue">-</td>
                            <td id="compAggRevenue">-</td>
                        </tr>
                        <tr>
                            <td><strong>New Hires</strong></td>
                            <td id="compConHires">2</td>
                            <td id="compModHires">7-10</td>
                            <td id="compAggHires">15-20</td>
                        </tr>
                        <tr>
                            <td><strong>Investment</strong></td>
                            <td id="compConInvest">‚Ç¨300-400K</td>
                            <td id="compModInvest">‚Ç¨600K-1M</td>
                            <td id="compAggInvest">‚Ç¨1.5M-2.5M</td>
                        </tr>
                        <tr>
                            <td><strong>Risk Level</strong></td>
                            <td><span style="color: var(--accent-success);">‚óè Low</span></td>
                            <td><span style="color: var(--accent-warning);">‚óè Medium</span></td>
                            <td><span style="color: var(--accent-danger);">‚óè High</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- ============================================ -->
        <!-- WEEK 6: VALIDATION & FINAL CHECKS -->
        <!-- ============================================ -->
        <section id="validation" class="section">
            <div class="section-header">
   
                <h2 class="section-title">Five Validation Tests</h2>
                <p class="section-subtitle">ALL tests must pass before setting quotas‚Äîthis prevents the 91% quota miss problem</p>
            </div>
            
            <div class="info-box red">
                <h4>üö® Critical: Do Not Skip Validation</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                    91% of organizations missed quota in 2024. The primary cause? Setting targets without 
                    validating against market opportunity, capacity, pipeline generation, cash runway, and 
                    execution capability. These five tests prevent that failure.
                </p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Validation Inputs</h3>
                    <span class="card-badge">REQUIRED</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 25px;">
                    Most values auto-populate from previous steps. Verify they're correct before running tests.
                </p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Revenue Target (‚Ç¨) *</label>
                        <input type="number" id="valTarget" placeholder="Auto-filled from scenario">
                        <div class="form-hint">From Week 4-5: Scenario selection</div>
                    </div>
                    <div class="form-group">
                        <label>Annual SOM Ceiling (‚Ç¨) *</label>
                        <input type="number" id="valSOM" placeholder="Auto-filled from market">
                        <div class="form-hint">From Week 2-3: Your market ceiling</div>
                    </div>
                    <div class="form-group">
                        <label>Total Annual Capacity (‚Ç¨) *</label>
                        <input type="number" id="valCapacity" placeholder="Auto-filled from capacity">
                        <div class="form-hint">From Week 3-4: Sales capacity</div>
                    </div>
                    <div class="form-group">
                        <label>Expected Attainment (%) *</label>
                        <input type="number" id="valAttainment" value="75" min="50" max="100">
                        <div class="form-hint">Realistic: 70-85%</div>
                    </div>
                </div>
            </div>
            
            <button class="btn" onclick="runAllValidationTests()" style="width: 100%; padding: 20px; font-size: 1.1rem; margin-bottom: 30px;">
                üöÄ Run All Five Validation Tests
            </button>
            
            <div id="validationResults" style="display: none;">
                <div class="card">
                    <h3 style="margin-bottom: 25px; font-weight: 800;">
                        Validation Test Results: <span id="testsPassedCount">0</span>/5 Passed
                    </h3>
                    
                    <div id="test1Result"></div>
                    <div id="test2Result"></div>
                    <div id="test3Result"></div>
                    <div id="test4Result"></div>
                    <div id="test5Result"></div>
                    
                    <div id="finalValidation" style="margin-top: 40px;"></div>
                </div>
            </div>
        </section>
        
        <!-- ============================================ -->
        <!-- FINAL: QUOTA SETTING -->
        <!-- ============================================ -->
        <section id="quotas" class="section">
            <div class="section-header">
                <span class="week-badge">FINAL STEP</span>
                <h2 class="section-title">Set Quotas</h2>
                <p class="section-subtitle">Only proceed if validation tests passed‚Äîgrounded quotas = achievable targets</p>
            </div>
            
            <div id="quotaGate" style="display: none;">
                <div class="info-box red">
                    <h4>üö® QUOTA SETTING BLOCKED</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        You cannot set quotas until validation tests pass.<br/><br/>
                        <strong>Return to Week 6 (Validation)</strong> and address the failing tests by:
                        <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                            <li>Reducing your revenue target, OR</li>
                            <li>Expanding your ICP to increase market size, OR</li>
                            <li>Increasing capacity through additional hiring</li>
                        </ul>
                    </p>
                </div>
            </div>
            
            <div id="quotaCalculator">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Quota Calculator</h3>
                        <span class="card-badge">FINAL OUTPUT</span>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Revenue Target (‚Ç¨) *</label>
                            <input type="number" id="quotaTarget" required placeholder="From validated scenario">
                        </div>
                        <div class="form-group">
                            <label>Number of Reps *</label>
                            <input type="number" id="quotaReps" required placeholder="Total sales team">
                        </div>
                        <div class="form-group">
                            <label>Expected Attainment (%) *</label>
                            <input type="number" id="quotaAttainment" value="75" min="50" max="100">
                        </div>
                    </div>
                    
                    <h4 style="margin: 30px 0 20px; font-weight: 700;">Territory Segmentation (Optional)</h4>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">
                        Adjust quotas by ICP density. High ICP territories get higher quotas due to better win rates and shorter cycles.
                    </p>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Tier 1 Territories (High ICP 75%+)</label>
                            <input type="number" id="tier1Count" placeholder="0" min="0">
                            <div class="form-hint">120% of base quota</div>
                        </div>
                        <div class="form-group">
                            <label>Tier 2 Territories (Medium ICP 40-75%)</label>
                            <input type="number" id="tier2Count" placeholder="0" min="0">
                            <div class="form-hint">100% of base quota</div>
                        </div>
                        <div class="form-group">
                            <label>Tier 3 Territories (Low ICP <40%)</label>
                            <input type="number" id="tier3Count" placeholder="0" min="0">
                            <div class="form-hint">80% of base quota</div>
                        </div>
                    </div>
                    
                    <button class="btn" onclick="calculateQuotas()">Calculate Quotas</button>
                    
                    <div id="quotaResults" style="display: none; margin-top: 40px;">
                        <h3 style="margin-bottom: 25px; font-weight: 800;">üìä Quota Assignments</h3>
                        
                        <div class="results-grid">
                            <div class="result-box">
                                <div class="result-value" id="baseQuota">‚Ç¨0</div>
                                <div class="result-label">Base Quota per Rep</div>
                            </div>
                            <div class="result-box">
                                <div class="result-value" id="dealsNeeded">0</div>
                                <div class="result-label">Deals Required (Avg)</div>
                            </div>
                            <div class="result-box">
                                <div class="result-value" id="pipelineNeeded">‚Ç¨0</div>
                                <div class="result-label">Pipeline per Rep (3x)</div>
                            </div>
                            <div class="result-box">
                                <div class="result-value" id="overAssignment">0%</div>
                                <div class="result-label">Over-Assignment</div>
                            </div>
                        </div>
                        
                        <div id="territoryQuotas" style="display: none; margin-top: 30px;">
                            <h4 style="margin-bottom: 20px; font-weight: 700;">Territory-Specific Quotas</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Tier</th>
                                        <th>ICP Density</th>
                                        <th>Count</th>
                                        <th>Quota per Rep</th>
                                        <th>Deals Required</th>
                                        <th>Total Revenue</th>
                                    </tr>
                                </thead>
                                <tbody id="territoryTableBody"></tbody>
                            </table>
                        </div>
                        
                        <div id="quotaFinalSummary" style="margin-top: 30px;"></div>
                    </div>
                </div>
                
                <div class="info-box success">
                    <h4>üéâ Congratulations!</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        You've completed the comprehensive 6-week revenue planning process. Your quotas are 
                        now grounded in historical reality, validated against market opportunity, supported 
                        by sales capacity, and stress-tested through scenario modeling.
                        <br/><br/>
                        <strong>Next steps:</strong> Present scenarios to leadership, cascade goals to teams, 
                        build territory assignments, and launch your most achievable year yet.
                    </p>
                </div>
            </div>
        </section>
        
        <!-- ============================================ -->
        <!-- COMPENSATION MODELS -->
        <!-- ============================================ -->
        <section id="compensation" class="section">
            <div class="section-header">
                <span class="week-badge">COMPENSATION</span>
                <h2 class="section-title">Sales Compensation Models</h2>
                <p class="section-subtitle">Design compensation plans that drive the right behaviors and align with your quotas</p>
            </div>
            
            <div class="info-box blue">
                <h4>üí° Why Compensation Design Matters</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                    Your compensation plan is how you translate quotas into actual pay. A well-designed plan:
                    <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                        <li><strong>Motivates performance:</strong> Clear line of sight from effort to earnings</li>
                        <li><strong>Attracts talent:</strong> Competitive OTE (On-Target Earnings) for your market</li>
                        <li><strong>Manages risk:</strong> Balanced base/variable protects cash flow</li>
                        <li><strong>Drives behavior:</strong> Accelerators reward over-performance, decelerators penalize under-performance</li>
                    </ul>
                </p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Compensation Plan Builder</h3>
                    <span class="card-badge">CONFIGURE</span>
                </div>
                
                <h4 style="margin-bottom: 20px; font-weight: 700;">Role & Quota Information</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Role/Title *</label>
                        <input type="text" id="compRole" required placeholder="Account Executive">
                    </div>
                    <div class="form-group">
                        <label>Annual Quota (‚Ç¨) *</label>
                        <input type="number" id="compQuota" required placeholder="800000">
                        <div class="form-hint">From quota setting step</div>
                    </div>
                    <div class="form-group">
                        <label>Base Salary (‚Ç¨) *</label>
                        <input type="number" id="compBase" required placeholder="60000">
                        <div class="form-hint">Fixed annual salary</div>
                    </div>
                    <div class="form-group">
                        <label>Variable/Commission (‚Ç¨) *</label>
                        <input type="number" id="compVariable" required placeholder="60000">
                        <div class="form-hint">At-target commission (100% quota)</div>
                    </div>
                </div>
                
                <div class="info-box warning">
                    <h4>üí∞ Market Benchmarks for OTE</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        <strong>SMB AE:</strong> ‚Ç¨60-90K OTE (50/50 split)<br/>
                        <strong>Mid-Market AE:</strong> ‚Ç¨90-140K OTE (50/50 to 60/40 split)<br/>
                        <strong>Enterprise AE:</strong> ‚Ç¨140-200K+ OTE (60/40 to 70/30 split)<br/>
                        <strong>SDR/BDR:</strong> ‚Ç¨40-60K OTE (60/40 to 70/30 split)
                    </p>
                </div>
                
                <h4 style="margin: 30px 0 20px; font-weight: 700;">Commission Structure</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Commission Type *</label>
                        <select id="compType" onchange="updateCommissionType()">
                            <option value="flat">Flat Rate (Same % all revenue)</option>
                            <option value="tiered">Tiered (Accelerators at thresholds)</option>
                            <option value="cliff">Cliff (Nothing until threshold)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Payment Frequency *</label>
                        <select id="compFrequency">
                            <option value="monthly">Monthly</option>
                            <option value="quarterly">Quarterly</option>
                            <option value="annually">Annually (not recommended)</option>
                        </select>
                        <div class="form-hint">Monthly keeps motivation high</div>
                    </div>
                </div>
                
                <div id="flatRateConfig" style="display: none;">
                    <h4 style="margin: 30px 0 20px; font-weight: 700;">Flat Rate Configuration</h4>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Commission Rate (%)</label>
                            <input type="number" id="flatRate" placeholder="7.5" step="0.1" min="0" max="20">
                            <div class="form-hint">% of revenue as commission</div>
                        </div>
                    </div>
                    
                    <div class="info-box blue">
                        <h4>üìò Flat Rate Model</h4>
                        <p style="color: var(--text-secondary);">
                            <strong>How it works:</strong> Same commission rate on every euro closed.<br/>
                            <strong>Pros:</strong> Simple to understand and administer<br/>
                            <strong>Cons:</strong> No accelerators to reward over-performance<br/>
                            <strong>Best for:</strong> SDRs, simple transactional sales
                        </p>
                    </div>
                </div>
                
                <div id="tieredConfig" style="display: none;">
                    <h4 style="margin: 30px 0 20px; font-weight: 700;">Tiered Configuration</h4>
                    
                    <div class="info-box blue">
                        <h4>üìò Tiered Model</h4>
                        <p style="color: var(--text-secondary);">
                            <strong>How it works:</strong> Commission rate increases at performance thresholds.<br/>
                            <strong>Pros:</strong> Motivates over-performance, rewards top performers<br/>
                            <strong>Cons:</strong> More complex to track and calculate<br/>
                            <strong>Best for:</strong> AEs, complex sales roles
                        </p>
                    </div>
                    
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">
                        Define commission rates at different attainment levels. Typical structure:
                    </p>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Tier</th>
                                <th>Attainment Range</th>
                                <th>Commission Rate (%)</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Below Threshold</strong></td>
                                <td>0-50%</td>
                                <td><input type="number" id="tier1Rate" placeholder="0" step="0.1" style="width: 80px; padding: 4px;"> %</td>
                                <td style="color: var(--accent-danger);">No commission (or reduced)</td>
                            </tr>
                            <tr>
                                <td><strong>Base</strong></td>
                                <td>50-100%</td>
                                <td><input type="number" id="tier2Rate" placeholder="7.5" step="0.1" style="width: 80px; padding: 4px;"> %</td>
                                <td>Standard rate</td>
                            </tr>
                            <tr>
                                <td><strong>Accelerator 1</strong></td>
                                <td>100-125%</td>
                                <td><input type="number" id="tier3Rate" placeholder="10" step="0.1" style="width: 80px; padding: 4px;"> %</td>
                                <td style="color: var(--accent-success);">+33% commission rate</td>
                            </tr>
                            <tr>
                                <td><strong>Accelerator 2</strong></td>
                                <td>125%+</td>
                                <td><input type="number" id="tier4Rate" placeholder="12.5" step="0.1" style="width: 80px; padding: 4px;"> %</td>
                                <td style="color: var(--accent-success);">+67% commission rate</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="cliffConfig" style="display: none;">
                    <h4 style="margin: 30px 0 20px; font-weight: 700;">Cliff Configuration</h4>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Threshold (% of Quota)</label>
                            <input type="number" id="cliffThreshold" placeholder="60" min="0" max="100">
                            <div class="form-hint">No commission below this</div>
                        </div>
                        <div class="form-group">
                            <label>Commission Rate Above Threshold (%)</label>
                            <input type="number" id="cliffRate" placeholder="7.5" step="0.1">
                        </div>
                    </div>
                    
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Cliff Model</h4>
                        <p style="color: var(--text-secondary);">
                            <strong>How it works:</strong> No commission until threshold hit, then normal rate.<br/>
                            <strong>Pros:</strong> Prevents paying for poor performance<br/>
                            <strong>Cons:</strong> Demotivating, high risk for reps, can encourage gaming<br/>
                            <strong>Best for:</strong> Only use if you must discourage underperformance<br/>
                            <strong>‚ö†Ô∏è Caution:</strong> Can lead to high turnover and ethical issues
                        </p>
                    </div>
                </div>
                
                <h4 style="margin: 30px 0 20px; font-weight: 700;">Additional Components (Optional)</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Draw Against Commission</label>
                        <select id="compDraw">
                            <option value="none">None</option>
                            <option value="recoverable">Recoverable Draw</option>
                            <option value="non-recoverable">Non-Recoverable Draw</option>
                        </select>
                        <div class="form-hint">Bridge for new hires during ramp</div>
                    </div>
                    <div class="form-group">
                        <label>Draw Amount (‚Ç¨/month)</label>
                        <input type="number" id="drawAmount" placeholder="3000">
                        <div class="form-hint">Monthly draw during ramp period</div>
                    </div>
                    <div class="form-group">
                        <label>Draw Period (Months)</label>
                        <input type="number" id="drawPeriod" placeholder="6">
                        <div class="form-hint">How long draw lasts (typically 3-6 months)</div>
                    </div>
                    <div class="form-group">
                        <label>Quarterly/Annual Bonus (‚Ç¨)</label>
                        <input type="number" id="compBonus" placeholder="10000">
                        <div class="form-hint">Additional discretionary bonus</div>
                    </div>
                </div>
                
                <div class="info-box blue">
                    <h4>üí° Draw vs. Guarantee</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        <strong>Recoverable Draw:</strong> Advance on future commissions. Must be "paid back" from future earnings.<br/>
                        <strong>Non-Recoverable Draw:</strong> Guaranteed minimum during ramp. Not paid back.<br/>
                        <strong>Best Practice:</strong> Non-recoverable draw for 3-6 months protects new hires during ramp.
                    </p>
                </div>
                
                <button class="btn" onclick="calculateCompensation()" style="width: 100%; padding: 20px; font-size: 1.1rem; margin-top: 20px;">
                    üí∞ Calculate Compensation Model
                </button>
                
                <div id="compensationResults" style="display: none; margin-top: 40px;">
                    <div class="card">
                        <h3 style="margin-bottom: 25px; font-weight: 800;">üí∞ Compensation Analysis</h3>
                        
                        <div class="results-grid">
                            <div class="result-box">
                                <div class="result-value" id="oteAmount">‚Ç¨0</div>
                                <div class="result-label">OTE (On-Target Earnings)</div>
                            </div>
                            <div class="result-box">
                                <div class="result-value" id="basePct">0%</div>
                                <div class="result-label">Base as % of OTE</div>
                            </div>
                            <div class="result-box">
                                <div class="result-value" id="commissionPct">0%</div>
                                <div class="result-label">Variable as % of OTE</div>
                            </div>
                            <div class="result-box">
                                <div class="result-value" id="compRatio">0.0</div>
                                <div class="result-label">Variable:Base Ratio</div>
                            </div>
                        </div>
                        
                        <div id="earningsTable" style="margin-top: 30px;">
                            <h4 style="margin-bottom: 20px; font-weight: 700;">üìä Earnings at Different Attainment Levels</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Attainment %</th>
                                        <th>Revenue Closed</th>
                                        <th>Base Salary</th>
                                        <th>Commission</th>
                                        <th>Total Earnings</th>
                                        <th>Effective Rate</th>
                                    </tr>
                                </thead>
                                <tbody id="earningsTableBody"></tbody>
                            </table>
                        </div>
                        
                        <div id="compInsights" style="margin-top: 30px;"></div>
                        
                        <div id="compRecommendations" style="margin-top: 30px;"></div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Compensation Best Practices</h3>
                    <span class="card-badge">GUIDE</span>
                </div>
                
                <div class="step-grid">
                    <div class="step-card">
                        <div class="step-card-title">The Four Ps</div>
                        <div class="step-card-content">
                            <strong>Pay Mix:</strong> Balance base/variable (50/50 to 70/30)<br/>
                            <strong>Performance Measures:</strong> What you measure (revenue, deals, ARR)<br/>
                            <strong>Performance Ranges:</strong> Thresholds and accelerators<br/>
                            <strong>Payout Frequency:</strong> How often (monthly recommended)
                        </div>
                    </div>
                    
                    <div class="step-card">
                        <div class="step-card-title">Accelerators</div>
                        <div class="step-card-content">
                            <strong>Purpose:</strong> Reward over-performance<br/>
                            <strong>Typical:</strong> +25-50% commission rate above 100% quota<br/>
                            <strong>Example:</strong> 7.5% base ‚Üí 10% at 100-125% ‚Üí 12.5% at 125%+<br/>
                            <strong>Effect:</strong> Rep at 150% earns significantly more
                        </div>
                    </div>
                    
                    <div class="step-card">
                        <div class="step-card-title">Decelerators</div>
                        <div class="step-card-content">
                            <strong>Purpose:</strong> Penalize under-performance<br/>
                            <strong>Typical:</strong> Reduced or zero commission below 50-70% quota<br/>
                            <strong>Example:</strong> 0% at 0-50% ‚Üí 5% at 50-100% ‚Üí 7.5% at 100%+<br/>
                            <strong>Caution:</strong> Can be demotivating if too harsh
                        </div>
                    </div>
                    
                    <div class="step-card">
                        <div class="step-card-title">Caps & Kickers</div>
                        <div class="step-card-content">
                            <strong>Caps:</strong> Maximum earnings ceiling (avoid - limits performance)<br/>
                            <strong>Kickers:</strong> Bonus for specific achievements (strategic deals, new products)<br/>
                            <strong>SPIFFs:</strong> Short-term incentives for tactical goals<br/>
                            <strong>Best Practice:</strong> Kickers yes, caps no
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Common Compensation Mistakes</h3>
                    <span class="card-badge">AVOID</span>
                </div>
                
                <div class="info-box red">
                    <h4>üö´ Mistake 1: Too Much Base</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        <strong>Problem:</strong> 80/20 or 70/30 split gives reps little incentive to over-perform.<br/>
                        <strong>Effect:</strong> Comfortable reps hitting 80-90% quota, no drive for 120%+.<br/>
                        <strong>Fix:</strong> 50/50 for most AEs, 60/40 for enterprise with long cycles.
                    </p>
                </div>
                
                <div class="info-box red">
                    <h4>üö´ Mistake 2: No Accelerators</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        <strong>Problem:</strong> Flat commission rate means no extra reward for 120%+ performance.<br/>
                        <strong>Effect:</strong> Top performers leave for companies with accelerators.<br/>
                        <strong>Fix:</strong> Add 25-50% commission increase above 100% quota.
                    </p>
                </div>
                
                <div class="info-box red">
                    <h4>üö´ Mistake 3: Annual Payout Only</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        <strong>Problem:</strong> Waiting 12 months for commission kills motivation.<br/>
                        <strong>Effect:</strong> Reps lose connection between effort and reward.<br/>
                        <strong>Fix:</strong> Pay monthly (or quarterly at minimum).
                    </p>
                </div>
                
                <div class="info-box red">
                    <h4>üö´ Mistake 4: Overly Complex Plans</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        <strong>Problem:</strong> 10+ measures, complex matrices, special rules per product.<br/>
                        <strong>Effect:</strong> Reps can't explain their comp, lose trust, gaming increases.<br/>
                        <strong>Fix:</strong> Keep it simple - primary metric (revenue) + 1-2 modifiers max.
                    </p>
                </div>
                
                <div class="info-box red">
                    <h4>üö´ Mistake 5: Caps on Earnings</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        <strong>Problem:</strong> "You can't earn more than ‚Ç¨200K even at 200% quota"<br/>
                        <strong>Effect:</strong> Reps stop selling once they hit cap (sandbagging).<br/>
                        <strong>Fix:</strong> Never cap earnings. If someone earns ‚Ç¨300K, celebrate them.
                    </p>
                </div>
            </div>
        </section>
        
        <!-- ============================================ -->
        <!-- CFO ANALYSIS SECTION -->
        <!-- ============================================ -->
        <section id="cfo-analysis" class="section">
            <div class="section-header">
                <div class="week-badge">CFO ANALYSIS</div>
                <h2 class="section-title">Board Reconciliation & Cash Flow</h2>
                <p class="section-subtitle">Financial validation and cash timing analysis</p>
            </div>
            
            <!-- Board Guidance Reconciliation -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üéØ Board Guidance Reconciliation</h3>
                    <span class="card-badge">CRITICAL</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 25px;">
                    Ensure your bottom-up quotas align with top-down board commitments.
                </p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Annual Board Target (‚Ç¨)</label>
                        <input type="number" id="boardTargetInput" placeholder="13500000" oninput="recalculateAll()">
                        <div class="form-hint">Revenue commitment to board/investors</div>
                    </div>
                    <div class="form-group">
                        <label>Historical Achievement Rate (%)</label>
                        <input type="number" id="achievementRateInput" value="92" min="0" max="200" oninput="recalculateAll()">
                        <div class="form-hint">Average quota attainment from last year</div>
                    </div>
                </div>
                
                <div class="results-grid" style="margin-top: 30px;">
                    <div class="result-box">
                        <div class="result-value" id="board-target-display">‚Ç¨0.0M</div>
                        <div class="result-label">Board Target</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="sum-quotas-display">‚Ç¨0.0M</div>
                        <div class="result-label">Sum of Quotas</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="variance-display">‚Ç¨0.0M</div>
                        <div class="result-label">Variance</div>
                        <div id="variance-status" style="font-size: 0.75rem; margin-top: 8px; padding: 4px 10px;
                                                        border-radius: 999px; display: inline-block; font-weight: 600;">‚Äî</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="projected-revenue-display">‚Ç¨0.0M</div>
                        <div class="result-label">Projected Revenue</div>
                        <div id="revenue-status" style="font-size: 0.75rem; margin-top: 8px; padding: 4px 10px;
                                                     border-radius: 999px; display: inline-block; font-weight: 600;">‚Äî</div>
                    </div>
                </div>
                
                <div class="info-box red" id="guidance-alert" style="display: none; margin-top: 30px;">
                    <h4>üö® Action Required</h4>
                    <p id="guidance-recommendation"></p>
                </div>
            </div>
            
            <!-- Cash Flow Analysis -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üí∞ Cash Collection Timeline</h3>
                    <span class="card-badge">WORKING CAPITAL</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 25px;">
                    Understand the lag between booking and cash collection.
                </p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Payment Terms</label>
                        <select id="paymentTermsInput" onchange="recalculateAll()">
                            <option value="30">Net 30</option>
                            <option value="45">Net 45</option>
                            <option value="60" selected>Net 60</option>
                            <option value="90">Net 90</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Days Sales Outstanding (DSO)</label>
                        <input type="number" id="dsoInput" value="52" min="1" oninput="recalculateAll()">
                        <div class="form-hint">Actual average collection time</div>
                    </div>
                    <div class="form-group">
                        <label>Collection Rate (%)</label>
                        <input type="number" id="collectionRateInput" value="94" min="0" max="100" oninput="recalculateAll()">
                        <div class="form-hint">% collected within terms</div>
                    </div>
                </div>
                
                <div class="results-grid" style="margin-top: 30px;">
                    <div class="result-box">
                        <div class="result-value" id="cash-dso">52</div>
                        <div class="result-label">DSO (Days)</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="cash-cycle">78</div>
                        <div class="result-label">Cash Conversion Cycle</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value" id="working-capital">‚Ç¨0.0M</div>
                        <div class="result-label">Working Capital Need</div>
                    </div>
                </div>
                
                <div class="info-box blue" style="margin-top: 30px;">
                    <h4>üí° Cash Flow Insight</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        There's typically a 60-90 day lag between when a rep gets quota credit (booking) and when you collect cash.
                        <strong>Impact:</strong> You pay commissions in Month 1-2 but collect cash in Month 3-4, requiring working capital
                        to bridge the gap.
                    </p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div style="display: flex; gap: 16px; justify-content: center; margin-top: 40px;">
                <button onclick="savePlan()" class="btn btn-secondary">üíæ Save Plan</button>
                <button onclick="exportToCSV()" class="btn btn-secondary">üìä Export CSV</button>
                <button onclick="window.print()" class="btn btn-secondary">üñ®Ô∏è Print/PDF</button>
            </div>
        </section>

        
    </div>
    
    <script>
        // ============================================
        // GLOBAL DATA STORAGE
        // ============================================
        window.frameworkData = {
            historical: {},
            icp: {},
            market: {},
            capacity: {},
            scenario: {},
            validation: {},
            quotas: {}
        };
        
        // ============================================
        // NAVIGATION
        // ============================================
        function goToStep(stepId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all nav steps
            document.querySelectorAll('.journey-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(stepId);
            if (section) {
                section.classList.add('active');
                console.log('Switched to section:', stepId);
            } else {
                console.error('Section not found:', stepId);
            }
            
            // Highlight nav step - find the one that was clicked
            if (typeof event !== 'undefined' && event) {
                const clickedStep = event.target.closest('.journey-step');
                if (clickedStep) {
                    clickedStep.classList.add('active');
                }
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // ============================================
        // WEEK 1-2: HISTORICAL ANALYSIS
        // ============================================
        function analyzeHistoricalPerformance() {
            const currentRev = parseFloat(document.getElementById('currentRevenue').value) || 0;
            const currentTarget = parseFloat(document.getElementById('currentTarget').value) || 0;
            const previousRev = parseFloat(document.getElementById('previousRevenue').value) || 0;
            const currentReps = parseInt(document.getElementById('currentReps').value) || 1;
            
            const newCustomerRev = parseFloat(document.getElementById('newCustomerRev').value) || 0;
            const expansionRev = parseFloat(document.getElementById('expansionRev').value) || 0;
            const renewalRev = parseFloat(document.getElementById('renewalRev').value) || 0;
            const churnAmount = parseFloat(document.getElementById('churnAmount').value) || 0;
            
            const quotaAttainment = parseFloat(document.getElementById('quotaAttainmentPct').value) || 0;
            
            // Quarterly data
            const currentQ1 = parseFloat(document.getElementById('currentQ1').value) || 0;
            const currentQ2 = parseFloat(document.getElementById('currentQ2').value) || 0;
            const currentQ3 = parseFloat(document.getElementById('currentQ3').value) || 0;
            const currentQ4 = parseFloat(document.getElementById('currentQ4').value) || 0;
            
            const prevQ1 = parseFloat(document.getElementById('prevQ1').value) || 0;
            const prevQ2 = parseFloat(document.getElementById('prevQ2').value) || 0;
            const prevQ3 = parseFloat(document.getElementById('prevQ3').value) || 0;
            const prevQ4 = parseFloat(document.getElementById('prevQ4').value) || 0;
            
            if (currentRev === 0) {
                alert('Please enter current year actual revenue');
                return;
            }
            
            // Annual Calculations
            const yoyGrowth = previousRev > 0 ? ((currentRev - previousRev) / previousRev * 100) : 0;
            const targetAttainment = currentTarget > 0 ? (currentRev / currentTarget * 100) : 0;
            const revenuePerRep = currentRev / currentReps;
            const churnPct = (churnAmount / currentRev * 100);
            
            // Display annual results
            document.getElementById('yoyGrowth').textContent = `${yoyGrowth.toFixed(1)}%`;
            document.getElementById('targetAttainment').textContent = `${targetAttainment.toFixed(1)}%`;
            document.getElementById('revenuePerRep').textContent = `‚Ç¨${Math.round(revenuePerRep).toLocaleString()}`;
            document.getElementById('churnPct').textContent = `${churnPct.toFixed(1)}%`;
            
            // Revenue composition table
            const total = currentRev;
            const compositionData = [
                { name: 'New Customer', amount: newCustomerRev, pct: (newCustomerRev/total*100).toFixed(1), status: newCustomerRev > total * 0.3 ? 'üü¢ Strong' : 'üü° Moderate' },
                { name: 'Expansion', amount: expansionRev, pct: (expansionRev/total*100).toFixed(1), status: expansionRev > total * 0.15 ? 'üü¢ Healthy' : 'üü° Opportunity' },
                { name: 'Renewals', amount: renewalRev, pct: (renewalRev/total*100).toFixed(1), status: renewalRev > total * 0.40 ? 'üü¢ Stable' : 'üü° At Risk' },
                { name: 'Churn', amount: -churnAmount, pct: churnPct.toFixed(1), status: churnPct < 10 ? 'üü¢ Good' : 'üî¥ High' }
            ];
            
            let tableHTML = '';
            compositionData.forEach(row => {
                tableHTML += `
                    <tr>
                        <td><strong>${row.name}</strong></td>
                        <td>‚Ç¨${Math.abs(row.amount).toLocaleString()}</td>
                        <td>${row.pct}%</td>
                        <td>${row.status}</td>
                    </tr>
                `;
            });
            document.getElementById('compositionTableBody').innerHTML = tableHTML;
            
            // Quarterly Analysis
            if (currentQ1 > 0 && currentQ2 > 0 && currentQ3 > 0 && currentQ4 > 0) {
                const quarters = [
                    { name: 'Q1', current: currentQ1, previous: prevQ1 },
                    { name: 'Q2', current: currentQ2, previous: prevQ2 },
                    { name: 'Q3', current: currentQ3, previous: prevQ3 },
                    { name: 'Q4', current: currentQ4, previous: prevQ4 }
                ];
                
                let quarterlyHTML = '';
                let strongestQ = { name: '', pct: 0 };
                let weakestQ = { name: '', pct: 100 };
                
                quarters.forEach(q => {
                    const yoyQGrowth = q.previous > 0 ? ((q.current - q.previous) / q.previous * 100) : 0;
                    const pctOfAnnual = (q.current / currentRev * 100);
                    const trend = yoyQGrowth > 15 ? 'üìà Strong' : yoyQGrowth > 0 ? '‚û°Ô∏è Growing' : 'üìâ Declining';
                    
                    if (pctOfAnnual > strongestQ.pct) {
                        strongestQ = { name: q.name, pct: pctOfAnnual };
                    }
                    if (pctOfAnnual < weakestQ.pct) {
                        weakestQ = { name: q.name, pct: pctOfAnnual };
                    }
                    
                    quarterlyHTML += `
                        <tr>
                            <td><strong>${q.name}</strong></td>
                            <td>‚Ç¨${(q.current/1000000).toFixed(2)}M</td>
                            <td>‚Ç¨${(q.previous/1000000).toFixed(2)}M</td>
                            <td style="color: ${yoyQGrowth > 0 ? 'var(--accent-success)' : 'var(--accent-danger)'};">
                                ${yoyQGrowth > 0 ? '+' : ''}${yoyQGrowth.toFixed(1)}%
                            </td>
                            <td>${pctOfAnnual.toFixed(1)}%</td>
                            <td>${trend}</td>
                        </tr>
                    `;
                });
                
                document.getElementById('quarterlyTableBody').innerHTML = quarterlyHTML;
                
                // Seasonal Insights
                const q4ToQ1Ratio = currentQ4 / currentQ1;
                let seasonalInsights = '<div class="info-box blue"><h4>üìä Seasonal Pattern Analysis</h4>';
                
                seasonalInsights += `<p style="color: var(--text-secondary); line-height: 1.8;">`;
                seasonalInsights += `<strong>Strongest Quarter:</strong> ${strongestQ.name} (${strongestQ.pct.toFixed(1)}% of annual revenue)<br/>`;
                seasonalInsights += `<strong>Weakest Quarter:</strong> ${weakestQ.name} (${weakestQ.pct.toFixed(1)}% of annual revenue)<br/>`;
                seasonalInsights += `<strong>Q4 to Q1 Ratio:</strong> ${q4ToQ1Ratio.toFixed(2)}x `;
                
                if (q4ToQ1Ratio > 1.3) {
                    seasonalInsights += '(Strong Q4 seasonality - typical in enterprise B2B)<br/>';
                } else if (q4ToQ1Ratio < 0.9) {
                    seasonalInsights += '(Unusual - Q1 stronger than Q4)<br/>';
                } else {
                    seasonalInsights += '(Relatively balanced quarters)<br/>';
                }
                
                seasonalInsights += `</p><p style="color: var(--text-secondary); margin-top: 12px; line-height: 1.8;">`;
                seasonalInsights += `<strong>Planning Implications:</strong><br/>`;
                
                if (strongestQ.name === 'Q4') {
                    seasonalInsights += `‚Ä¢ Hire new reps in Q1-Q2 (before Q4 peak) so they're ramped<br/>`;
                    seasonalInsights += `‚Ä¢ Don't set Q1 target too high (${weakestQ.pct.toFixed(0)}% of annual is realistic)<br/>`;
                    seasonalInsights += `‚Ä¢ Expect ${strongestQ.pct.toFixed(0)}% of annual revenue in Q4<br/>`;
                } else {
                    seasonalInsights += `‚Ä¢ Your ${strongestQ.name} peak is unusual for B2B - understand why<br/>`;
                    seasonalInsights += `‚Ä¢ Consider if this pattern is sustainable or one-time<br/>`;
                }
                
                seasonalInsights += `</p></div>`;
                
                document.getElementById('seasonalInsights').innerHTML = seasonalInsights;
            }
            
            // Generate insights
            let insights = '';
            
            if (targetAttainment < 90) {
                insights += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Missed Target</h4>
                        <p style="color: var(--text-secondary);">
                            You achieved ${targetAttainment.toFixed(1)}% of target. 
                            <strong>Start planning from ‚Ç¨${(currentRev/1000000).toFixed(1)}M (actual), 
                            not ‚Ç¨${(currentTarget/1000000).toFixed(1)}M (target).</strong>
                        </p>
                    </div>
                `;
            }
            
            if (quotaAttainment < 70) {
                insights += `
                    <div class="info-box warning">
                        <h4>üö® Low Quota Attainment</h4>
                        <p style="color: var(--text-secondary);">
                            Only ${quotaAttainment}% of reps hit quota (healthy: 70-85%). 
                            This suggests quotas were set too high or there's an enablement issue.
                        </p>
                    </div>
                `;
            }
            
            if (churnPct > 10) {
                insights += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è High Churn</h4>
                        <p style="color: var(--text-secondary);">
                            Churn represents ${churnPct.toFixed(1)}% of revenue. 
                            Investigate root causes before scaling new customer acquisition.
                        </p>
                    </div>
                `;
            }
            
            if (!insights) {
                insights = `
                    <div class="info-box success">
                        <h4>‚úì Healthy Performance</h4>
                        <p style="color: var(--text-secondary);">
                            Your baseline metrics look solid. Good foundation for planning.
                        </p>
                    </div>
                `;
            }
            
            document.getElementById('historicalInsights').innerHTML = insights;
            
            // Recommendations
            let recommendations = `
                <div class="card">
                    <h4 style="margin-bottom: 20px; font-weight: 700;">üìã Recommendations for Planning</h4>
                    <ul style="color: var(--text-secondary); line-height: 1.9; margin-left: 20px;">
                        <li>Your true baseline is <strong>‚Ç¨${(currentRev/1000000).toFixed(1)}M</strong> (actual), not ‚Ç¨${(currentTarget/1000000).toFixed(1)}M (target)</li>
                        <li>Revenue per rep is <strong>‚Ç¨${Math.round(revenuePerRep).toLocaleString()}</strong>‚Äîuse this for capacity planning</li>
                        <li>New customer revenue represents ${(newCustomerRev/total*100).toFixed(1)}% of total</li>
                        ${quotaAttainment < 70 ? '<li><strong>Priority:</strong> Set more realistic quotas (aim for 75-85% attainment)</li>' : ''}
                        ${churnPct > 10 ? '<li><strong>Priority:</strong> Address churn before scaling acquisition</li>' : ''}
            `;
            
            if (currentQ1 > 0 && strongestQ.name) {
                recommendations += `<li><strong>Seasonal pattern:</strong> ${strongestQ.name} is your strongest quarter‚Äîplan hiring and marketing accordingly</li>`;
            }
            
            recommendations += `
                    </ul>
                </div>
            `;
            
            document.getElementById('historicalRecommendations').innerHTML = recommendations;
            
            // Store data
            window.frameworkData.historical = {
                currentRev, currentTarget, previousRev, yoyGrowth, targetAttainment,
                newCustomerRev, expansionRev, renewalRev, churnAmount, revenuePerRep, currentReps,
                quarterly: { currentQ1, currentQ2, currentQ3, currentQ4, prevQ1, prevQ2, prevQ3, prevQ4 }
            };
            
            document.getElementById('historicalResults').style.display = 'block';
            document.getElementById('historicalResults').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // ============================================
        // WEEK 2-3: ICP & MARKET
        // ============================================
        function saveICP() {
            const icpData = {
                name: document.getElementById('icpName').value,
                industry: document.getElementById('icpIndustry').value,
                size: document.getElementById('icpSize').value,
                revenue: document.getElementById('icpRevenue').value,
                geo: document.getElementById('icpGeo').value,
                type: document.getElementById('icpType').value,
                buyer: document.getElementById('icpBuyer').value,
                champion: document.getElementById('icpChampion').value,
                committee: document.getElementById('icpCommittee').value,
                acv: parseFloat(document.getElementById('icpACV').value) || 0,
                cycle: parseInt(document.getElementById('icpCycle').value) || 0,
                winRate: parseFloat(document.getElementById('icpWinRate').value) || 0,
                churn: parseFloat(document.getElementById('icpChurn').value) || 0
            };
            
            if (!icpData.name || icpData.acv === 0) {
                alert('Please fill in ICP Name and ACV at minimum');
                return;
            }
            
            window.frameworkData.icp = icpData;
            
            // Auto-populate TAM ACV field
            document.getElementById('tamACV').value = icpData.acv;
            
            document.getElementById('icpSummaryText').textContent = 
                `ICP "${icpData.name}" saved: ‚Ç¨${icpData.acv.toLocaleString()} ACV, ${icpData.winRate}% win rate, ${icpData.cycle}-day cycle. This ACV will be used for TAM calculation.`;
            
            document.getElementById('icpSummary').style.display = 'block';
            document.getElementById('icpSummary').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function calculateMarket() {
            const companies = parseFloat(document.getElementById('tamCompanies').value) || 0;
            const acv = parseFloat(document.getElementById('tamACV').value) || window.frameworkData.icp?.acv || 0;
            const samGeo = parseFloat(document.getElementById('samGeo').value) / 100 || 0;
            const samFit = parseFloat(document.getElementById('samFit').value) / 100 || 0;
            const somYears = parseInt(document.getElementById('somYears').value) || 3;
            const somShare = parseFloat(document.getElementById('somShare').value) / 100 || 0;
            
            if (companies === 0 || acv === 0) {
                alert('Please complete ICP definition first (need ACV) and enter number of ICP companies');
                return;
            }
            
            // Calculations
            const tam = companies * acv;
            const sam = tam * samGeo * samFit;
            const som = sam * somShare;
            const annualCeiling = som / somYears;
            
            // Display
            document.getElementById('tamResult').textContent = `‚Ç¨${(tam/1000000).toFixed(0)}M`;
            document.getElementById('samResult').textContent = `‚Ç¨${(sam/1000000).toFixed(1)}M`;
            document.getElementById('somResult').textContent = `‚Ç¨${(som/1000000).toFixed(1)}M`;
            document.getElementById('annualCeiling').textContent = `‚Ç¨${(annualCeiling/1000000).toFixed(1)}M`;
            
            // Warnings
            let warnings = '';
            
            if (somShare * 100 > 5) {
                warnings += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Aggressive Market Share</h4>
                        <p style="color: var(--text-secondary);">
                            You're targeting ${(somShare * 100).toFixed(1)}% of SAM. Most companies capture 
                            0.5-5% of SAM. Ensure you have exceptional advantages to justify this.
                        </p>
                    </div>
                `;
            }
            
            if (sam / tam < 0.05) {
                warnings += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Very Narrow SAM</h4>
                        <p style="color: var(--text-secondary);">
                            Your SAM is only ${(sam/tam*100).toFixed(1)}% of TAM. Consider if your filters 
                            are too restrictive or if you should expand ICP.
                        </p>
                    </div>
                `;
            }
            
            document.getElementById('marketWarnings').innerHTML = warnings;
            
            // Store data
            window.frameworkData.market = { tam, sam, som, annualCeiling };
            
            // Auto-populate validation fields
            document.getElementById('valSOM').value = annualCeiling;
            
            document.getElementById('marketResults').style.display = 'block';
            document.getElementById('marketResults').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // ============================================
        // WEEK 3-4: CAPACITY PLANNING
        // ============================================
        function calculateCapacity() {
            const currentReps = parseInt(document.getElementById('capacityCurrentReps').value) || 0;
            const avgQuota = parseFloat(document.getElementById('capacityAvgQuota').value) || 0;
            const newHires = parseInt(document.getElementById('capacityNewHires').value) || 0;
            const rampMonths = parseInt(document.getElementById('capacityRamp').value) || 6;
            const attrition = parseFloat(document.getElementById('capacityAttrition').value) / 100 || 0.12;
            const productivity = parseFloat(document.getElementById('capacityProductivity').value) / 100 || 0;
            
            if (currentReps === 0 || avgQuota === 0) {
                alert('Please enter current reps and average productivity');
                return;
            }
            
            // Auto-fill base revenue from historical
            if (window.frameworkData.historical?.currentRev) {
                document.getElementById('capacityBaseRevenue').value = window.frameworkData.historical.currentRev;
            }
            
            // Current capacity
            const currentCapacity = currentReps * avgQuota;
            document.getElementById('currentCapacity').value = currentCapacity.toFixed(0);
            
            // Simplified capacity calculation by quarter
            const monthlyQuota = avgQuota / 12;
            
            // Q1
            const q1Reps = currentReps;
            const q1NewHiring = Math.ceil(newHires * 0.3); // 30% start in Q1
            const q1NewAtRamp = q1NewHiring * 0.3; // 30% productive on average
            const q1FREs = q1Reps * (1 + productivity) + q1NewAtRamp;
            const q1Capacity = q1FREs * monthlyQuota * 3;
            
            // Q2
            const q2Reps = currentReps + q1NewHiring;
            const q2NewHiring = Math.ceil(newHires * 0.3);
            const q2RampedFromQ1 = q1NewHiring * 0.7;
            const q2NewAtRamp = q2NewHiring * 0.3;
            const q2FREs = (q2Reps - Math.floor(currentReps * attrition * 0.25)) * (1 + productivity) + q2RampedFromQ1 + q2NewAtRamp;
            const q2Capacity = q2FREs * monthlyQuota * 3;
            
            // Q3
            const q3NewHiring = Math.ceil(newHires * 0.2);
            const q3RampedPrevious = q1NewHiring + q2NewHiring * 0.8;
            const q3FREs = (currentReps - Math.floor(currentReps * attrition * 0.5)) * (1 + productivity) + q3RampedPrevious + q3NewHiring * 0.3;
            const q3Capacity = q3FREs * monthlyQuota * 3;
            
            // Q4
            const q4NewHiring = newHires - q1NewHiring - q2NewHiring - q3NewHiring;
            const q4RampedPrevious = q1NewHiring + q2NewHiring + q3NewHiring * 0.8;
            const q4FREs = (currentReps - Math.floor(currentReps * attrition)) * (1 + productivity) + q4RampedPrevious + q4NewHiring * 0.2;
            const q4Capacity = q4FREs * monthlyQuota * 3;
            
            const totalAnnual = q1Capacity + q2Capacity + q3Capacity + q4Capacity;
            
            // Display
            document.getElementById('q1Capacity').textContent = `‚Ç¨${(q1Capacity/1000000).toFixed(1)}M`;
            document.getElementById('q2Capacity').textContent = `‚Ç¨${(q2Capacity/1000000).toFixed(1)}M`;
            document.getElementById('q3Capacity').textContent = `‚Ç¨${(q3Capacity/1000000).toFixed(1)}M`;
            document.getElementById('q4Capacity').textContent = `‚Ç¨${(q4Capacity/1000000).toFixed(1)}M`;
            document.getElementById('totalAnnualCapacity').textContent = `‚Ç¨${(totalAnnual/1000000).toFixed(1)}M`;
            
            // Warnings
            let warnings = '';
            
            if (newHires / currentReps > 0.3) {
                warnings += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Aggressive Hiring</h4>
                        <p style="color: var(--text-secondary);">
                            Hiring ${newHires} reps (+${(newHires/currentReps*100).toFixed(0)}%) risks: 
                            overwhelming management, diluting culture, lower quality hires.
                        </p>
                    </div>
                `;
            }
            
            if (q4NewHiring > newHires * 0.25) {
                warnings += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Q4 Hiring Timing</h4>
                        <p style="color: var(--text-secondary);">
                            ${q4NewHiring} hires starting in Q4 will barely impact Year 1 results. 
                            Consider starting them in Q1 of next year instead.
                        </p>
                    </div>
                `;
            }
            
            document.getElementById('capacityWarnings').innerHTML = warnings;
            
            // Store data
            window.frameworkData.capacity = { totalAnnual, currentReps, avgQuota };
            
            // Auto-populate validation
            document.getElementById('valCapacity').value = totalAnnual;
            
            document.getElementById('capacityResults').style.display = 'block';
            document.getElementById('capacityResults').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // ============================================
        // WEEK 4-5: SCENARIOS
        // ============================================
        function selectScenario(type) {
            const baseRevenue = window.frameworkData.historical?.currentRev || 10000000;
            
            // Remove selected class from all cards
            document.querySelectorAll('.step-card').forEach(card => card.classList.remove('selected'));
            
            let scenario = {};
            
            if (type === 'conservative') {
                scenario = {
                    name: 'Conservative',
                    type: 'conservative',
                    growthRate: 0.12,
                    targetRevenue: baseRevenue * 1.12,
                    newHires: 2,
                    investment: 350000,
                    risk: 'Low'
                };
                document.getElementById('conservativeCard').classList.add('selected');
            } else if (type === 'moderate') {
                scenario = {
                    name: 'Moderate',
                    type: 'moderate',
                    growthRate: 0.32,
                    targetRevenue: baseRevenue * 1.32,
                    newHires: 8,
                    investment: 850000,
                    risk: 'Medium'
                };
                document.getElementById('moderateCard').classList.add('selected');
            } else {
                scenario = {
                    name: 'Aggressive',
                    type: 'aggressive',
                    growthRate: 0.70,
                    targetRevenue: baseRevenue * 1.70,
                    newHires: 18,
                    investment: 2000000,
                    risk: 'High'
                };
                document.getElementById('aggressiveCard').classList.add('selected');
            }
            
            // Display
            document.getElementById('selectedScenarioName').textContent = scenario.name;
            document.getElementById('scenarioGrowth').textContent = `${(scenario.growthRate * 100).toFixed(0)}%`;
            document.getElementById('scenarioTarget').textContent = `‚Ç¨${(scenario.targetRevenue / 1000000).toFixed(1)}M`;
            document.getElementById('scenarioHires').textContent = scenario.newHires;
            document.getElementById('scenarioInvestment').textContent = `‚Ç¨${(scenario.investment / 1000).toFixed(0)}K`;
            
            // Revenue breakdown
            const newRev = scenario.targetRevenue * 0.35;
            const expRev = scenario.targetRevenue * 0.18;
            const renRev = scenario.targetRevenue * 0.47;
            
            const breakdownHTML = `
                <tr>
                    <td><strong>New Customer Acquisition</strong></td>
                    <td>‚Ç¨${(newRev/1000000).toFixed(2)}M</td>
                    <td>35%</td>
                    <td>Based on ${Math.ceil(newRev / (window.frameworkData.icp?.acv || 75000))} new customers</td>
                </tr>
                <tr>
                    <td><strong>Expansion Revenue</strong></td>
                    <td>‚Ç¨${(expRev/1000000).toFixed(2)}M</td>
                    <td>18%</td>
                    <td>Existing customer growth</td>
                </tr>
                <tr>
                    <td><strong>Renewal Revenue</strong></td>
                    <td>‚Ç¨${(renRev/1000000).toFixed(2)}M</td>
                    <td>47%</td>
                    <td>Recurring base with 90% retention</td>
                </tr>
            `;
            document.getElementById('scenarioBreakdownBody').innerHTML = breakdownHTML;
            
            // Capacity check
            const capacity = window.frameworkData.capacity?.totalAnnual || 0;
            let validationHTML = '';
            
            if (capacity > 0) {
                const effectiveCapacity = capacity * 0.75;
                if (effectiveCapacity >= scenario.targetRevenue) {
                    validationHTML = `
                        <div class="info-box success">
                            <h4>‚úì Capacity Supports Target</h4>
                            <p style="color: var(--text-secondary);">
                                Your capacity (‚Ç¨${(effectiveCapacity/1000000).toFixed(1)}M at 75% attainment) 
                                exceeds target (‚Ç¨${(scenario.targetRevenue/1000000).toFixed(1)}M). 
                                This scenario is feasible from a capacity perspective.
                            </p>
                        </div>
                    `;
                } else {
                    validationHTML = `
                        <div class="info-box warning">
                            <h4>‚ö†Ô∏è Capacity Gap</h4>
                            <p style="color: var(--text-secondary);">
                                Target (‚Ç¨${(scenario.targetRevenue/1000000).toFixed(1)}M) exceeds 
                                capacity (‚Ç¨${(effectiveCapacity/1000000).toFixed(1)}M at 75% attainment). 
                                You need to hire more reps or improve productivity.
                            </p>
                        </div>
                    `;
                }
            }
            
            document.getElementById('scenarioValidation').innerHTML = validationHTML;
            
            // Update comparison table
            document.getElementById('compConRevenue').textContent = `‚Ç¨${(baseRevenue * 1.12 / 1000000).toFixed(1)}M`;
            document.getElementById('compModRevenue').textContent = `‚Ç¨${(baseRevenue * 1.32 / 1000000).toFixed(1)}M`;
            document.getElementById('compAggRevenue').textContent = `‚Ç¨${(baseRevenue * 1.70 / 1000000).toFixed(1)}M`;
            
            // Store data
            window.frameworkData.scenario = scenario;
            
            // Auto-populate validation
            document.getElementById('valTarget').value = scenario.targetRevenue;
            document.getElementById('quotaTarget').value = scenario.targetRevenue;
            
            document.getElementById('scenarioDetail').style.display = 'block';
            document.getElementById('scenarioDetail').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // ============================================
        // WEEK 6: VALIDATION
        // ============================================
        function runAllValidationTests() {
            const target = parseFloat(document.getElementById('valTarget').value) || window.frameworkData.scenario?.targetRevenue || 0;
            const som = parseFloat(document.getElementById('valSOM').value) || window.frameworkData.market?.annualCeiling || 0;
            const capacity = parseFloat(document.getElementById('valCapacity').value) || window.frameworkData.capacity?.totalAnnual || 0;
            const attainment = parseFloat(document.getElementById('valAttainment').value) / 100 || 0.75;
            
            if (target === 0 || som === 0 || capacity === 0) {
                alert('‚ö†Ô∏è Please complete Week 2-3 (Market), Week 3-4 (Capacity), and Week 4-5 (Scenario) first!');
                return;
            }
            
            let passed = 0;
            let results = '';
            
            // Test 1: Market Opportunity
            const test1Pass = (target / som) <= 1.0;
            results += `
                <div class="info-box ${test1Pass ? 'success' : 'red'}">
                    <h4>${test1Pass ? '‚úì' : '‚úó'} Test 1: Market Opportunity Test</h4>
                    <p style="color: var(--text-secondary);">
                        Target: ‚Ç¨${(target/1000000).toFixed(1)}M √∑ SOM: ‚Ç¨${(som/1000000).toFixed(1)}M = ${(target/som).toFixed(2)}
                        ${test1Pass ? '<br/><strong>‚úì PASS</strong> - Target within market opportunity' : '<br/><strong>‚úó FAIL</strong> - Target exceeds market opportunity!'}
                    </p>
                </div>
            `;
            if (test1Pass) passed++;
            
            // Test 2: Capacity Coverage
            const effectiveCapacity = capacity * attainment;
            const test2Pass = effectiveCapacity >= target;
            results += `
                <div class="info-box ${test2Pass ? 'success' : 'red'}">
                    <h4>${test2Pass ? '‚úì' : '‚úó'} Test 2: Capacity Coverage Test</h4>
                    <p style="color: var(--text-secondary);">
                        Capacity: ‚Ç¨${(capacity/1000000).toFixed(1)}M √ó ${(attainment*100).toFixed(0)}% = ‚Ç¨${(effectiveCapacity/1000000).toFixed(1)}M
                        ${test2Pass ? '‚â•' : '<'} ‚Ç¨${(target/1000000).toFixed(1)}M
                        ${test2Pass ? '<br/><strong>‚úì PASS</strong> - Sufficient capacity' : '<br/><strong>‚úó FAIL</strong> - Insufficient capacity!'}
                    </p>
                </div>
            `;
            if (test2Pass) passed++;
            
            // Test 3: Pipeline Coverage
            const pipelineNeeded = target * 3.5;
            const test3Pass = test1Pass && test2Pass; // Simplified
            results += `
                <div class="info-box ${test3Pass ? 'success' : 'warning'}">
                    <h4>${test3Pass ? '‚úì' : '‚ö†Ô∏è'} Test 3: Pipeline Coverage Test</h4>
                    <p style="color: var(--text-secondary);">
                        Need ‚Ç¨${(pipelineNeeded/1000000).toFixed(1)}M pipeline (3.5x target).
                        ${test3Pass ? '<br/><strong>‚úì PASS</strong> - Assuming marketing can deliver if Tests 1 & 2 pass' : '<br/><strong>‚ö†Ô∏è WARNING</strong> - Verify with marketing team'}
                    </p>
                </div>
            `;
            if (test3Pass) passed++;
            
            // Test 4: Cash Runway (Manual)
            results += `
                <div class="info-box warning">
                    <h4>‚ö†Ô∏è Test 4: Cash Runway Test</h4>
                    <p style="color: var(--text-secondary);">
                        <strong>Manual check required:</strong> Do you have 18+ months runway for the planned investment?
                        This test must be confirmed with your CFO before proceeding.
                    </p>
                </div>
            `;
            
            // Test 5: Execution Capability (Manual)
            results += `
                <div class="info-box warning">
                    <h4>‚ö†Ô∏è Test 5: Execution Capability Test</h4>
                    <p style="color: var(--text-secondary);">
                        <strong>Manual checks required:</strong><br/>
                        ‚Ä¢ Can you hire the planned number of reps in time?<br/>
                        ‚Ä¢ Manager:rep ratio stays under 1:10?<br/>
                        ‚Ä¢ Systems/tools ready to scale?<br/>
                        ‚Ä¢ Product can handle increased volume?
                    </p>
                </div>
            `;
            
            document.getElementById('validationResults').innerHTML = results;
            document.getElementById('testsPassedCount').textContent = passed;
            
            // Final validation
            let finalHTML = '';
            
            if (passed >= 3) {
                finalHTML = `
                    <div class="info-box success">
                        <h4>‚úì Core Tests Passed (${passed}/3)</h4>
                        <p style="color: var(--text-secondary); line-height: 1.7;">
                            <strong>Your target is validated.</strong> Core quantitative tests pass.
                            Confirm Tests 4 & 5 manually with your leadership team, then proceed to quota setting.
                        </p>
                    </div>
                `;
                window.frameworkData.validation = { passed: true, score: passed };
                document.getElementById('quotaGate').style.display = 'none';
                document.getElementById('quotaCalculator').style.display = 'block';
            } else {
                finalHTML = `
                    <div class="info-box red">
                        <h4>‚úó Validation Failed (${passed}/3 Core Tests)</h4>
                        <p style="color: var(--text-secondary); line-height: 1.7;">
                            <strong>DO NOT PROCEED TO QUOTA SETTING.</strong><br/><br/>
                            You must either:
                        </p>
                        <ul style="margin-left: 20px; margin-top: 10px; line-height: 1.8; color: var(--text-secondary);">
                            <li><strong>Reduce your target</strong> to match capacity/market reality</li>
                            <li><strong>Expand your ICP/SAM</strong> to increase market opportunity</li>
                            <li><strong>Increase capacity</strong> by hiring more reps or improving productivity</li>
                        </ul>
                    </div>
                `;
                window.frameworkData.validation = { passed: false, score: passed };
                document.getElementById('quotaGate').style.display = 'block';
                document.getElementById('quotaCalculator').style.display = 'none';
            }
            
            document.getElementById('finalValidation').innerHTML = finalHTML;
            
            document.getElementById('validationResults').style.display = 'block';
            document.getElementById('validationResults').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // ============================================
        // FINAL: QUOTAS
        // ============================================
        function calculateQuotas() {
            if (!window.frameworkData.validation?.passed) {
                alert('‚ö†Ô∏è You must pass validation tests first!');
                return;
            }
            
            const target = parseFloat(document.getElementById('quotaTarget').value) || 0;
            const reps = parseInt(document.getElementById('quotaReps').value) || 0;
            const attainment = parseFloat(document.getElementById('quotaAttainment').value) / 100 || 0.75;
            const acv = window.frameworkData.icp?.acv || 75000;
            
            const tier1 = parseInt(document.getElementById('tier1Count').value) || 0;
            const tier2 = parseInt(document.getElementById('tier2Count').value) || 0;
            const tier3 = parseInt(document.getElementById('tier3Count').value) || 0;
            
            if (target === 0 || reps === 0) {
                alert('Please enter revenue target and number of reps');
                return;
            }
            
            // Calculations
            const baseQuota = target / reps;
            const dealsNeeded = Math.ceil(baseQuota / acv);
            const pipelineNeeded = baseQuota * 3;
            const overAssignment = ((1 / attainment) - 1) * 100;
            
            // Display
            document.getElementById('baseQuota').textContent = `‚Ç¨${Math.round(baseQuota).toLocaleString()}`;
            document.getElementById('dealsNeeded').textContent = dealsNeeded;
            document.getElementById('pipelineNeeded').textContent = `‚Ç¨${Math.round(pipelineNeeded).toLocaleString()}`;
            document.getElementById('overAssignment').textContent = `${overAssignment.toFixed(1)}%`;
            
            // Territory quotas
            if (tier1 + tier2 + tier3 > 0) {
                const tier1Quota = baseQuota * 1.2;
                const tier2Quota = baseQuota * 1.0;
                const tier3Quota = baseQuota * 0.8;
                
                const tier1Deals = Math.ceil(tier1Quota / acv);
                const tier2Deals = Math.ceil(tier2Quota / acv);
                const tier3Deals = Math.ceil(tier3Quota / acv);
                
                const totalAssigned = (tier1 * tier1Quota) + (tier2 * tier2Quota) + (tier3 * tier3Quota);
                
                const territoryHTML = `
                    <tr>
                        <td><strong>Tier 1</strong></td>
                        <td>High (75%+ ICP)</td>
                        <td>${tier1}</td>
                        <td>‚Ç¨${Math.round(tier1Quota).toLocaleString()}</td>
                        <td>${tier1Deals}</td>
                        <td>‚Ç¨${Math.round(tier1 * tier1Quota).toLocaleString()}</td>
                    </tr>
                    <tr>
                        <td><strong>Tier 2</strong></td>
                        <td>Medium (40-75% ICP)</td>
                        <td>${tier2}</td>
                        <td>‚Ç¨${Math.round(tier2Quota).toLocaleString()}</td>
                        <td>${tier2Deals}</td>
                        <td>‚Ç¨${Math.round(tier2 * tier2Quota).toLocaleString()}</td>
                    </tr>
                    <tr>
                        <td><strong>Tier 3</strong></td>
                        <td>Low (<40% ICP)</td>
                        <td>${tier3}</td>
                        <td>‚Ç¨${Math.round(tier3Quota).toLocaleString()}</td>
                        <td>${tier3Deals}</td>
                        <td>‚Ç¨${Math.round(tier3 * tier3Quota).toLocaleString()}</td>
                    </tr>
                    <tr style="background: var(--bg-card); font-weight: 700;">
                        <td colspan="2"><strong>TOTAL</strong></td>
                        <td>${tier1 + tier2 + tier3}</td>
                        <td>-</td>
                        <td>-</td>
                        <td>‚Ç¨${Math.round(totalAssigned).toLocaleString()}</td>
                    </tr>
                `;
                
                document.getElementById('territoryTableBody').innerHTML = territoryHTML;
                document.getElementById('territoryQuotas').style.display = 'block';
            }
            
            // Summary
            const summaryHTML = `
                <div class="info-box success">
                    <h4>‚úì Quotas Set Successfully</h4>
                    <p style="color: var(--text-secondary); line-height: 1.7;">
                        Your quotas are now grounded in historical reality, validated against market opportunity,
                        supported by sales capacity, and stress-tested through scenario modeling.
                        <br/><br/>
                        <strong>Expected Outcomes:</strong><br/>
                        ‚Ä¢ ${(attainment * 100).toFixed(0)}% quota attainment (${Math.round(reps * attainment)} of ${reps} reps hit quota)<br/>
                        ‚Ä¢ ‚Ç¨${(target/1000000).toFixed(1)}M revenue target<br/>
                        ‚Ä¢ ${Math.round(dealsNeeded * reps)} total deals needed<br/>
                        ‚Ä¢ ‚Ç¨${((pipelineNeeded * reps)/1000000).toFixed(1)}M total pipeline required
                    </p>
                </div>
            `;
            
            document.getElementById('quotaFinalSummary').innerHTML = summaryHTML;
            
            // Store data
            window.frameworkData.quotas = { target, reps, baseQuota, attainment };
            
            document.getElementById('quotaResults').style.display = 'block';
            document.getElementById('quotaResults').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // ============================================
        // COMPENSATION MODELS
        // ============================================
        function updateCommissionType() {
            const type = document.getElementById('compType').value;
            
            document.getElementById('flatRateConfig').style.display = 'none';
            document.getElementById('tieredConfig').style.display = 'none';
            document.getElementById('cliffConfig').style.display = 'none';
            
            if (type === 'flat') {
                document.getElementById('flatRateConfig').style.display = 'block';
            } else if (type === 'tiered') {
                document.getElementById('tieredConfig').style.display = 'block';
            } else if (type === 'cliff') {
                document.getElementById('cliffConfig').style.display = 'block';
            }
        }
        
        function calculateCompensation() {
            const role = document.getElementById('compRole').value;
            const quota = parseFloat(document.getElementById('compQuota').value) || 0;
            const baseSalary = parseFloat(document.getElementById('compBase').value) || 0;
            const variable = parseFloat(document.getElementById('compVariable').value) || 0;
            const compType = document.getElementById('compType').value;
            const bonus = parseFloat(document.getElementById('compBonus').value) || 0;
            
            if (quota === 0 || baseSalary === 0 || variable === 0) {
                alert('Please enter quota, base salary, and variable compensation');
                return;
            }
            
            // OTE Calculations
            const ote = baseSalary + variable + bonus;
            const basePct = (baseSalary / ote * 100);
            const varPct = (variable / ote * 100);
            const compRatio = variable / baseSalary;
            
            // Display OTE metrics
            document.getElementById('oteAmount').textContent = `‚Ç¨${ote.toLocaleString()}`;
            document.getElementById('basePct').textContent = `${basePct.toFixed(0)}%`;
            document.getElementById('commissionPct').textContent = `${varPct.toFixed(0)}%`;
            document.getElementById('compRatio').textContent = `${compRatio.toFixed(2)}:1`;
            
            // Calculate earnings at different attainment levels
            const attainmentLevels = [0, 25, 50, 75, 100, 125, 150, 175, 200];
            let earningsHTML = '';
            
            attainmentLevels.forEach(attainment => {
                const revenueClosed = quota * (attainment / 100);
                let commission = 0;
                
                if (compType === 'flat') {
                    const rate = parseFloat(document.getElementById('flatRate').value) / 100 || 0.075;
                    commission = revenueClosed * rate;
                } else if (compType === 'tiered') {
                    const tier1 = parseFloat(document.getElementById('tier1Rate').value) / 100 || 0;
                    const tier2 = parseFloat(document.getElementById('tier2Rate').value) / 100 || 0.075;
                    const tier3 = parseFloat(document.getElementById('tier3Rate').value) / 100 || 0.10;
                    const tier4 = parseFloat(document.getElementById('tier4Rate').value) / 100 || 0.125;
                    
                    if (attainment < 50) {
                        commission = revenueClosed * tier1;
                    } else if (attainment < 100) {
                        commission = revenueClosed * tier2;
                    } else if (attainment < 125) {
                        const base = quota * tier2;
                        const excess = (revenueClosed - quota) * tier3;
                        commission = base + excess;
                    } else {
                        const base = quota * tier2;
                        const tier3Rev = quota * 0.25 * tier3;
                        const excess = (revenueClosed - (quota * 1.25)) * tier4;
                        commission = base + tier3Rev + excess;
                    }
                } else if (compType === 'cliff') {
                    const threshold = parseFloat(document.getElementById('cliffThreshold').value) / 100 || 0.60;
                    const rate = parseFloat(document.getElementById('cliffRate').value) / 100 || 0.075;
                    
                    if (attainment >= threshold * 100) {
                        commission = revenueClosed * rate;
                    }
                }
                
                const totalEarnings = baseSalary + commission + (attainment >= 100 ? bonus : 0);
                const effectiveRate = revenueClosed > 0 ? (commission / revenueClosed * 100) : 0;
                
                const rowColor = attainment >= 100 ? 'style="background: rgba(16, 185, 129, 0.1);"' : '';
                
                earningsHTML += `
                    <tr ${rowColor}>
                        <td><strong>${attainment}%</strong></td>
                        <td>‚Ç¨${(revenueClosed/1000000).toFixed(2)}M</td>
                        <td>‚Ç¨${baseSalary.toLocaleString()}</td>
                        <td style="color: ${commission > 0 ? 'var(--accent-success)' : 'var(--text-secondary)'};">
                            ‚Ç¨${Math.round(commission).toLocaleString()}
                        </td>
                        <td><strong>‚Ç¨${Math.round(totalEarnings).toLocaleString()}</strong></td>
                        <td>${effectiveRate.toFixed(2)}%</td>
                    </tr>
                `;
            });
            
            document.getElementById('earningsTableBody').innerHTML = earningsHTML;
            
            // Generate insights
            let insights = '';
            
            // Check base/variable split
            if (basePct > 65) {
                insights += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è High Base Salary</h4>
                        <p style="color: var(--text-secondary);">
                            Your base is ${basePct.toFixed(0)}% of OTE (${compRatio.toFixed(2)}:1 variable:base).
                            This gives reps less incentive to over-perform. Consider shifting to 50/50 or 60/40.
                        </p>
                    </div>
                `;
            } else if (basePct < 40) {
                insights += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Low Base Salary</h4>
                        <p style="color: var(--text-secondary);">
                            Your base is only ${basePct.toFixed(0)}% of OTE. This is high-risk for reps.
                            Consider increasing base to 40-50% for more stability.
                        </p>
                    </div>
                `;
            } else {
                insights += `
                    <div class="info-box success">
                        <h4>‚úì Balanced Split</h4>
                        <p style="color: var(--text-secondary);">
                            Your ${basePct.toFixed(0)}/${varPct.toFixed(0)} split (${compRatio.toFixed(2)}:1 ratio) 
                            is well-balanced. Provides stability while motivating performance.
                        </p>
                    </div>
                `;
            }
            
            // Check for accelerators
            if (compType === 'flat') {
                insights += `
                    <div class="info-box warning">
                        <h4>üí° Consider Adding Accelerators</h4>
                        <p style="color: var(--text-secondary);">
                            Flat commission structure provides no extra reward for over-performance.
                            Consider tiered structure with accelerators at 100% and 125% quota.
                        </p>
                    </div>
                `;
            }
            
            // Check OTE competitiveness
            if (ote < 80000 && role.toLowerCase().includes('account executive')) {
                insights += `
                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è Below Market OTE</h4>
                        <p style="color: var(--text-secondary);">
                            OTE of ‚Ç¨${ote.toLocaleString()} may be below market for ${role}.
                            Typical mid-market AE OTE: ‚Ç¨90-140K. Risk losing talent to competitors.
                        </p>
                    </div>
                `;
            }
            
            document.getElementById('compInsights').innerHTML = insights;
            
            // Recommendations
            const earnings100 = baseSalary + (quota * (compType === 'flat' ? (parseFloat(document.getElementById('flatRate').value) / 100 || 0.075) : 0.075)) + bonus;
            const earnings150 = baseSalary + (quota * 1.5 * (compType === 'tiered' ? 0.11 : 0.075)) + bonus;
            
            let recommendations = `
                <div class="card">
                    <h4 style="margin-bottom: 20px; font-weight: 700;">üìã Key Takeaways</h4>
                    <ul style="color: var(--text-secondary); line-height: 1.9; margin-left: 20px;">
                        <li><strong>OTE:</strong> ‚Ç¨${ote.toLocaleString()} (${basePct.toFixed(0)}% base, ${varPct.toFixed(0)}% variable)</li>
                        <li><strong>At 100% quota:</strong> ‚Ç¨${Math.round(earnings100).toLocaleString()} total earnings</li>
                        <li><strong>At 150% quota:</strong> ‚Ç¨${Math.round(earnings150).toLocaleString()} total earnings</li>
                        <li><strong>Upside potential:</strong> ${((earnings150 - earnings100) / earnings100 * 100).toFixed(0)}% more for 50% over-performance</li>
            `;
            
            if (compType === 'tiered') {
                recommendations += `<li><strong>Accelerators active:</strong> Commission rates increase at 100% and 125% quota</li>`;
            }
            
            recommendations += `
                    </ul>
                    <p style="color: var(--text-secondary); margin-top: 20px; line-height: 1.7;">
                        <strong>Next Steps:</strong><br/>
                        1. Benchmark this OTE against market data for ${role}<br/>
                        2. Review with finance to ensure affordability at various attainment levels<br/>
                        3. Test plan with sales team for clarity and motivation<br/>
                        4. Document plan clearly in compensation letter
                    </p>
                </div>
            `;
            
            document.getElementById('compRecommendations').innerHTML = recommendations;
            
            // Store data
            window.frameworkData.compensation = {
                role, quota, baseSalary, variable, ote, compType, bonus
            };
            
            document.getElementById('compensationResults').style.display = 'block';
            document.getElementById('compensationResults').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    </script>
</body>
</html>        
        <!-- ============================================ -->
        <!-- INTERACTIVE CALCULATION ENGINE -->
        <!-- ============================================ -->
        <script>
        // ============================================
        // GLOBAL STATE MANAGEMENT
        // ============================================
        const planState = {
            // Historical Data
            currentRevenue: 0,
            currentTarget: 0,
            previousRevenue: 0,
            currentReps: 0,
            
            // Performance Metrics
            quotaAttainmentPct: 0,
            histAvgDeal: 45000,
            histSalesCycle: 75,
            histWinRate: 28,
            
            // Revenue Composition
            newCustomerRev: 0,
            expansionRev: 0,
            renewalRev: 0,
            churnAmount: 0,
            
            // Market Data
            tam: 0,
            sam: 0,
            som: 0,
            
            // CFO Parameters
            boardTarget: 0,
            achievementRate: 92,
            paymentTerms: 60,
            dso: 52,
            collectionRate: 94
        };

        // Calculated Metrics
        const calculatedMetrics = {
            totalQuota: 0,
            totalHeadcount: 0,
            totalComp: 0,
            cac: 0,
            magicNumber: 0,
            workingCapital: 0
        };

        // ============================================
        // MAIN CALCULATION FUNCTION
        // ============================================
        function recalculateAll() {
            try {
                // Update state from forms
                updateStateFromForms();
                
                // Calculate derived metrics
                calculateTotals();
                calculateCFOMetrics();
                calculateCashFlow();
                
                // Update all displays
                updateCFODashboard();
                updateBoardReconciliation();
                updateDataQuality();
                
                // Auto-save
                saveState();
            } catch (error) {
                console.error('Calculation error:', error);
            }
        }

        // ============================================
        // STATE UPDATES
        // ============================================
        function updateStateFromForms() {
            // Historical Revenue
            planState.currentRevenue = getInputValue('currentRevenue');
            planState.currentTarget = getInputValue('currentTarget');
            planState.previousRevenue = getInputValue('previousRevenue');
            planState.currentReps = getInputValue('currentReps');
            
            // Performance
            planState.quotaAttainmentPct = getInputValue('quotaAttainmentPct');
            planState.histAvgDeal = getInputValue('histAvgDeal') || 45000;
            planState.histSalesCycle = getInputValue('histSalesCycle') || 75;
            planState.histWinRate = getInputValue('histWinRate') || 28;
            
            // Revenue Composition
            planState.newCustomerRev = getInputValue('newCustomerRev');
            planState.expansionRev = getInputValue('expansionRev');
            planState.renewalRev = getInputValue('renewalRev');
            planState.churnAmount = getInputValue('churnAmount');
            
            // CFO Inputs
            planState.boardTarget = getInputValue('boardTargetInput');
            planState.achievementRate = getInputValue('achievementRateInput') || 92;
            planState.paymentTerms = parseInt(getSelectValue('paymentTermsInput') || 60);
            planState.dso = getInputValue('dsoInput') || 52;
            planState.collectionRate = getInputValue('collectionRateInput') || 94;
        }

        function getInputValue(id) {
            const el = document.getElementById(id);
            return el ? parseFloat(el.value) || 0 : 0;
        }

        function getSelectValue(id) {
            const el = document.getElementById(id);
            return el ? el.value : null;
        }

        // ============================================
        // CALCULATIONS
        // ============================================
        function calculateTotals() {
            // If we have actual revenue data, use it as baseline
            // Assume 20% growth for next year quota
            if (planState.currentRevenue > 0) {
                calculatedMetrics.totalQuota = planState.currentRevenue * 1.2;
            } else if (planState.currentTarget > 0) {
                calculatedMetrics.totalQuota = planState.currentTarget;
            } else {
                calculatedMetrics.totalQuota = 0;
            }
            
            // Headcount - use current or estimate
            calculatedMetrics.totalHeadcount = planState.currentReps || 20;
            
            // Compensation estimate (average ‚Ç¨180K OTE per rep, + 30% benefits)
            calculatedMetrics.totalComp = calculatedMetrics.totalHeadcount * 180000 * 1.3;
        }

        function calculateCFOMetrics() {
            const { totalQuota, totalHeadcount, totalComp } = calculatedMetrics;
            
            // CAC
            const dealsNeeded = totalQuota / planState.histAvgDeal;
            calculatedMetrics.cac = dealsNeeded > 0 ? totalComp / dealsNeeded : 0;
            
            // Magic Number
            const previousRev = planState.previousRevenue || (totalQuota * 0.8);
            const newARR = totalQuota - previousRev;
            calculatedMetrics.magicNumber = totalComp > 0 ? newARR / totalComp : 0;
        }

        function calculateCashFlow() {
            const { totalComp } = calculatedMetrics;
            
            // Working capital need (approximately 2.5 months of comp expense)
            calculatedMetrics.workingCapital = (totalComp / 12) * 2.5;
        }

        // ============================================
        // DISPLAY UPDATES
        // ============================================
        function updateCFODashboard() {
            const { totalQuota, totalHeadcount, totalComp, cac, magicNumber } = calculatedMetrics;
            
            // Update values
            updateElement('cfo-totalQuota', formatCurrency(totalQuota));
            updateElement('cfo-boardTarget', formatCurrency(planState.boardTarget));
            updateElement('cfo-totalHeadcount', totalHeadcount);
            updateElement('cfo-totalComp', formatCurrency(totalComp));
            updateElement('cfo-cac', formatCurrency(cac, 0));
            updateElement('cfo-magic', magicNumber.toFixed(2));
            
            // Update indicators
            updateVarianceIndicator();
            updateCompIndicator();
        }

        function updateVarianceIndicator() {
            const variance = calculatedMetrics.totalQuota - planState.boardTarget;
            const variancePct = planState.boardTarget > 0 ? (variance / planState.boardTarget * 100) : 0;
            
            const indicator = document.getElementById('cfo-variance-indicator');
            if (!indicator) return;
            
            if (planState.boardTarget === 0) {
                indicator.textContent = '‚ö™ Not Set';
                indicator.style.background = 'rgba(148, 163, 184, 0.2)';
                indicator.style.color = 'var(--text-muted)';
            } else if (Math.abs(variancePct) < 5) {
                indicator.textContent = '‚úÖ Aligned (' + variancePct.toFixed(1) + '%)';
                indicator.style.background = 'rgba(16, 185, 129, 0.2)';
                indicator.style.color = 'var(--accent-success)';
            } else if (variance > 0) {
                indicator.textContent = '‚ö†Ô∏è +' + variancePct.toFixed(1) + '%';
                indicator.style.background = 'rgba(245, 158, 11, 0.2)';
                indicator.style.color = 'var(--accent-warning)';
            } else {
                indicator.textContent = '‚ùå ' + variancePct.toFixed(1) + '%';
                indicator.style.background = 'rgba(239, 68, 68, 0.2)';
                indicator.style.color = 'var(--accent-danger)';
            }
        }

        function updateCompIndicator() {
            const compPct = calculatedMetrics.totalQuota > 0 ? 
                (calculatedMetrics.totalComp / calculatedMetrics.totalQuota * 100) : 0;
            
            const indicator = document.getElementById('cfo-comp-indicator');
            if (!indicator) return;
            
            if (compPct === 0) {
                indicator.textContent = '‚ö™ Not Calculated';
                indicator.style.background = 'rgba(148, 163, 184, 0.2)';
                indicator.style.color = 'var(--text-muted)';
            } else if (compPct <= 25) {
                indicator.textContent = '‚úÖ ' + compPct.toFixed(1) + '% of Quota';
                indicator.style.background = 'rgba(16, 185, 129, 0.2)';
                indicator.style.color = 'var(--accent-success)';
            } else if (compPct <= 40) {
                indicator.textContent = '‚ö†Ô∏è ' + compPct.toFixed(1) + '% of Quota';
                indicator.style.background = 'rgba(245, 158, 11, 0.2)';
                indicator.style.color = 'var(--accent-warning)';
            } else {
                indicator.textContent = '‚ùå ' + compPct.toFixed(1) + '% High';
                indicator.style.background = 'rgba(239, 68, 68, 0.2)';
                indicator.style.color = 'var(--accent-danger)';
            }
        }

        function updateBoardReconciliation() {
            const { totalQuota } = calculatedMetrics;
            const { boardTarget, achievementRate } = planState;
            
            updateElement('board-target-display', formatCurrency(boardTarget));
            updateElement('sum-quotas-display', formatCurrency(totalQuota));
            
            const variance = totalQuota - boardTarget;
            updateElement('variance-display', (variance >= 0 ? '+' : '') + formatCurrency(Math.abs(variance)));
            
            const projectedRevenue = totalQuota * (achievementRate / 100);
            updateElement('projected-revenue-display', formatCurrency(projectedRevenue));
            
            // Update variance status
            const varianceStatus = document.getElementById('variance-status');
            if (varianceStatus && boardTarget > 0) {
                const variancePct = (variance / boardTarget * 100);
                if (Math.abs(variancePct) < 5) {
                    varianceStatus.textContent = '‚úÖ Aligned';
                    varianceStatus.style.background = 'rgba(16, 185, 129, 0.2)';
                    varianceStatus.style.color = 'var(--accent-success)';
                } else if (variance > 0) {
                    varianceStatus.textContent = '‚ö†Ô∏è +' + variancePct.toFixed(1) + '%';
                    varianceStatus.style.background = 'rgba(245, 158, 11, 0.2)';
                    varianceStatus.style.color = 'var(--accent-warning)';
                } else {
                    varianceStatus.textContent = '‚ùå ' + variancePct.toFixed(1) + '%';
                    varianceStatus.style.background = 'rgba(239, 68, 68, 0.2)';
                    varianceStatus.style.color = 'var(--accent-danger)';
                }
            }
            
            // Update revenue status
            const revenueGap = boardTarget - projectedRevenue;
            const revenueStatus = document.getElementById('revenue-status');
            if (revenueStatus && boardTarget > 0) {
                if (revenueGap <= 0) {
                    revenueStatus.textContent = '‚úÖ On Track';
                    revenueStatus.style.background = 'rgba(16, 185, 129, 0.2)';
                    revenueStatus.style.color = 'var(--accent-success)';
                } else {
                    revenueStatus.textContent = '‚ùå -' + formatCurrency(revenueGap);
                    revenueStatus.style.background = 'rgba(239, 68, 68, 0.2)';
                    revenueStatus.style.color = 'var(--accent-danger)';
                }
            }
            
            // Show/hide alert
            const alert = document.getElementById('guidance-alert');
            const recommendation = document.getElementById('guidance-recommendation');
            if (alert && recommendation && boardTarget > 0 && Math.abs(revenueGap) > boardTarget * 0.05) {
                alert.style.display = 'block';
                const requiredIncrease = (boardTarget / (achievementRate / 100)) - totalQuota;
                recommendation.innerHTML = 
                    '<strong>Gap: ' + formatCurrency(revenueGap) + ' shortfall.</strong><br>' +
                    'Either increase quotas by ' + formatCurrency(requiredIncrease) + 
                    ' (+' + ((requiredIncrease / totalQuota) * 100).toFixed(1) + '%) ' +
                    'OR revise board guidance down to ' + formatCurrency(projectedRevenue) + '.';
            } else if (alert) {
                alert.style.display = 'none';
            }
            
            // Update cash flow
            updateElement('cash-dso', planState.dso);
            const cashCycle = planState.paymentTerms + 22; // Approx
            updateElement('cash-cycle', cashCycle);
            updateElement('working-capital', formatCurrency(calculatedMetrics.workingCapital));
        }

        function updateDataQuality() {
            let score = 0;
            
            // Revenue data (40 points)
            if (planState.currentRevenue > 0) score += 20;
            if (planState.previousRevenue > 0) score += 20;
            
            // Capacity data (30 points)
            if (planState.currentReps > 0) score += 30;
            
            // Market data (30 points)
            if (planState.tam > 0) score += 15;
            if (planState.som > 0) score += 15;
            
            updateElement('dataQualityScore', score + '/100');
            
            // Update quality indicators
            updateElement('quality-revenue', 
                planState.currentRevenue > 0 ? '‚úÖ Historical Revenue: Complete' : '‚ö™ Historical Revenue: Not Entered');
            updateElement('quality-capacity',
                planState.currentReps > 0 ? '‚úÖ Capacity Data: Complete' : '‚ö™ Capacity Data: Not Entered');
            updateElement('quality-market',
                planState.tam > 0 ? '‚úÖ Market Sizing: Complete' : '‚ö™ Market Sizing: Not Entered');
            
            // Update banner style
            const banner = document.getElementById('dataQualityBanner');
            if (banner) {
                if (score >= 70) {
                    banner.style.background = 'rgba(16, 185, 129, 0.1)';
                    banner.style.borderColor = 'var(--accent-success)';
                } else if (score >= 40) {
                    banner.style.background = 'rgba(245, 158, 11, 0.1)';
                    banner.style.borderColor = 'var(--accent-warning)';
                } else {
                    banner.style.background = 'rgba(239, 68, 68, 0.1)';
                    banner.style.borderColor = 'var(--accent-danger)';
                }
            }
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function updateElement(id, value) {
            const el = document.getElementById(id);
            if (el) el.textContent = value;
        }

        function formatCurrency(value, decimals = 1) {
            if (value === 0) return '‚Ç¨0.0M';
            if (value >= 1000000) {
                return '‚Ç¨' + (value / 1000000).toFixed(decimals) + 'M';
            } else if (value >= 1000) {
                return '‚Ç¨' + (value / 1000).toFixed(0) + 'K';
            } else {
                return '‚Ç¨' + value.toFixed(0);
            }
        }

        // ============================================
        // SAVE/LOAD FUNCTIONS
        // ============================================
        function saveState() {
            try {
                localStorage.setItem('quotaPlanState', JSON.stringify(planState));
            } catch (e) {
                console.log('Could not save state');
            }
        }

        function savePlan() {
            saveState();
            alert('‚úÖ Plan saved successfully! Your data is stored locally in your browser.');
        }

        function loadState() {
            try {
                const saved = localStorage.getItem('quotaPlanState');
                if (saved) {
                    Object.assign(planState, JSON.parse(saved));
                    populateFormsFromState();
                    recalculateAll();
                    return true;
                }
            } catch (e) {
                console.log('Could not load state');
            }
            return false;
        }

        function populateFormsFromState() {
            // Populate form fields from saved state
            Object.keys(planState).forEach(key => {
                const el = document.getElementById(key);
                if (el && typeof planState[key] !== 'object') {
                    el.value = planState[key];
                }
            });
        }

        // ============================================
        // EXPORT FUNCTIONS
        // ============================================
        function exportToCSV() {
            let csv = 'Quota & Capacity Plan Export\n\n';
            csv += 'Generated: ' + new Date().toLocaleString() + '\n\n';
            csv += 'EXECUTIVE SUMMARY\n';
            csv += 'Total Quota,' + calculatedMetrics.totalQuota + '\n';
            csv += 'Board Target,' + planState.boardTarget + '\n';
            csv += 'Total Headcount,' + calculatedMetrics.totalHeadcount + '\n';
            csv += 'Total Compensation,' + calculatedMetrics.totalComp + '\n';
            csv += 'CAC,' + calculatedMetrics.cac + '\n';
            csv += 'Magic Number,' + calculatedMetrics.magicNumber + '\n\n';
            csv += 'HISTORICAL DATA\n';
            csv += 'Current Revenue,' + planState.currentRevenue + '\n';
            csv += 'Previous Revenue,' + planState.previousRevenue + '\n';
            csv += 'Current Reps,' + planState.currentReps + '\n';
            
            // Download
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'quota-plan-' + new Date().toISOString().split('T')[0] + '.csv';
            a.click();
            
            alert('‚úÖ CSV exported successfully!');
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
        // DIAGNOSTIC: Log all sections on page load
        console.log('=== PAGE LOADED ===');
        const allSections = document.querySelectorAll('.section');
        console.log('Total sections found:', allSections.length);
        allSections.forEach((section, index) => {
            console.log(`Section ${index + 1}: id="${section.id}", active="${section.classList.contains('active')}"`);
        });

            console.log('üöÄ Initializing Quota Planning Framework...');
            
            // Add event listeners to all inputs
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', recalculateAll);
                input.addEventListener('change', recalculateAll);
            });
            
            console.log('‚úì Added listeners to ' + inputs.length + ' inputs');
            
            // Try to load saved state
            if (loadState()) {
                console.log('‚úì Loaded saved plan');
            }
            
            // Initial calculation
            setTimeout(() => {
                recalculateAll();
                console.log('‚úì Initial calculation complete');
            }, 100);
        });
        </script>
    </body>
</html>
