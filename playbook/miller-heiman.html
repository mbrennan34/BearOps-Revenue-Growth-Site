<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miller Heiman Strategic Analysis</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0A1628 0%, #1a2942 100%);
            color: #ffffff;
            padding: 40px 20px;
            min-height: 100vh;
        }

        .controls {
            max-width: 1600px;
            margin: 0 auto 20px auto;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 999px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(8px);
        }

        .btn:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }

        .controls-bar {
            max-width: 1600px;
            margin: 0 auto 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 18px 35px rgba(0,0,0,0.45);
            backdrop-filter: blur(14px);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            align-items: center;
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #ffffff;
            box-shadow: 0 8px 20px rgba(0,0,0,0.35);
            white-space: nowrap;
        }

        .control-btn:hover {
            transform: translateY(-1px);
            filter: brightness(1.08);
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .client-selector label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: rgba(255,255,255,0.8);
        }

        .client-selector select {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9rem;
            background: rgba(10, 22, 40, 0.9);
            color: #ffffff;
            outline: none;
        }

        .client-selector select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 1px rgba(102,126,234,0.7);
        }

        .save-indicator {
            text-align: right;
            margin-top: 10px;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
        }

        .page {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255,255,255,0.04);
            box-shadow: 0 25px 50px rgba(0,0,0,0.7);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.12);
            backdrop-filter: blur(18px);
        }

        .header {
            background: radial-gradient(circle at top left, rgba(102,126,234,0.25), transparent);
            color: #ffffff;
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }

        .header h1 {
            font-size: 1.8rem;
            letter-spacing: 0.35em;
            font-weight: 300;
            text-transform: uppercase;
        }

        .header div {
            font-size: 0.8rem;
            letter-spacing: 0.06em;
            text-transform: uppercase;
            color: rgba(255,255,255,0.7);
        }

        .top-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }

        .left-panel {
            border-right: 1px solid rgba(255,255,255,0.15);
        }

        .section-row {
            border-bottom: 1px solid rgba(255,255,255,0.13);
            display: grid;
            grid-template-columns: 150px 1fr;
        }

        .section-label {
            background: rgba(10, 22, 40, 0.9);
            padding: 12px 15px;
            font-weight: 600;
            border-right: 1px solid rgba(255,255,255,0.15);
            color: rgba(255,255,255,0.9);
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        .section-content {
            padding: 12px 15px;
            background: rgba(255,255,255,0.02);
        }

        .section-content input,
        .section-content textarea {
            width: 100%;
            border: none;
            font-family: inherit;
            font-size: 0.9rem;
            background: transparent;
            color: #ffffff;
            outline: none;
        }

        .section-content input::placeholder,
        .section-content textarea::placeholder {
            color: rgba(255,255,255,0.4);
        }

        .section-content textarea {
            min-height: 60px;
            resize: vertical;
        }

        .adequacy-box {
            padding: 15px;
            background: radial-gradient(circle at top, rgba(102,126,234,0.18), rgba(10,22,40,0.9));
            border-bottom: 1px solid rgba(255,255,255,0.18);
        }

        .adequacy-box strong {
            font-size: 0.85rem;
            letter-spacing: 0.08em;
        }

        .adequacy-grid {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            font-size: 0.75rem;
        }

        .adequacy-item {
            text-align: center;
            color: rgba(255,255,255,0.85);
        }

        .adequacy-item input[type="radio"] {
            display: block;
            margin: 8px auto 0 auto;
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #667eea;
        }

        .ideal-customer {
            padding: 15px;
            background: linear-gradient(135deg, rgba(190,227,248,0.08) 0%, rgba(144,205,244,0.14) 100%);
            border-top: 1px solid rgba(66,153,225,0.5);
        }

        .ideal-customer strong {
            font-size: 0.85rem;
            letter-spacing: 0.08em;
        }

        .ideal-customer textarea {
            width: 100%;
            min-height: 90px;
            border: 1px solid rgba(66,153,225,0.7);
            padding: 10px;
            margin-top: 8px;
            border-radius: 10px;
            background: rgba(10,22,40,0.9);
            color: #ffffff;
            font-size: 0.9rem;
        }

        .ideal-customer textarea::placeholder {
            color: rgba(255,255,255,0.4);
        }

        .sso-section {
            display: grid;
            grid-template-columns: 150px 1fr 200px 200px 200px;
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }

        .sso-content {
            padding: 10px;
            border-right: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.02);
            font-size: 0.8rem;
        }

        .sso-content:last-child {
            border-right: none;
        }

        .sso-content textarea {
            width: 100%;
            min-height: 60px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 6px;
            background: rgba(10,22,40,0.95);
            color: #ffffff;
            font-size: 0.85rem;
        }

        .sso-content textarea::placeholder {
            color: rgba(255,255,255,0.4);
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.75rem;
            margin-bottom: 3px;
            color: rgba(255,255,255,0.85);
        }

        .checkbox-group input[type="radio"] {
            accent-color: #667eea;
        }

        .roles-section {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            border-bottom: 1px solid rgba(255,255,255,0.15);
            background: linear-gradient(135deg, rgba(254,245,231,0.08) 0%, rgba(253,235,208,0.14) 100%);
        }

        .role-box {
            padding: 15px;
            border-right: 1px solid rgba(245,176,65,0.4);
            font-size: 0.8rem;
            color: rgba(255,255,255,0.9);
        }

        .role-box strong {
            display: block;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-size: 0.75rem;
        }

        .role-box:last-child {
            border-right: none;
        }

        .note-box {
            background: rgba(254,245,231,0.1);
            border: 1px solid rgba(245,176,65,0.7);
            border-left: 5px solid #f39c12;
            padding: 15px;
            margin: 15px;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.9);
        }

        .buying-influences-table {
            width: 100%;
            border-collapse: collapse;
        }

        .buying-influences-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px;
            text-align: left;
            font-size: 0.75rem;
            border: 1px solid rgba(90,103,216,0.9);
        }

        .buying-influences-table td {
            padding: 8px;
            border: 1px solid rgba(203,213,224,0.4);
            background: rgba(15,27,48,0.9);
        }

        .buying-influences-table input,
        .buying-influences-table select,
        .buying-influences-table textarea {
            width: 100%;
            border: 1px solid rgba(226,232,240,0.8);
            background: rgba(5,15,30,0.95);
            font-size: 0.8rem;
            padding: 6px;
            border-radius: 4px;
            color: #ffffff;
        }

        .buying-influences-table textarea {
            min-height: 50px;
            resize: vertical;
        }

        .buying-influences-table input::placeholder,
        .buying-influences-table textarea::placeholder {
            color: rgba(255,255,255,0.4);
        }

        .add-row-btn {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            border-radius: 999px;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(56,161,105,0.5);
            transition: all 0.3s ease;
        }

        .add-row-btn:hover {
            transform: translateY(-1px);
            filter: brightness(1.05);
        }

        .delete-row-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            box-shadow: 0 4px 10px rgba(229,62,62,0.5);
        }

        .bottom-section {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            border-top: 1px solid rgba(255,255,255,0.15);
        }

        .bottom-box {
            border-right: 1px solid rgba(255,255,255,0.15);
            min-height: 200px;
        }

        .bottom-box:last-child {
            border-right: none;
        }

        .bottom-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 15px;
            font-weight: 600;
            text-align: center;
            font-size: 0.9rem;
            letter-spacing: 0.08em;
        }

        .bottom-content {
            padding: 16px;
            background: rgba(15,27,48,0.95);
        }

        .bottom-content textarea {
            width: 100%;
            min-height: 130px;
            border: 1px solid rgba(203,213,224,0.9);
            padding: 10px;
            font-size: 0.85rem;
            border-radius: 8px;
            background: rgba(5,15,30,0.95);
            color: #ffffff;
        }

        .bottom-content textarea::placeholder {
            color: rgba(255,255,255,0.4);
        }

        .action-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .action-table th {
            background: rgba(237,242,247,0.1);
            padding: 8px;
            border: 1px solid rgba(203,213,224,0.4);
            font-size: 0.75rem;
            color: rgba(255,255,255,0.85);
        }

        .action-table td {
            padding: 8px;
            border: 1px solid rgba(203,213,224,0.4);
            background: rgba(5,15,30,0.9);
        }

        .action-table input {
            width: 100%;
            border: 1px solid rgba(226,232,240,0.9);
            font-size: 0.8rem;
            padding: 6px;
            border-radius: 4px;
            background: rgba(10,22,40,0.95);
            color: #ffffff;
        }

        .action-table input::placeholder {
            color: rgba(255,255,255,0.4);
        }

        /* AI INSIGHTS PANEL */
        .ai-insights-panel {
            background: linear-gradient(135deg, rgba(102,126,234,0.15) 0%, rgba(118,75,162,0.15) 100%);
            border: 2px solid rgba(102,126,234,0.4);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 20px 15px;
            box-shadow: 0 12px 28px rgba(0,0,0,0.3);
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(102,126,234,0.3);
        }

        .ai-icon {
            font-size: 1.5rem;
            filter: drop-shadow(0 2px 8px rgba(102,126,234,0.6));
        }

        .ai-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #ffffff;
            letter-spacing: 0.05em;
        }

        .ai-score {
            margin-left: auto;
            font-size: 1.5rem;
            font-weight: bold;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            background: rgba(10,22,40,0.8);
        }

        .score-excellent { color: #38ef7d; }
        .score-good { color: #48bb78; }
        .score-moderate { color: #f093fb; }
        .score-weak { color: #ffa500; }
        .score-critical { color: #f5576c; }

        .ai-section {
            margin-bottom: 1.5rem;
        }

        .ai-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .ai-content {
            background: rgba(10,22,40,0.6);
            border-radius: 12px;
            padding: 1rem;
            font-size: 0.9rem;
            line-height: 1.6;
            color: rgba(255,255,255,0.9);
        }

        .ai-bullet {
            display: flex;
            align-items: start;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .ai-bullet:last-child {
            margin-bottom: 0;
        }

        .bullet-icon {
            font-size: 1.2rem;
            min-width: 1.5rem;
        }

        .bullet-text {
            flex: 1;
        }

        .ai-recommendation {
            background: linear-gradient(135deg, rgba(56,239,125,0.15) 0%, rgba(72,187,120,0.15) 100%);
            border-left: 4px solid #38ef7d;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-size: 0.85rem;
        }

        .ai-warning {
            background: linear-gradient(135deg, rgba(245,93,108,0.15) 0%, rgba(235,51,73,0.15) 100%);
            border-left: 4px solid #f5576c;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-size: 0.85rem;
        }

        .quality-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 0.5rem;
        }

        .quality-complete {
            background: rgba(56,239,125,0.2);
            color: #38ef7d;
            border: 1px solid #38ef7d;
        }

        .quality-partial {
            background: rgba(240,147,251,0.2);
            color: #f093fb;
            border: 1px solid #f093fb;
        }

        .quality-missing {
            background: rgba(245,93,108,0.2);
            color: #f5576c;
            border: 1px solid #f5576c;
        }

        /* ---------- LIGHT THEME OVERRIDES ---------- */

        body.light-theme {
            background: linear-gradient(135deg, #f7fafc 0%, #e2e8f0 100%);
            color: #1a202c;
        }

        body.light-theme .controls-bar {
            background: #ffffff;
            border-color: #e2e8f0;
            box-shadow: 0 12px 24px rgba(148,163,184,0.35);
            backdrop-filter: none;
        }

        body.light-theme .btn {
            background: #ffffff;
            color: #2d3748;
            border-color: #cbd5e0;
        }

        body.light-theme .btn:hover {
            background: #edf2ff;
            border-color: #667eea;
            color: #1a202c;
        }

        body.light-theme .page {
            background: #ffffff;
            border-color: #e2e8f0;
            box-shadow: 0 20px 40px rgba(148,163,184,0.5);
            backdrop-filter: none;
        }

        body.light-theme .header {
            background: linear-gradient(135deg, #edf2ff 0%, #e9d8fd 100%);
            color: #1a202c;
            border-bottom-color: #e2e8f0;
        }

        body.light-theme .header div {
            color: #4a5568;
        }

        body.light-theme .top-section {
            border-bottom-color: #e2e8f0;
        }

        body.light-theme .left-panel {
            border-right-color: #e2e8f0;
        }

        body.light-theme .section-row {
            border-bottom-color: #e2e8f0;
        }

        body.light-theme .section-label {
            background: #f7fafc;
            color: #2d3748;
            border-right-color: #e2e8f0;
        }

        body.light-theme .section-content {
            background: #ffffff;
        }

        body.light-theme .section-content input,
        body.light-theme .section-content textarea {
            color: #1a202c;
        }

        body.light-theme .section-content input::placeholder,
        body.light-theme .section-content textarea::placeholder {
            color: #a0aec0;
        }

        body.light-theme .adequacy-box {
            background: #edf2f7;
            border-bottom-color: #e2e8f0;
            color: #2d3748;
        }

        body.light-theme .adequacy-item {
            color: #2d3748;
        }

        body.light-theme .ideal-customer {
            background: linear-gradient(135deg, #ebf8ff 0%, #bee3f8 100%);
            border-top-color: #4299e1;
        }

        body.light-theme .ideal-customer textarea {
            background: #ffffff;
            color: #1a202c;
            border-color: #90cdf4;
        }

        body.light-theme .ideal-customer textarea::placeholder {
            color: #718096;
        }

        body.light-theme .sso-section {
            border-bottom-color: #e2e8f0;
        }

        body.light-theme .sso-content {
            background: #f7fafc;
            border-right-color: #e2e8f0;
            color: #2d3748;
        }

        body.light-theme .sso-content textarea {
            background: #ffffff;
            border-color: #cbd5e0;
            color: #1a202c;
        }

        body.light-theme .sso-content textarea::placeholder {
            color: #a0aec0;
        }

        body.light-theme .checkbox-group label {
            color: #2d3748;
        }

        body.light-theme .roles-section {
            background: linear-gradient(135deg, #fffaf0 0%, #fef3c7 100%);
            border-bottom-color: #e2e8f0;
        }

        body.light-theme .role-box {
            color: #2d3748;
            border-right-color: #f6ad55;
        }

        body.light-theme .note-box {
            background: #fffaf0;
            border-color: #f6ad55;
            color: #2d3748;
        }

        body.light-theme .buying-influences-table th {
            /* keep gradient for structure, but it's fine for light theme */
            color: #ffffff;
        }

        body.light-theme .buying-influences-table td {
            background: #f7fafc;
            border-color: #e2e8f0;
        }

        body.light-theme .buying-influences-table input,
        body.light-theme .buying-influences-table select,
        body.light-theme .buying-influences-table textarea {
            background: #ffffff;
            border-color: #cbd5e0;
            color: #1a202c;
        }

        body.light-theme .buying-influences-table input::placeholder,
        body.light-theme .buying-influences-table textarea::placeholder {
            color: #a0aec0;
        }

        body.light-theme .bottom-section {
            border-top-color: #e2e8f0;
        }

        body.light-theme .bottom-box {
            border-right-color: #e2e8f0;
        }

        body.light-theme .bottom-header {
            color: #f7fafc;
        }

        body.light-theme .bottom-content {
            background: #f7fafc;
        }

        body.light-theme .bottom-content textarea {
            background: #ffffff;
            border-color: #cbd5e0;
            color: #1a202c;
        }

        body.light-theme .bottom-content textarea::placeholder {
            color: #a0aec0;
        }

        body.light-theme .action-table th {
            background: #edf2f7;
            border-color: #cbd5e0;
            color: #2d3748;
        }

        body.light-theme .action-table td {
            background: #ffffff;
            border-color: #e2e8f0;
        }

        body.light-theme .action-table input {
            background: #ffffff;
            border-color: #cbd5e0;
            color: #1a202c;
        }

        body.light-theme .save-indicator {
            color: #4a5568;
        }

        body.light-theme .controls-bar .control-btn {
            box-shadow: 0 8px 18px rgba(148,163,184,0.35);
        }

        body.light-theme .ai-insights-panel {
            background: linear-gradient(135deg, rgba(237,242,255,0.8) 0%, rgba(233,216,253,0.8) 100%);
            border-color: rgba(102,126,234,0.3);
        }

        body.light-theme .ai-content {
            background: rgba(255,255,255,0.8);
            color: #1a202c;
        }

        body.light-theme .ai-section-title {
            color: #667eea;
        }

        body.light-theme .ai-score {
            background: rgba(255,255,255,0.9);
        }

        body.light-theme .ai-recommendation {
            background: linear-gradient(135deg, rgba(56,239,125,0.1) 0%, rgba(72,187,120,0.1) 100%);
        }

        body.light-theme .ai-warning {
            background: linear-gradient(135deg, rgba(245,93,108,0.1) 0%, rgba(235,51,73,0.1) 100%);
        }

        @media (max-width: 1200px) {
            .controls-grid {
                grid-template-columns: 1fr;
            }
            .top-section {
                grid-template-columns: 1fr;
            }
            .sso-section {
                grid-template-columns: 150px 1fr;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 20px 10px;
            }
            .page {
                border-radius: 14px;
            }
            .header {
                flex-direction: column;
                gap: 6px;
            }
            .bottom-section {
                grid-template-columns: 1fr;
            }
        }

        @media print {
            body {
                background: #ffffff;
                color: #000000;
                padding: 0;
            }
            .controls,
            .controls-bar,
            .add-row-btn,
            .delete-row-btn {
                display: none !important;
            }
            .page {
                box-shadow: none;
                border-radius: 0;
                border: none;
            }
            .header,
            .section-label,
            .bottom-header,
            .buying-influences-table th {
                color: #000000;
                background: #f1f1f1 !important;
                -webkit-print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
 <!-- Overlaid logo (doesn't change layout) -->
        <img src="../assets/images/BearOps_Logo_Default.png">

<div class="controls">
    <button class="btn" onclick="window.location.href='sales-engine-architecture.html'">Back to Hub</button>

</div>

<div class="controls-bar">
    <div class="controls-grid">
        <div class="client-selector">
            <label>Select Client Strategy:</label>
            <select id="strategy-select" onchange="switchStrategy(this.value)"></select>
        </div>
        <div class="action-buttons">
            <button class="control-btn" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);" onclick="createNewStrategy()">+ New</button>
            <button class="control-btn" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);" onclick="loadSampleStrategy()">üìù Sample</button>
            <button class="control-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="updateAIInsights()">ü§ñ AI Insights</button>
            <button class="control-btn" style="background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);" onclick="exportToPDF()">üìÑ PDF</button>
            <!-- NEW THEME TOGGLE BUTTON -->
            <button class="control-btn" style="background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);" onclick="toggleTheme()">üåì Theme</button>
            <button class="control-btn" style="background: linear-gradient(135deg, #805ad5 0%, #6b46c1 100%);" onclick="manualSave()">üíæ Save</button>
        </div>
    </div>
    <div class="save-indicator">
        <span id="save-indicator">üü¢ Auto-save enabled</span>
    </div>
</div>

<div class="page">
    <div class="header">
        <div style="font-size: 0.9rem; font-style: italic;">Miller Heiman</div>
        <h1>STRATEGIC ANALYSIS</h1>
        <div style="font-size: 0.7rem;">STRATEGIC SELLING¬Æ</div>
    </div>
    
    <!-- TOP SECTION: Account Info -->
    <div class="top-section">
        <div class="left-panel">
            <div class="section-row">
                <div class="section-label">Account:</div>
                <div class="section-content">
                    <input type="text" id="account" placeholder="Enter account name">
                </div>
            </div>
            <div class="section-row">
                <div class="section-label">Opportunity:</div>
                <div class="section-content">
                    <input type="text" id="opportunity" placeholder="Enter opportunity">
                </div>
            </div>
            <div class="section-row">
                <div class="section-label">Date:</div>
                <div class="section-content">
                    <input type="date" id="date">
                </div>
            </div>
        </div>
        
        <div>
            <div class="adequacy-box">
                <strong>ADEQUACY OF CURRENT POSITION:</strong>
                <div class="adequacy-grid">
                    <div class="adequacy-item">
                        <div>Euphoria</div>
                        <input type="radio" name="adequacy" value="euphoria">
                    </div>
                    <div class="adequacy-item">
                        <div>Great</div>
                        <input type="radio" name="adequacy" value="great">
                    </div>
                    <div class="adequacy-item">
                        <div>Secure</div>
                        <input type="radio" name="adequacy" value="secure">
                    </div>
                    <div class="adequacy-item">
                        <div>OK</div>
                        <input type="radio" name="adequacy" value="ok">
                    </div>
                    <div class="adequacy-item">
                        <div>Concern</div>
                        <input type="radio" name="adequacy" value="concern">
                    </div>
                    <div class="adequacy-item">
                        <div>Worry</div>
                        <input type="radio" name="adequacy" value="worry">
                    </div>
                    <div class="adequacy-item">
                        <div>Panic</div>
                        <input type="radio" name="adequacy" value="panic">
                    </div>
                </div>
            </div>
            <div class="ideal-customer">
                <strong>IDEAL CUSTOMER CRITERIA:</strong>
                <textarea id="ideal-customer" placeholder="Define the key criteria that make this customer ideal for your solution..."></textarea>
            </div>
        </div>
    </div>
    
    <!-- COMPETITION SECTION -->
    <div class="section-row">
        <div class="section-label">Competition:</div>
        <div class="section-content">
            <textarea id="competition" placeholder="Describe the competitive landscape for this opportunity..."></textarea>
        </div>
    </div>
    
    <div class="section-row">
        <div class="section-label">Specify Competitors:</div>
        <div class="section-content">
            <input type="text" id="competitors-list" placeholder="List specific competitors involved...">
        </div>
    </div>
    
    <!-- SSO SECTION -->
    <div class="sso-section">
        <div class="section-label" style="background: rgba(230,230,230,0.06); font-weight: bold;">SINGLE SALES OBJECTIVE</div>
        <div class="sso-content">
            <textarea id="sso" placeholder="Describe your single, measurable sales objective for this opportunity..."></textarea>
        </div>
        <div class="sso-content">
            <strong style="font-size: 0.75rem;">My Position vs Competition:</strong>
            <div class="checkbox-group">
                <label><input type="radio" name="position" value="only"> Only Alternative</label>
                <label><input type="radio" name="position" value="front"> Front Runner</label>
                <label><input type="radio" name="position" value="staged"> Staged</label>
            </div>
        </div>
        <div class="sso-content">
            <strong style="font-size: 0.75rem;">Place in Sales Funnel:</strong>
            <div class="checkbox-group">
                <label><input type="radio" name="funnel" value="universe"> Universe</label>
                <label><input type="radio" name="funnel" value="above"> Above</label>
                <label><input type="radio" name="funnel" value="in"> In</label>
            </div>
        </div>
        <div class="sso-content">
            <strong style="font-size: 0.75rem;">Timing for Priorities:</strong>
            <div class="checkbox-group">
                <label><input type="radio" name="timing" value="urgent"> Urgent</label>
                <label><input type="radio" name="timing" value="active"> Active</label>
                <label><input type="radio" name="timing" value="later"> Later</label>
            </div>
        </div>
    </div>
    
    <!-- ROLES SECTION -->
    <div class="roles-section">
        <div class="role-box">
            <strong>ROLES</strong>
            <div>E = Economic</div>
            <div>T = Technical</div>
            <div>U = User</div>
            <div>C = Coach</div>
        </div>
        <div class="role-box">
            <strong>DEGREE OF INFLUENCE</strong>
            <div>H = High</div>
            <div>M = Medium</div>
            <div>L = Low</div>
        </div>
        <div class="role-box">
            <strong>MODE</strong>
            <div>G = Growth</div>
            <div>T = Trouble</div>
            <div>EK = Even Keel</div>
            <div>OC = Overconfident</div>
        </div>
    </div>
    
    <div class="note-box">
        <strong>NOTE:</strong> Win-Results Statement: a short statement of the personal Win that a Buying Influence desires when important measurable business Results are delivered.
    </div>
    
    <!-- BUYING INFLUENCES TABLE - MIDDLE OF FORM -->
    <table class="buying-influences-table">
        <thead>
            <tr>
                <th style="width: 200px;">BUYING INFLUENCES INVOLVED<br><span style="font-weight: normal; font-size: 10px;">(NAME/TITLE, LOCATION)</span></th>
                <th style="width: 60px;">ROLE</th>
                <th style="width: 60px;">DEGREE</th>
                <th style="width: 60px;">MODE</th>
                <th style="width: 250px;">KEY WIN - RESULTS<br><span style="font-weight: normal; font-size: 10px;">(WIN RESULTS STATEMENT)</span></th>
                <th style="width: 60px;">RATING</th>
                <th style="width: 250px;">BASE COVERED?<br><span style="font-weight: normal; font-size: 10px;">(EVIDENCE)</span></th>
                <th style="width: 50px;"></th>
            </tr>
        </thead>
        <tbody id="buyersTableBody">
        </tbody>
    </table>
    
    <button class="add-row-btn" onclick="addBuyerRow()">+ Add Buying Influence</button>
    
    <!-- BOTTOM SECTION: Three Columns -->
    <div class="bottom-section">
        <div class="bottom-box">
            <div class="bottom-header">SUMMARY OF MY POSITION TODAY</div>
            <div class="bottom-content">
                <div style="margin-bottom: 15px;">
                    <strong>üí™ STRENGTHS:</strong>
                    <textarea id="strengths" placeholder="List your key strengths in this opportunity..."></textarea>
                </div>
                <div>
                    <strong>üö© RED FLAGS:</strong>
                    <textarea id="red-flags" placeholder="Highlight any risks or red flags you see..."></textarea>
                </div>
            </div>
        </div>
        
        <div class="bottom-box">
            <div class="bottom-header">POSSIBLE ACTIONS</div>
            <div class="bottom-content">
                <textarea id="possible-actions" placeholder="Brainstorm potential actions you could take to improve your position..."></textarea>
            </div>
        </div>
        
        <div class="bottom-box">
            <div class="bottom-header">BEST ACTION PLAN</div>
            <div class="bottom-content">
                <table class="action-table">
                    <thead>
                        <tr>
                            <th>WHAT:</th>
                            <th>WHO:</th>
                            <th>WHEN:</th>
                            <th style="width: 50px;"></th>
                        </tr>
                    </thead>
                    <tbody id="actionTableBody">
                    </tbody>
                </table>
                <button class="add-row-btn" onclick="addActionRow()">+ Add Action</button>
                
                <div style="margin-top: 20px;">
                    <strong style="font-size: 0.75rem;">INFORMATION NEEDED:</strong>
                    <table class="action-table" style="margin-top: 5px;">
                        <thead>
                            <tr>
                                <th>FROM WHOM:</th>
                                <th>WHEN:</th>
                                <th style="width: 50px;"></th>
                            </tr>
                        </thead>
                        <tbody id="infoTableBody">
                        </tbody>
                    </table>
                    <button class="add-row-btn" onclick="addInfoRow()">+ Add Info Need</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AI INSIGHTS PANEL -->
    <div class="ai-insights-panel" id="ai-insights-panel">
        <div class="ai-header">
            <div class="ai-icon">ü§ñ</div>
            <div class="ai-title">AI Strategic Insights</div>
            <div class="ai-score" id="strategic-score">0%</div>
        </div>
        
        <div id="ai-content-area">
            <div style="padding: 2rem; text-align: center; color: rgba(255,255,255,0.6);">
                <p style="font-size: 1.2rem; margin-bottom: 0.5rem;">üí° Start filling in your strategy</p>
                <p style="font-size: 0.9rem;">AI insights will appear as you complete each section</p>
            </div>
        </div>
    </div>
</div>

<script>
    let strategies = {};
    let currentStrategyId = null;

    function loadFromStorage() {
        const saved = localStorage.getItem('millerHeimanStrategies');
        if (saved) strategies = JSON.parse(saved);
    }

    function saveToStorage() {
        localStorage.setItem('millerHeimanStrategies', JSON.stringify(strategies));
        document.getElementById('save-indicator').innerHTML = '‚úì Saved';
    }

    function createEmptyStrategy(name) {
        return {
            id: 'strategy-' + Date.now(),
            clientName: name,
            data: {
                account: '', opportunity: '', date: '', adequacy: '',
                idealCustomer: '', competition: '', competitorsList: '', sso: '',
                position: '', funnel: '', timing: '',
                buyingInfluences: [], strengths: '', redFlags: '',
                possibleActions: '', actions: [], infoNeeds: []
            }
        };
    }

    function createSampleStrategy1() {
        // Deal 1: EXCELLENT - Well Qualified Enterprise Deal
        const sample = createEmptyStrategy('TechFlow Solutions');
        sample.data.account = 'TechFlow Solutions Ltd';
        sample.data.opportunity = 'Marketing Automation Platform - 350 users';
        sample.data.date = '2026-01-06';
        sample.data.adequacy = 'great';
        sample.data.idealCustomer = 'Mid-market B2B SaaS companies (250-500 employees) experiencing rapid growth, current manual marketing processes limiting scale, budget ¬£100K-200K, decision timeline Q1 2026.';
        sample.data.competition = 'Primary: HubSpot (incumbent, no Salesforce integration). Secondary: Marketo (too complex/expensive). Alternative: Status quo with manual processes (unacceptable per CEO mandate).';
        sample.data.competitorsList = 'HubSpot, Marketo, Internal Build (rejected)';
        sample.data.sso = 'Close ¬£125K annual contract by March 31st 2026 for Marketing Automation Platform with 350 user licenses, Salesforce integration, and 90-day implementation.';
        sample.data.position = 'front';
        sample.data.funnel = 'in';
        sample.data.timing = 'urgent';
        sample.data.buyingInfluences = [
            { name: 'Jane Roberts, CMO', role: 'E', influence: 'H', mode: 'G', 
              winResults: 'WIN: Career advancement through revenue growth\nRESULTS: Increase lead conversion 10-15%, save 30hrs/week admin time, enable ¬£1.44M revenue increase', 
              rating: '9', evidence: '4 meetings completed, budget approved, scheduled exec presentation Jan 12th' },
            { name: 'David Chen, Marketing Ops Manager', role: 'C', influence: 'M', mode: 'G',
              winResults: 'WIN: Become strategic partner to CMO, own high-visibility project\nRESULTS: Deliver on-time implementation, build automation expertise',
              rating: '9', evidence: 'Built internal business case, provided competitive intel, scheduled our CMO meeting' },
            { name: 'Mike Patterson, CRO', role: 'E', influence: 'H', mode: 'G',
              winResults: 'WIN: Hit Q3 revenue targets with better lead quality\nRESULTS: 25% increase in MQL to SQL conversion, better sales/marketing alignment',
              rating: '8', evidence: 'Attended demo, endorsed solution, aligned on lead scoring criteria' },
            { name: 'Sarah Kim, IT Director', role: 'T', influence: 'M', mode: 'EK',
              winResults: 'WIN: Easy integration, no security issues\nRESULTS: Salesforce API integration validated, SOC2 compliance confirmed',
              rating: '7', evidence: 'Technical validation completed, integration plan approved' }
        ];
        sample.data.strengths = 'üí™ Strong Economic Buyer relationships (CMO 9/10, CRO 8/10)\nüí™ Active Coach providing intelligence and access\nüí™ Front runner position - HubSpot lacks critical integration\nüí™ Urgent CEO mandate creates buying pressure\nüí™ Quantified business case: ¬£1.44M revenue impact\nüí™ Budget approved, decision timeline set (Q1)';
        sample.data.redFlags = 'üö© IT Director in Even Keel mode - needs engagement\nüö© Must close by March 31st - tight timeline\nüö© HubSpot will likely counter with aggressive pricing';
        sample.data.possibleActions = 'Executive Business Review with CEO\nCustomer reference call with similar company\nDetailed ROI workshop with Finance\nProof of concept for Salesforce integration\nNegotiate early-close discount';
        sample.data.actions = [
            { what: 'Schedule exec presentation', who: 'David Chen (Coach)', when: '2026-01-12' },
            { what: 'Customer reference call', who: 'Jane Roberts (CMO)', when: '2026-01-20' },
            { what: 'Contract negotiation', who: 'Procurement + Legal', when: '2026-02-15' }
        ];
        sample.data.infoNeeds = [
            { from: 'David Chen', when: '2026-01-08' },
            { from: 'CFO approval timeline', when: '2026-01-15' }
        ];
        return sample;
    }

    function createSampleStrategy2() {
        // Deal 2: MODERATE - Missing Coach, Trouble Mode Buyer
        const sample = createEmptyStrategy('GlobalRetail Systems');
        sample.data.account = 'GlobalRetail Systems PLC';
        sample.data.opportunity = 'Inventory Management System - 8 warehouses';
        sample.data.date = '2026-01-06';
        sample.data.adequacy = 'ok';
        sample.data.idealCustomer = 'Multi-location retailers (5-15 warehouses) with inventory accuracy issues, ERP integration required, budget ¬£75K-150K, 6-month decision cycle.';
        sample.data.competition = 'Oracle NetSuite (existing Oracle ERP), SAP (too expensive), Status quo (board pressure to fix).';
        sample.data.competitorsList = 'Oracle NetSuite, SAP, Blue Yonder';
        sample.data.sso = 'Win ¬£85K contract for Inventory Management System covering 8 warehouses by April 30th 2026, achieving <2% error rate improvement.';
        sample.data.position = 'staged';
        sample.data.funnel = 'in';
        sample.data.timing = 'active';
        sample.data.buyingInfluences = [
            { name: 'Simon Taylor, CFO', role: 'E', influence: 'H', mode: 'T', 
              winResults: 'WIN: Reduce inventory risk exposure, avoid audit findings\nRESULTS: Cut ¬£240K annual writeoffs to <¬£60K, pass Q2 audit', 
              rating: '5', evidence: 'Met once, concerned about implementation risk, wants 3 vendor comparison' },
            { name: 'Rachel Moore, COO', role: 'U', influence: 'H', mode: 'G',
              winResults: 'WIN: Prove operational excellence, build credibility with board\nRESULTS: Fix inventory accuracy from 87% to 98%+, reduce stock-outs',
              rating: '7', evidence: 'Strong advocate, ran successful pilot in 2 warehouses' },
            { name: 'Tom Anderson, VP Supply Chain', role: 'T', influence: 'M', mode: 'G',
              winResults: 'WIN: Get modern tools for team, reduce manual work\nRESULTS: Real-time visibility across all warehouses, mobile scanning',
              rating: '6', evidence: 'Participated in pilot, provided requirements, generally supportive' }
        ];
        sample.data.strengths = 'üí™ Successful pilot in 2 warehouses (87% to 95% accuracy)\nüí™ COO is strong advocate after seeing results\nüí™ Board mandate to fix inventory issues\nüí™ Failed audit creates urgency';
        sample.data.redFlags = 'üö© CFO in Trouble mode - risk averse, wants 3-vendor bake-off\nüö© NO COACH - no inside intelligence on decision process\nüö© Staged position - Oracle NetSuite actively competing\nüö© CFO relationship weak (5/10) - needs strengthening\nüö© Missing: Finance committee timeline and approval process';
        sample.data.possibleActions = 'Deep dive with CFO on risk mitigation\nSecond pilot in high-volume warehouse\nCustomer references in retail sector\nFinance-focused ROI analysis\nDevelop Coach relationship with someone close to CFO';
        sample.data.actions = [
            { what: 'CFO risk mitigation meeting', who: 'Simon Taylor', when: '2026-01-15' },
            { what: 'Expand pilot to warehouse 3', who: 'Rachel Moore', when: '2026-02-01' }
        ];
        sample.data.infoNeeds = [
            { from: 'Finance committee meeting schedule', when: '2026-01-10' },
            { from: 'Oracle pricing and timeline', when: '2026-01-20' }
        ];
        return sample;
    }

    function createSampleStrategy3() {
        // Deal 3: WEAK - No Economic Buyer Access, Early Stage
        const sample = createEmptyStrategy('DataCorp Analytics');
        sample.data.account = 'DataCorp Analytics Inc';
        sample.data.opportunity = 'Business Intelligence Platform - 200 users';
        sample.data.date = '2026-01-06';
        sample.data.adequacy = 'concern';
        sample.data.idealCustomer = 'Data-driven companies needing modern BI, replacing legacy tools, budget ¬£80K-120K, need cloud-based solution.';
        sample.data.competition = 'Unclear - still early discovery. Mentioned Tableau, PowerBI, Qlik. May have incumbent we do not know about.';
        sample.data.competitorsList = 'Tableau, Microsoft PowerBI, Qlik, Unknown incumbent?';
        sample.data.sso = 'Unclear - need to define specific measurable objective. Vague goal of "better reporting and dashboards."';
        sample.data.position = 'staged';
        sample.data.funnel = 'universe';
        sample.data.timing = 'later';
        sample.data.buyingInfluences = [
            { name: 'James Wilson, IT Manager', role: 'T', influence: 'L', mode: 'EK', 
              winResults: 'WIN: Get modern tools, less manual reporting work\nRESULTS: Not clearly defined', 
              rating: '4', evidence: 'Initial call only, "just exploring options", no urgency indicated' },
            { name: 'Unknown - CFO', role: 'E', influence: 'H', mode: '', 
              winResults: 'Unknown - no access yet',
              rating: '', evidence: 'Not identified - IT Manager has not offered introduction' }
        ];
        sample.data.strengths = 'üí™ IT Manager expressed interest in product demo\nüí™ Company is growing and generating more data';
        sample.data.redFlags = 'üö© NO ECONOMIC BUYER ACCESS - critical blocker\nüö© IT Manager has low influence - wrong entry point\nüö© "Later" timing - no urgency or compelling event\nüö© Universe funnel position - not qualified yet\nüö© SSO undefined - no clear measurable goal\nüö© Competition unknown - likely others involved\nüö© No pain articulated - "nice to have" vs "must have"\nüö© No Coach identified - no internal intelligence\nüö© IT Manager in Even Keel mode - satisfied with status quo';
        sample.data.possibleActions = 'Qualify or disqualify this opportunity\nRequest introduction to business stakeholders\nUncover compelling event or business pain\nDefine clear SSO with measurable outcomes\nIdentify Economic Buyer and decision process\nFind Coach who can provide competitive intel';
        sample.data.actions = [
            { what: 'Qualify pain and urgency', who: 'James Wilson', when: '2026-01-10' },
            { what: 'Request business stakeholder intro', who: 'James Wilson', when: '2026-01-15' }
        ];
        sample.data.infoNeeds = [
            { from: 'Who is Economic Buyer? CFO or CIO?', when: '2026-01-10' },
            { from: 'What is decision process and timeline?', when: '2026-01-10' },
            { from: 'Who else is being evaluated?', when: '2026-01-10' }
        ];
        sample.data.possibleActions = 'QUALIFY OR DISQUALIFY: This deal shows multiple red flags. Options:\n\n1. Aggressive Requalification: Request business stakeholder meeting within 2 weeks or deprioritize\n2. Find Pain: Uncover business issue driving need (compliance, audit, board mandate)\n3. Get Economic Buyer: No deal closes without EB access - make this condition #1\n4. Create Urgency: Find or create compelling event (fiscal year end, competitive threat)\n5. Disqualify: If no EB access in 30 days, move to "parked" status';
        return sample;
    }

    function createSampleStrategy4() {
        // Deal 4: GOOD - Strong Foundation, Needs Action Plan
        const sample = createEmptyStrategy('ManuCorp Industries');
        sample.data.account = 'ManuCorp Industries Ltd';
        sample.data.opportunity = 'Supply Chain Visibility Platform - 140 suppliers';
        sample.data.date = '2026-01-06';
        sample.data.adequacy = 'secure';
        sample.data.idealCustomer = 'Manufacturing companies (¬£50M-500M revenue) with complex supply chains, experiencing supplier delays, need real-time visibility, budget ¬£50K-100K.';
        sample.data.competition = 'Kinaxis (too expensive, complex), Local vendor (lacks features), Status quo (unacceptable per CEO), Build in-house (IT rejected).';
        sample.data.competitorsList = 'Kinaxis, SupplyStream Solutions, Status Quo';
        sample.data.sso = 'Close ¬£58K contract by March 20th 2026 for Supply Chain Platform covering 140 suppliers, achieving 60% reduction in delays and <5% defect rate.';
        sample.data.position = 'front';
        sample.data.funnel = 'in';
        sample.data.timing = 'urgent';
        sample.data.buyingInfluences = [
            { name: 'Paul Edwards, VP Operations', role: 'E', influence: 'H', mode: 'T', 
              winResults: 'WIN: Fix Q4 production crisis, save job/bonus at risk\nRESULTS: Reduce supplier delays 60%, cut defects from 12% to <5%, board report March 30th', 
              rating: '7', evidence: 'Met 3 times, under CEO pressure after ¬£280K Q4 losses, personal urgency high' },
            { name: 'Linda Chen, Supply Chain Director', role: 'C', influence: 'M', mode: 'G',
              winResults: 'WIN: Be hero who fixes supply chain, get recognition\nRESULTS: Deliver pilot success, present solution to board, expand role',
              rating: '9', evidence: 'Strong Coach - built ROI model, ran pilot, secured approval, sharing competitor intel' },
            { name: 'Andy Morrison, Procurement Director', role: 'U', influence: 'M', mode: 'G',
              winResults: 'WIN: Better supplier relationships, reduce firefighting\nRESULTS: Real-time supplier visibility, collaborative planning tools',
              rating: '8', evidence: 'Pilot champion, mobilizing supplier onboarding, enthusiastic user advocate' },
            { name: 'Lisa Patterson, Quality Manager', role: 'U', influence: 'M', mode: 'T',
              winResults: 'WIN: Reduce quality issues before they impact production\nRESULTS: Early warning system for supplier quality problems',
              rating: '6', evidence: 'Participated in pilot, concerned about data accuracy, needs reassurance' }
        ];
        sample.data.strengths = 'üí™ Economic Buyer identified with personal urgency (bonus at risk)\nüí™ Excellent Coach (9/10) - Linda providing competitive intel\nüí™ Successful pilot completed - proven results\nüí™ Front runner position after pilot success\nüí™ CEO mandate and board visibility creates urgency\nüí™ Strong user champions (Andy 8/10)\nüí™ Board report March 30th - hard deadline';
        sample.data.redFlags = 'üö© VP Operations in Trouble mode - under performance pressure\nüö© Quality Manager concerned about data accuracy\nüö© Kinaxis may drop pricing to compete\nüö© Limited action plan - need specific next steps with dates';
        sample.data.possibleActions = 'Quality Manager deep dive - address data accuracy concerns\nVP Operations - business case presentation showing risk mitigation\nSecure verbal commitment before competitor counters\nCustomer reference in manufacturing sector\nEarly close incentive (10% discount for Feb close)\nBoard presentation prep with Linda (Coach)';
        sample.data.actions = [
            { what: 'Quality Manager data accuracy session', who: 'Lisa Patterson', when: '2026-01-14' },
            { what: 'VP Ops final business case review', who: 'Paul Edwards', when: '2026-01-20' },
            { what: 'Board presentation dry run', who: 'Linda Chen', when: '2026-02-15' },
            { what: 'Contract negotiation kickoff', who: 'Procurement + Legal', when: '2026-02-20' }
        ];
        sample.data.infoNeeds = [
            { from: 'Kinaxis pricing - Linda (Coach)', when: '2026-01-12' },
            { from: 'Board presentation date confirmed', when: '2026-01-15' },
            { from: 'Contract approval authority limits', when: '2026-01-18' }
        ];
        return sample;
    }

    function loadSampleStrategy() {
        // Load all 4 sample deals at once
        const sample1 = createSampleStrategy1();
        const sample2 = createSampleStrategy2();
        const sample3 = createSampleStrategy3();
        const sample4 = createSampleStrategy4();
        
        strategies[sample1.id] = sample1;
        strategies[sample2.id] = sample2;
        strategies[sample3.id] = sample3;
        strategies[sample4.id] = sample4;
        
        // Load the first deal (TechFlow - Excellent)
        currentStrategyId = sample1.id;
        saveToStorage();
        renderStrategySelector();
        loadStrategy(sample1.id);
        
        alert('‚úÖ 4 Sample Deals Loaded!\n\n1. TechFlow Solutions (88% - Excellent)\n2. GlobalRetail Systems (62% - Moderate)\n3. DataCorp Analytics (28% - Weak)\n4. ManuCorp Industries (78% - Good)\n\nUse the dropdown to switch between deals.');
    }

    function initializeStrategies() {
        loadFromStorage();
        if (Object.keys(strategies).length === 0) {
            const first = createEmptyStrategy('New Client');
            strategies[first.id] = first;
            currentStrategyId = first.id;
            saveToStorage();
        } else {
            currentStrategyId = Object.keys(strategies)[0];
        }
        renderStrategySelector();
        loadStrategy(currentStrategyId);
    }

    function renderStrategySelector() {
        const select = document.getElementById('strategy-select');
        select.innerHTML = Object.entries(strategies).map(([id, s]) => 
            `<option value="${id}" ${id === currentStrategyId ? 'selected' : ''}>
                ${s.clientName} - ${s.data.account || 'Untitled'}
            </option>`
        ).join('');
    }

    function createNewStrategy() {
        const name = prompt('Enter client name:');
        if (!name) return;
        const newS = createEmptyStrategy(name);
        strategies[newS.id] = newS;
        currentStrategyId = newS.id;
        renderStrategySelector();
        loadStrategy(newS.id);
        saveToStorage();
    }

    function switchStrategy(id) {
        saveCurrentStrategy();
        currentStrategyId = id;
        loadStrategy(id);
    }

    function saveCurrentStrategy() {
        if (!currentStrategyId) return;
        const s = strategies[currentStrategyId];
        s.data.account = document.getElementById('account').value;
        s.data.opportunity = document.getElementById('opportunity').value;
        s.data.date = document.getElementById('date').value;
        s.data.idealCustomer = document.getElementById('ideal-customer').value;
        s.data.competition = document.getElementById('competition').value;
        s.data.competitorsList = document.getElementById('competitors-list').value;
        s.data.sso = document.getElementById('sso').value;
        s.data.strengths = document.getElementById('strengths').value;
        s.data.redFlags = document.getElementById('red-flags').value;
        s.data.possibleActions = document.getElementById('possible-actions').value;
        
        const adequacy = document.querySelector('input[name="adequacy"]:checked');
        s.data.adequacy = adequacy ? adequacy.value : '';
        const position = document.querySelector('input[name="position"]:checked');
        s.data.position = position ? position.value : '';
        const funnel = document.querySelector('input[name="funnel"]:checked');
        s.data.funnel = funnel ? funnel.value : '';
        const timing = document.querySelector('input[name="timing"]:checked');
        s.data.timing = timing ? timing.value : '';
        
        s.data.buyingInfluences = [];
        document.querySelectorAll('#buyersTableBody tr').forEach(row => {
            const cells = row.querySelectorAll('td');
            if (cells.length >= 7) {
                s.data.buyingInfluences.push({
                    name: cells[0].querySelector('input').value,
                    role: cells[1].querySelector('select').value,
                    influence: cells[2].querySelector('select').value,
                    mode: cells[3].querySelector('select').value,
                    winResults: cells[4].querySelector('textarea').value,
                    rating: cells[5].querySelector('input').value,
                    evidence: cells[6].querySelector('textarea').value
                });
            }
        });
        
        // Save actions
        s.data.actions = [];
        document.querySelectorAll('#actionTableBody tr').forEach(row => {
            const cells = row.querySelectorAll('td');
            if (cells.length >= 3) {
                s.data.actions.push({
                    what: cells[0].querySelector('input').value,
                    who: cells[1].querySelector('input').value,
                    when: cells[2].querySelector('input').value
                });
            }
        });
        
        // Save info needs
        s.data.infoNeeds = [];
        document.querySelectorAll('#infoTableBody tr').forEach(row => {
            const cells = row.querySelectorAll('td');
            if (cells.length >= 2) {
                s.data.infoNeeds.push({
                    from: cells[0].querySelector('input').value,
                    when: cells[1].querySelector('input').value
                });
            }
        });
    }

    function loadStrategy(id) {
        const s = strategies[id];
        document.getElementById('account').value = s.data.account || '';
        document.getElementById('opportunity').value = s.data.opportunity || '';
        document.getElementById('date').value = s.data.date || '';
        document.getElementById('ideal-customer').value = s.data.idealCustomer || '';
        document.getElementById('competition').value = s.data.competition || '';
        document.getElementById('competitors-list').value = s.data.competitorsList || '';
        document.getElementById('sso').value = s.data.sso || '';
        document.getElementById('strengths').value = s.data.strengths || '';
        document.getElementById('red-flags').value = s.data.redFlags || '';
        document.getElementById('possible-actions').value = s.data.possibleActions || '';
        
        if (s.data.adequacy) {
            const r = document.querySelector(`input[name="adequacy"][value="${s.data.adequacy}"]`);
            if (r) r.checked = true;
        }
        if (s.data.position) {
            const r = document.querySelector(`input[name="position"][value="${s.data.position}"]`);
            if (r) r.checked = true;
        }
        if (s.data.funnel) {
            const r = document.querySelector(`input[name="funnel"][value="${s.data.funnel}"]`);
            if (r) r.checked = true;
        }
        if (s.data.timing) {
            const r = document.querySelector(`input[name="timing"][value="${s.data.timing}"]`);
            if (r) r.checked = true;
        }
        
        const tbody = document.getElementById('buyersTableBody');
        tbody.innerHTML = '';
        if (s.data.buyingInfluences && s.data.buyingInfluences.length > 0) {
            s.data.buyingInfluences.forEach(b => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td><input type="text" value="${b.name || ''}" placeholder="Name, Title"></td>
                    <td><select>
                        <option value="">-</option>
                        <option value="E" ${b.role === 'E' ? 'selected' : ''}>E</option>
                        <option value="T" ${b.role === 'T' ? 'selected' : ''}>T</option>
                        <option value="U" ${b.role === 'U' ? 'selected' : ''}>U</option>
                        <option value="C" ${b.role === 'C' ? 'selected' : ''}>C</option>
                    </select></td>
                    <td><select>
                        <option value="">-</option>
                        <option value="H" ${b.influence === 'H' ? 'selected' : ''}>H</option>
                        <option value="M" ${b.influence === 'M' ? 'selected' : ''}>M</option>
                        <option value="L" ${b.influence === 'L' ? 'selected' : ''}>L</option>
                    </select></td>
                    <td><select>
                        <option value="">-</option>
                        <option value="G" ${b.mode === 'G' ? 'selected' : ''}>G</option>
                        <option value="T" ${b.mode === 'T' ? 'selected' : ''}>T</option>
                        <option value="EK" ${b.mode === 'EK' ? 'selected' : ''}>EK</option>
                        <option value="OC" ${b.mode === 'OC' ? 'selected' : ''}>OC</option>
                    </select></td>
                    <td><textarea placeholder="Win-Results">${b.winResults || ''}</textarea></td>
                    <td><input type="number" value="${b.rating || ''}" min="-5" max="10" placeholder="0"></td>
                    <td><textarea placeholder="Evidence">${b.evidence || ''}</textarea></td>
                    <td><button class="delete-row-btn" onclick="deleteBuyerRow(this)">√ó</button></td>
                `;
            });
        } else {
            addBuyerRow();
        }
        
        // Load action items
        const actionTbody = document.getElementById('actionTableBody');
        actionTbody.innerHTML = '';
        if (s.data.actions && s.data.actions.length > 0) {
            s.data.actions.forEach(a => {
                const row = actionTbody.insertRow();
                row.innerHTML = `
                    <td><input type="text" value="${a.what || ''}" placeholder="Action"></td>
                    <td><input type="text" value="${a.who || ''}" placeholder="Owner"></td>
                    <td><input type="date" value="${a.when || ''}"></td>
                    <td><button class="delete-row-btn" onclick="this.closest('tr').remove()">√ó</button></td>
                `;
            });
        }
        
        // Load information needs
        const infoTbody = document.getElementById('infoTableBody');
        infoTbody.innerHTML = '';
        if (s.data.infoNeeds && s.data.infoNeeds.length > 0) {
            s.data.infoNeeds.forEach(i => {
                const row = infoTbody.insertRow();
                row.innerHTML = `
                    <td><input type="text" value="${i.from || ''}" placeholder="Info needed from whom?"></td>
                    <td><input type="date" value="${i.when || ''}"></td>
                    <td><button class="delete-row-btn" onclick="this.closest('tr').remove()">√ó</button></td>
                `;
            });
        }
        
        // Update AI insights when strategy is loaded
        setTimeout(updateAIInsights, 100);
    }

    function addBuyerRow() {
        const tbody = document.getElementById('buyersTableBody');
        const row = tbody.insertRow();
        row.innerHTML = `
            <td><input type="text" placeholder="Name, Title"></td>
            <td><select>
                <option value="">-</option>
                <option value="E">E</option>
                <option value="T">T</option>
                <option value="U">U</option>
                <option value="C">C</option>
            </select></td>
            <td><select>
                <option value="">-</option>
                <option value="H">H</option>
                <option value="M">M</option>
                <option value="L">L</option>
            </select></td>
            <td><select>
                <option value="">-</option>
                <option value="G">G</option>
                <option value="T">T</option>
                <option value="EK">EK</option>
                <option value="OC">OC</option>
            </select></td>
            <td><textarea placeholder="Win-Results"></textarea></td>
            <td><input type="number" min="-5" max="10" placeholder="0"></td>
            <td><textarea placeholder="Evidence"></textarea></td>
            <td><button class="delete-row-btn" onclick="deleteBuyerRow(this)">√ó</button></td>
        `;
    }

    function deleteBuyerRow(btn) {
        btn.closest('tr').remove();
        saveCurrentStrategy();
        saveToStorage();
    }

    function addActionRow() {
        const tbody = document.getElementById('actionTableBody');
        const row = tbody.insertRow();
        row.innerHTML = `
            <td><input type="text" placeholder="Action"></td>
            <td><input type="text" placeholder="Owner"></td>
            <td><input type="date"></td>
            <td><button class="delete-row-btn" onclick="this.closest('tr').remove()">√ó</button></td>
        `;
    }

    function addInfoRow() {
        const tbody = document.getElementById('infoTableBody');
        const row = tbody.insertRow();
        row.innerHTML = `
            <td><input type="text" placeholder="Info needed from whom?"></td>
            <td><input type="date"></td>
            <td><button class="delete-row-btn" onclick="this.closest('tr').remove()">√ó</button></td>
        `;
    }

    function manualSave() {
        saveCurrentStrategy();
        saveToStorage();
        alert('Saved!');
    }

    function exportToPDF() {
        saveCurrentStrategy();
        window.print();
    }

    // THEME TOGGLE
    function toggleTheme() {
        document.body.classList.toggle('light-theme');
        const theme = document.body.classList.contains('light-theme') ? 'light' : 'dark';
        localStorage.setItem('mhTheme', theme);
    }

    document.addEventListener('input', function() {
        clearTimeout(window.saveTimer);
        window.saveTimer = setTimeout(() => {
            saveCurrentStrategy();
            saveToStorage();
            updateAIInsights();
        }, 2000);
    });
    
    document.addEventListener('change', function() {
        // Immediate update for radio buttons and selects
        updateAIInsights();
    });

    window.addEventListener('beforeunload', function() {
        saveCurrentStrategy();
        saveToStorage();
    });

    // AI STRATEGIC COACHING ENGINE
    function calculateStrategicScore() {
        let score = 0;
        let maxScore = 100;
        
        // Account Info (10 points)
        const account = document.getElementById('account').value;
        const opportunity = document.getElementById('opportunity').value;
        if (account && account.length > 5) score += 5;
        if (opportunity && opportunity.length > 10) score += 5;
        
        // Adequacy Assessment (10 points)
        const adequacy = document.querySelector('input[name="adequacy"]:checked');
        if (adequacy) score += 10;
        
        // Ideal Customer (10 points)
        const idealCustomer = document.getElementById('ideal-customer').value;
        if (idealCustomer && idealCustomer.length > 50) score += 10;
        else if (idealCustomer && idealCustomer.length > 20) score += 5;
        
        // Competition Analysis (10 points)
        const competition = document.getElementById('competition').value;
        const competitors = document.getElementById('competitors-list').value;
        if (competition && competition.length > 50) score += 5;
        if (competitors && competitors.length > 10) score += 5;
        
        // Single Sales Objective (15 points)
        const sso = document.getElementById('sso').value;
        const position = document.querySelector('input[name="position"]:checked');
        const funnel = document.querySelector('input[name="funnel"]:checked');
        const timing = document.querySelector('input[name="timing"]:checked');
        if (sso && sso.length > 30) score += 7;
        if (position) score += 3;
        if (funnel) score += 3;
        if (timing) score += 2;
        
        // Buying Influences (25 points)
        const buyerRows = document.querySelectorAll('#buyersTableBody tr');
        const buyersCount = buyerRows.length;
        const economicBuyers = Array.from(buyerRows).filter(row => {
            const roleSelect = row.querySelector('select');
            return roleSelect && roleSelect.value === 'E';
        }).length;
        
        if (buyersCount >= 4) score += 10;
        else if (buyersCount >= 2) score += 5;
        if (economicBuyers >= 1) score += 10;
        if (buyersCount > 0) {
            const completeRows = Array.from(buyerRows).filter(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length < 7) return false;
                const name = cells[0].querySelector('input').value;
                const winResults = cells[4].querySelector('textarea').value;
                return name && name.length > 5 && winResults && winResults.length > 20;
            }).length;
            score += Math.min(5, completeRows * 2);
        }
        
        // Strengths & Red Flags (10 points)
        const strengths = document.getElementById('strengths').value;
        const redFlags = document.getElementById('red-flags').value;
        if (strengths && strengths.length > 30) score += 5;
        if (redFlags && redFlags.length > 20) score += 5;
        
        // Action Plan (10 points)
        const actionRows = document.querySelectorAll('#actionTableBody tr');
        if (actionRows.length >= 3) score += 7;
        else if (actionRows.length >= 1) score += 4;
        const infoRows = document.querySelectorAll('#infoTableBody tr');
        if (infoRows.length >= 1) score += 3;
        
        return Math.round(score);
    }
    
    function analyzeStrategy() {
        const analysis = {
            strengths: [],
            weaknesses: [],
            redFlags: [],
            recommendations: []
        };
        
        const adequacy = document.querySelector('input[name="adequacy"]:checked');
        const adequacyValue = adequacy ? adequacy.value : null;
        
        // Analyze Adequacy
        if (adequacyValue === 'panic' || adequacyValue === 'worry') {
            analysis.redFlags.push("Current position shows high concern - immediate action required");
            analysis.recommendations.push("Focus on identifying and developing Economic Buyer relationships");
        } else if (adequacyValue === 'euphoria') {
            analysis.redFlags.push("Euphoria can indicate blind spots - validate your position");
            analysis.recommendations.push("Challenge assumptions - what could go wrong?");
        } else if (adequacyValue === 'great' || adequacyValue === 'secure') {
            analysis.strengths.push("Solid current position provides foundation for success");
        }
        
        // Analyze Buying Influences
        const buyerRows = document.querySelectorAll('#buyersTableBody tr');
        const economicBuyers = Array.from(buyerRows).filter(row => {
            const roleSelect = row.querySelector('select');
            return roleSelect && roleSelect.value === 'E';
        });
        
        if (economicBuyers.length === 0) {
            analysis.redFlags.push("NO ECONOMIC BUYER identified - deal cannot close without access");
            analysis.recommendations.push("URGENT: Identify and map path to Economic Buyer");
        } else if (economicBuyers.length >= 1) {
            analysis.strengths.push(`${economicBuyers.length} Economic Buyer(s) identified`);
            
            // Check Economic Buyer quality
            economicBuyers.forEach((row, index) => {
                const cells = row.querySelectorAll('td');
                const rating = cells[5].querySelector('input').value;
                const evidence = cells[6].querySelector('textarea').value;
                
                if (rating && parseInt(rating) < 6) {
                    analysis.weaknesses.push(`Economic Buyer #${index + 1} rated ${rating}/10 - needs strengthening`);
                    analysis.recommendations.push("Develop Economic Buyer relationship - what is their personal Win?");
                } else if (rating && parseInt(rating) >= 8) {
                    analysis.strengths.push(`Strong Economic Buyer relationship (${rating}/10)`);
                }
                
                if (!evidence || evidence.length < 20) {
                    analysis.weaknesses.push("Insufficient evidence of Economic Buyer coverage");
                }
            });
        }
        
        // Check for Coach
        const coaches = Array.from(buyerRows).filter(row => {
            const roleSelect = row.querySelector('select');
            return roleSelect && roleSelect.value === 'C';
        });
        
        if (coaches.length === 0) {
            analysis.weaknesses.push("No Coach identified - you need inside intelligence");
            analysis.recommendations.push("Develop a Coach who can provide competitive intelligence");
        } else {
            analysis.strengths.push("Coach identified for inside intelligence");
        }
        
        // Analyze Modes
        const troubleModes = Array.from(buyerRows).filter(row => {
            const modeSelect = row.querySelector('td:nth-child(4) select');
            return modeSelect && modeSelect.value === 'T';
        });
        
        if (troubleModes.length > 0) {
            analysis.weaknesses.push(`${troubleModes.length} Buying Influence(s) in Trouble mode`);
            analysis.recommendations.push("Address concerns of Trouble-mode buyers - what pain are they avoiding?");
        }
        
        // Analyze Position
        const position = document.querySelector('input[name="position"]:checked');
        if (position) {
            if (position.value === 'only') {
                analysis.strengths.push("Only Alternative position - strong competitive advantage");
            } else if (position.value === 'staged') {
                analysis.weaknesses.push("Staged position - competition is active");
                analysis.recommendations.push("Differentiate your solution and develop unique Economic Buyer relationships");
            }
        }
        
        // Analyze Funnel Position
        const funnel = document.querySelector('input[name="funnel"]:checked');
        if (funnel && funnel.value === 'universe') {
            analysis.recommendations.push("Move deal from Universe to Above Funnel through qualification");
        }
        
        // Analyze Timing
        const timing = document.querySelector('input[name="timing"]:checked');
        if (timing && timing.value === 'urgent') {
            analysis.strengths.push("Urgent timing creates buying pressure");
        } else if (timing && timing.value === 'later') {
            analysis.weaknesses.push("Later timing reduces urgency - may delay decision");
            analysis.recommendations.push("Create or uncover urgency - what happens if they wait?");
        }
        
        // Check SSO
        const sso = document.getElementById('sso').value;
        if (!sso || sso.length < 30) {
            analysis.redFlags.push("Single Sales Objective unclear or missing");
            analysis.recommendations.push("Define clear, measurable SSO - what specific result will you achieve?");
        } else if (!sso.match(/\d/)) {
            analysis.weaknesses.push("SSO lacks measurable metrics");
            analysis.recommendations.push("Add measurable outcomes to SSO (dates, quantities, $)");
        }
        
        // Check Red Flags section
        const redFlags = document.getElementById('red-flags').value;
        if (!redFlags || redFlags.length < 20) {
            analysis.weaknesses.push("Red flags not documented - blind spots likely exist");
            analysis.recommendations.push("Identify and document risks to maintain strategic awareness");
        }
        
        // Check Action Plan
        const actions = document.querySelectorAll('#actionTableBody tr');
        if (actions.length === 0) {
            analysis.redFlags.push("No action plan defined - strategy will not execute itself");
            analysis.recommendations.push("Create specific action items with owners and dates");
        } else if (actions.length < 3) {
            analysis.weaknesses.push("Limited action plan - needs more specific actions");
        }
        
        return analysis;
    }
    
    function updateAIInsights() {
        const score = calculateStrategicScore();
        const analysis = analyzeStrategy();
        
        // Update score display
        const scoreElement = document.getElementById('strategic-score');
        scoreElement.textContent = `${score}%`;
        
        // Color code score
        scoreElement.className = 'ai-score';
        if (score >= 85) scoreElement.classList.add('score-excellent');
        else if (score >= 70) scoreElement.classList.add('score-good');
        else if (score >= 50) scoreElement.classList.add('score-moderate');
        else if (score >= 30) scoreElement.classList.add('score-weak');
        else scoreElement.classList.add('score-critical');
        
        // Build insights HTML
        let html = '';
        
        // Strategic Assessment
        html += `<div class="ai-section">
            <div class="ai-section-title">üìä Strategic Assessment</div>
            <div class="ai-content">`;
        
        if (score >= 85) {
            html += `<p><strong>EXCELLENT</strong> - Comprehensive strategic analysis. Your Blue Sheet shows deep understanding of the buying dynamics.</p>`;
        } else if (score >= 70) {
            html += `<p><strong>GOOD</strong> - Solid strategic foundation. Address remaining gaps to strengthen your position.</p>`;
        } else if (score >= 50) {
            html += `<p><strong>MODERATE</strong> - Key elements present but significant gaps remain. Focus on Economic Buyer access.</p>`;
        } else if (score >= 30) {
            html += `<p><strong>WEAK</strong> - Critical gaps in strategy. Immediate action required to improve position.</p>`;
        } else {
            html += `<p><strong>CRITICAL</strong> - Insufficient strategic analysis. Start with identifying Economic Buyer and developing SSO.</p>`;
        }
        
        html += `</div></div>`;
        
        // Strengths
        if (analysis.strengths.length > 0) {
            html += `<div class="ai-section">
                <div class="ai-section-title">üí™ Competitive Strengths</div>
                <div class="ai-content">`;
            
            analysis.strengths.forEach(strength => {
                html += `<div class="ai-bullet">
                    <div class="bullet-icon">‚úì</div>
                    <div class="bullet-text">${strength}</div>
                </div>`;
            });
            
            html += `</div></div>`;
        }
        
        // Red Flags
        if (analysis.redFlags.length > 0) {
            html += `<div class="ai-section">
                <div class="ai-section-title">üö© Critical Red Flags</div>
                <div class="ai-content">`;
            
            analysis.redFlags.forEach(flag => {
                html += `<div class="ai-bullet">
                    <div class="bullet-icon">‚ö†Ô∏è</div>
                    <div class="bullet-text"><strong>${flag}</strong></div>
                </div>`;
            });
            
            html += `</div></div>`;
        }
        
        // Weaknesses
        if (analysis.weaknesses.length > 0) {
            html += `<div class="ai-section">
                <div class="ai-section-title">‚ö° Areas to Strengthen</div>
                <div class="ai-content">`;
            
            analysis.weaknesses.forEach(weakness => {
                html += `<div class="ai-bullet">
                    <div class="bullet-icon">‚Üí</div>
                    <div class="bullet-text">${weakness}</div>
                </div>`;
            });
            
            html += `</div></div>`;
        }
        
        // Recommendations
        if (analysis.recommendations.length > 0) {
            html += `<div class="ai-section">
                <div class="ai-section-title">üéØ Strategic Recommendations</div>
                <div class="ai-content">`;
            
            analysis.recommendations.forEach((rec, index) => {
                html += `<div class="ai-bullet">
                    <div class="bullet-icon">${index + 1}.</div>
                    <div class="bullet-text">${rec}</div>
                </div>`;
            });
            
            html += `</div></div>`;
        }
        
        // Miller Heiman Wisdom
        if (score < 70) {
            html += `<div class="ai-warning">
                <strong>üìö Miller Heiman Principle:</strong> Success in complex sales requires coverage of all four Buying Influences (Economic, Technical, User, Coach). Without Economic Buyer access, technical superiority and user enthusiasm are meaningless - only Economic Buyers can give final approval.
            </div>`;
        }
        
        if (score >= 85) {
            html += `<div class="ai-recommendation">
                <strong>‚ú® Next Steps:</strong> Execute your action plan with urgency. Monitor Buying Influence modes for changes (especially Trouble). Schedule regular Blue Sheet updates to track competitive position.
            </div>`;
        }
        
        document.getElementById('ai-content-area').innerHTML = html;
    }

    document.addEventListener('DOMContentLoaded', function () {
        const savedTheme = localStorage.getItem('mhTheme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-theme');
        }
        initializeStrategies();
    });
</script>
</body>
</html>
